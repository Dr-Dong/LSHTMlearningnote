<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 71 章 生存分析入門 | 醫學統計學</title>
  <meta name="description" content="在LSHTM的學習筆記" />
  <meta name="generator" content="bookdown 0.15 and GitBook 2.6.7" />

  <meta property="og:title" content="第 71 章 生存分析入門 | 醫學統計學" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.jpg" />
  <meta property="og:description" content="在LSHTM的學習筆記" />
  <meta name="github-repo" content="winterwang/LSHTMlearningnote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 71 章 生存分析入門 | 醫學統計學" />
  
  <meta name="twitter:description" content="在LSHTM的學習筆記" />
  <meta name="twitter:image" content="img/cover.jpg" />

<meta name="author" content="王 超辰 Chaochen Wang" />


<meta name="date" content="2019-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="10-Hierarchical-models.html"/>
<link rel="next" href="12-Bayesian-stats.html"/>
<script src="assets/jquery/jquery.min.js"></script>
<link href="assets/gitbook/css/style.css" rel="stylesheet" />
<link href="assets/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/kePrint/kePrint.js"></script>
<script src="assets/htmlwidgets/htmlwidgets.js"></script>
<script src="assets/plotly-binding/plotly.js"></script>
<script src="assets/typedarray/typedarray.min.js"></script>
<link href="assets/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="assets/crosstalk/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">在LSHTM的學習筆記</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="00-author.html"><a href="00-author.html"><i class="fa fa-check"></i>我是誰</a></li>
<li class="part"><span><b>I 概率論 Probability</b></span></li>
<li class="chapter" data-level="1" data-path="01-Probability.html"><a href="01-Probability.html"><i class="fa fa-check"></i><b>1</b> 概率論入門：定義與公理</a><ul>
<li class="chapter" data-level="1.1" data-path="01-Probability.html"><a href="01-Probability.html#三個概率公理"><i class="fa fa-check"></i><b>1.1</b> 三個概率公理：</a></li>
<li class="chapter" data-level="1.2" data-path="01-Probability.html"><a href="01-Probability.html#conditonalProb"><i class="fa fa-check"></i><b>1.2</b> 條件概率 Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="01-Probability.html"><a href="01-Probability.html#獨立-independence-的定義"><i class="fa fa-check"></i><b>1.3</b> 獨立 (independence) 的定義</a></li>
<li class="chapter" data-level="1.4" data-path="01-Probability.html"><a href="01-Probability.html#賭博問題"><i class="fa fa-check"></i><b>1.4</b> 賭博問題</a></li>
<li class="chapter" data-level="1.5" data-path="01-Probability.html"><a href="01-Probability.html#賭博問題的答案"><i class="fa fa-check"></i><b>1.5</b> 賭博問題的答案</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="01-Probability.html"><a href="01-Probability.html#Bayes-Definition"><i class="fa fa-check"></i><b>2</b> Bayes 貝葉斯理論的概念</a></li>
<li class="chapter" data-level="3" data-path="01-Probability.html"><a href="01-Probability.html#期望-expectation-或均值-or-mean-和-方差-variance"><i class="fa fa-check"></i><b>3</b> 期望 Expectation (或均值 or mean) 和 方差 Variance</a><ul>
<li class="chapter" data-level="3.1" data-path="01-Probability.html"><a href="01-Probability.html#方差的性質"><i class="fa fa-check"></i><b>3.1</b> 方差的性質：</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="01-Probability.html"><a href="01-Probability.html#bernoulli"><i class="fa fa-check"></i><b>4</b> 伯努利分佈 Bernoulli distribution</a></li>
<li class="chapter" data-level="5" data-path="01-Probability.html"><a href="01-Probability.html#binomial"><i class="fa fa-check"></i><b>5</b> 二項分佈的概念 Binomial distribution</a><ul>
<li class="chapter" data-level="5.1" data-path="01-Probability.html"><a href="01-Probability.html#二項分佈的期望和方差"><i class="fa fa-check"></i><b>5.1</b> 二項分佈的期望和方差</a></li>
<li class="chapter" data-level="5.2" data-path="01-Probability.html"><a href="01-Probability.html#hyperdist"><i class="fa fa-check"></i><b>5.2</b> 超幾何分佈 hypergeometric distribution</a></li>
<li class="chapter" data-level="5.3" data-path="01-Probability.html"><a href="01-Probability.html#樂透中獎概率問題"><i class="fa fa-check"></i><b>5.3</b> 樂透中獎概率問題：</a><ul>
<li class="chapter" data-level="5.3.1" data-path="01-Probability.html"><a href="01-Probability.html#如果我只想中其中的-3-個號碼概率有多大"><i class="fa fa-check"></i><b>5.3.1</b> 如果我只想中其中的 <span class="math inline">\(3\)</span> 個號碼，概率有多大？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="01-Probability.html"><a href="01-Probability.html#poisson"><i class="fa fa-check"></i><b>6</b> 泊松分佈 Poisson Distribution</a></li>
<li class="chapter" data-level="7" data-path="01-Probability.html"><a href="01-Probability.html#正態分佈"><i class="fa fa-check"></i><b>7</b> 正態分佈</a><ul>
<li class="chapter" data-level="7.1" data-path="01-Probability.html"><a href="01-Probability.html#概率密度曲線-probability-density-function-pdf"><i class="fa fa-check"></i><b>7.1</b> 概率密度曲線 probability density function， PDF</a></li>
<li class="chapter" data-level="7.2" data-path="01-Probability.html"><a href="01-Probability.html#正態分佈-1"><i class="fa fa-check"></i><b>7.2</b> 正態分佈</a></li>
<li class="chapter" data-level="7.3" data-path="01-Probability.html"><a href="01-Probability.html#standardNormal"><i class="fa fa-check"></i><b>7.3</b> 標準正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="01-Probability.html"><a href="01-Probability.html#CLT"><i class="fa fa-check"></i><b>8</b> 中心極限定理 the Central Limit Theorem</a><ul>
<li class="chapter" data-level="8.1" data-path="01-Probability.html"><a href="01-Probability.html#covariance"><i class="fa fa-check"></i><b>8.1</b> 協方差 Covariance</a></li>
<li class="chapter" data-level="8.2" data-path="01-Probability.html"><a href="01-Probability.html#correlation"><i class="fa fa-check"></i><b>8.2</b> 相關 Correlation</a></li>
<li class="chapter" data-level="8.3" data-path="01-Probability.html"><a href="01-Probability.html#中心極限定理-the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> 中心極限定理 the Central Limit Theorem</a></li>
<li class="chapter" data-level="8.4" data-path="01-Probability.html"><a href="01-Probability.html#binomial-normal-approx"><i class="fa fa-check"></i><b>8.4</b> 二項分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.5" data-path="01-Probability.html"><a href="01-Probability.html#泊松分佈的正態分佈近似"><i class="fa fa-check"></i><b>8.5</b> 泊松分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.6" data-path="01-Probability.html"><a href="01-Probability.html#continuity-correction"><i class="fa fa-check"></i><b>8.6</b> 正態分佈模擬的校正：continuity corrections</a><ul>
<li class="chapter" data-level="8.6.1" data-path="01-Probability.html"><a href="01-Probability.html#例題"><i class="fa fa-check"></i><b>8.6.1</b> 例題</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="01-Probability.html"><a href="01-Probability.html#兩個連續隨機變量"><i class="fa fa-check"></i><b>8.7</b> 兩個連續隨機變量</a></li>
<li class="chapter" data-level="8.8" data-path="01-Probability.html"><a href="01-Probability.html#兩個連續隨機變量-例子"><i class="fa fa-check"></i><b>8.8</b> 兩個連續隨機變量 例子：</a></li>
<li class="chapter" data-level="8.9" data-path="01-Probability.html"><a href="01-Probability.html#條件分佈和邊緣分佈的概念"><i class="fa fa-check"></i><b>8.9</b> 條件分佈和邊緣分佈的概念</a></li>
<li class="chapter" data-level="8.10" data-path="01-Probability.html"><a href="01-Probability.html#條件分佈和邊緣分佈的例子"><i class="fa fa-check"></i><b>8.10</b> 條件分佈和邊緣分佈的例子</a><ul>
<li class="chapter" data-level="8.10.1" data-path="01-Probability.html"><a href="01-Probability.html#例題-1"><i class="fa fa-check"></i><b>8.10.1</b> 例題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 統計推斷 Inference</b></span></li>
<li class="chapter" data-level="9" data-path="02-Inference.html"><a href="02-Inference.html"><i class="fa fa-check"></i><b>9</b> 統計推斷的概念</a><ul>
<li class="chapter" data-level="9.1" data-path="02-Inference.html"><a href="02-Inference.html#人羣與樣本-population-and-sample"><i class="fa fa-check"></i><b>9.1</b> 人羣與樣本 (population and sample)</a></li>
<li class="chapter" data-level="9.2" data-path="02-Inference.html"><a href="02-Inference.html#樣本和統計量-sample-and-statistic"><i class="fa fa-check"></i><b>9.2</b> 樣本和統計量 (sample and statistic)</a></li>
<li class="chapter" data-level="9.3" data-path="02-Inference.html"><a href="02-Inference.html#估計-estimation"><i class="fa fa-check"></i><b>9.3</b> 估計 Estimation</a></li>
<li class="chapter" data-level="9.4" data-path="02-Inference.html"><a href="02-Inference.html#信賴區間-confidence-intervals"><i class="fa fa-check"></i><b>9.4</b> 信賴區間 confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="02-Inference.html"><a href="02-Inference.html#估計和精確度-estimation-and-precision"><i class="fa fa-check"></i><b>10</b> 估計和精確度 Estimation and Precision</a><ul>
<li class="chapter" data-level="10.1" data-path="02-Inference.html"><a href="02-Inference.html#CI-for-sample-mean"><i class="fa fa-check"></i><b>10.1</b> 估計量和他們的樣本分佈</a></li>
<li class="chapter" data-level="10.2" data-path="02-Inference.html"><a href="02-Inference.html#估計量的特質"><i class="fa fa-check"></i><b>10.2</b> 估計量的特質</a><ul>
<li class="chapter" data-level="10.2.1" data-path="02-Inference.html"><a href="02-Inference.html#bias"><i class="fa fa-check"></i><b>10.2.1</b> 偏倚</a></li>
<li class="chapter" data-level="10.2.2" data-path="02-Inference.html"><a href="02-Inference.html#估計量的效能-efficiency"><i class="fa fa-check"></i><b>10.2.2</b> 估計量的效能 Efficiency</a></li>
<li class="chapter" data-level="10.2.3" data-path="02-Inference.html"><a href="02-Inference.html#均值和中位數的相對效能"><i class="fa fa-check"></i><b>10.2.3</b> 均值和中位數的相對效能</a></li>
<li class="chapter" data-level="10.2.4" data-path="02-Inference.html"><a href="02-Inference.html#均方差-mean-square-error-mse"><i class="fa fa-check"></i><b>10.2.4</b> 均方差 mean square error (MSE)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="02-Inference.html"><a href="02-Inference.html#samplevarbias"><i class="fa fa-check"></i><b>10.3</b> 總體方差的估計，自由度</a></li>
<li class="chapter" data-level="10.4" data-path="02-Inference.html"><a href="02-Inference.html#samplevar"><i class="fa fa-check"></i><b>10.4</b> 樣本方差的樣本分佈</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="02-Inference.html"><a href="02-Inference.html#chi-square-distribution"><i class="fa fa-check"></i><b>11</b> 卡方分佈 Chi-square distribution</a><ul>
<li class="chapter" data-level="11.1" data-path="02-Inference.html"><a href="02-Inference.html#卡方分佈的期望和方差的證明"><i class="fa fa-check"></i><b>11.1</b> 卡方分佈的期望和方差的證明</a></li>
<li class="chapter" data-level="11.2" data-path="02-Inference.html"><a href="02-Inference.html#卡方分佈的期望"><i class="fa fa-check"></i><b>11.2</b> 卡方分佈的期望</a></li>
<li class="chapter" data-level="11.3" data-path="02-Inference.html"><a href="02-Inference.html#卡方分佈的方差"><i class="fa fa-check"></i><b>11.3</b> 卡方分佈的方差</a><ul>
<li class="chapter" data-level="11.3.1" data-path="02-Inference.html"><a href="02-Inference.html#下面來求-ex_14"><i class="fa fa-check"></i><b>11.3.1</b> 下面來求 <span class="math inline">\(E(X_1^4)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="02-Inference.html"><a href="02-Inference.html#把上面的推導擴展"><i class="fa fa-check"></i><b>11.4</b> 把上面的推導擴展</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="02-Inference.html"><a href="02-Inference.html#likelihood-definition"><i class="fa fa-check"></i><b>12</b> 似然 Likelihood</a><ul>
<li class="chapter" data-level="12.1" data-path="02-Inference.html"><a href="02-Inference.html#概率-vs.-推斷-probability-vs.-inference"><i class="fa fa-check"></i><b>12.1</b> 概率 vs. 推斷 Probability vs. Inference</a></li>
<li class="chapter" data-level="12.2" data-path="02-Inference.html"><a href="02-Inference.html#似然和極大似然估計-likelihood-and-maximum-likelihood-estimators"><i class="fa fa-check"></i><b>12.2</b> 似然和極大似然估計 Likelihood and maximum likelihood estimators</a></li>
<li class="chapter" data-level="12.3" data-path="02-Inference.html"><a href="02-Inference.html#似然方程的一般化定義"><i class="fa fa-check"></i><b>12.3</b> 似然方程的一般化定義</a></li>
<li class="chapter" data-level="12.4" data-path="02-Inference.html"><a href="02-Inference.html#對數似然方程-log-likelihood"><i class="fa fa-check"></i><b>12.4</b> 對數似然方程 log-likelihood</a></li>
<li class="chapter" data-level="12.5" data-path="02-Inference.html"><a href="02-Inference.html#極大似然估計-maximum-likelihood-estimator-mle-的性質"><i class="fa fa-check"></i><b>12.5</b> 極大似然估計 (maximum likelihood estimator, MLE) 的性質：</a></li>
<li class="chapter" data-level="12.6" data-path="02-Inference.html"><a href="02-Inference.html#likelihood-poi"><i class="fa fa-check"></i><b>12.6</b> 率的似然估計 Likelihood for a rate</a></li>
<li class="chapter" data-level="12.7" data-path="02-Inference.html"><a href="02-Inference.html#有-n-個獨立觀察時的似然方程和對數似然方程"><i class="fa fa-check"></i><b>12.7</b> 有 <span class="math inline">\(n\)</span> 個獨立觀察時的似然方程和對數似然方程</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="02-Inference.html"><a href="02-Inference.html#llr"><i class="fa fa-check"></i><b>13</b> 對數似然比 Log-likelihood ratio</a><ul>
<li class="chapter" data-level="13.1" data-path="02-Inference.html"><a href="02-Inference.html#正態分佈數據的極大似然和對數似然比"><i class="fa fa-check"></i><b>13.1</b> 正態分佈數據的極大似然和對數似然比</a></li>
<li class="chapter" data-level="13.2" data-path="02-Inference.html"><a href="02-Inference.html#llr-chi1"><i class="fa fa-check"></i><b>13.2</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比</a></li>
<li class="chapter" data-level="13.3" data-path="02-Inference.html"><a href="02-Inference.html#llr-chi"><i class="fa fa-check"></i><b>13.3</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比的分佈</a></li>
<li class="chapter" data-level="13.4" data-path="02-Inference.html"><a href="02-Inference.html#似然比信賴區間"><i class="fa fa-check"></i><b>13.4</b> 似然比信賴區間</a><ul>
<li class="chapter" data-level="13.4.1" data-path="02-Inference.html"><a href="02-Inference.html#binomial-ex"><i class="fa fa-check"></i><b>13.4.1</b> 以二項分佈數據爲例</a></li>
<li class="chapter" data-level="13.4.2" data-path="02-Inference.html"><a href="02-Inference.html#normal-ex"><i class="fa fa-check"></i><b>13.4.2</b> 以正態分佈數據爲例</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="02-Inference.html"><a href="02-Inference.html#練習題"><i class="fa fa-check"></i><b>13.5</b> 練習題</a><ul>
<li class="chapter" data-level="13.5.1" data-path="02-Inference.html"><a href="02-Inference.html#q1"><i class="fa fa-check"></i><b>13.5.1</b> Q1</a></li>
<li class="chapter" data-level="13.5.2" data-path="02-Inference.html"><a href="02-Inference.html#q2"><i class="fa fa-check"></i><b>13.5.2</b> Q2</a></li>
<li class="chapter" data-level="13.5.3" data-path="02-Inference.html"><a href="02-Inference.html#q3"><i class="fa fa-check"></i><b>13.5.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="02-Inference.html"><a href="02-Inference.html#quadratic-llr"><i class="fa fa-check"></i><b>14</b> 二次方程近似法求對數似然比 approximate log-likelihood ratios</a><ul>
<li class="chapter" data-level="14.1" data-path="02-Inference.html"><a href="02-Inference.html#quadratic-llr2"><i class="fa fa-check"></i><b>14.1</b> 正態近似法求對數似然 Normal approximation to the log-likelihood</a><ul>
<li class="chapter" data-level="14.1.1" data-path="02-Inference.html"><a href="02-Inference.html#近似法估算對數似然比的信賴區間"><i class="fa fa-check"></i><b>14.1.1</b> 近似法估算對數似然比的信賴區間</a></li>
<li class="chapter" data-level="14.1.2" data-path="02-Inference.html"><a href="02-Inference.html#以泊松分佈爲例"><i class="fa fa-check"></i><b>14.1.2</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.1.3" data-path="02-Inference.html"><a href="02-Inference.html#quadratic-binomial-approx"><i class="fa fa-check"></i><b>14.1.3</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="02-Inference.html"><a href="02-Inference.html#para-trans"><i class="fa fa-check"></i><b>14.2</b> 參數转换 parameter transformations</a><ul>
<li class="chapter" data-level="14.2.1" data-path="02-Inference.html"><a href="02-Inference.html#Possion-log-transform"><i class="fa fa-check"></i><b>14.2.1</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.2.2" data-path="02-Inference.html"><a href="02-Inference.html#以二項分佈爲例"><i class="fa fa-check"></i><b>14.2.2</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="02-Inference.html"><a href="02-Inference.html#練習題-1"><i class="fa fa-check"></i><b>14.3</b> 練習題</a><ul>
<li class="chapter" data-level="14.3.1" data-path="02-Inference.html"><a href="02-Inference.html#q1-1"><i class="fa fa-check"></i><b>14.3.1</b> Q1</a></li>
<li class="chapter" data-level="14.3.2" data-path="02-Inference.html"><a href="02-Inference.html#q2-1"><i class="fa fa-check"></i><b>14.3.2</b> Q2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="02-Inference.html"><a href="02-Inference.html#假設檢驗的構建-construction-of-a-hypothesis-test"><i class="fa fa-check"></i><b>15</b> 假設檢驗的構建 Construction of a hypothesis test</a><ul>
<li class="chapter" data-level="15.1" data-path="02-Inference.html"><a href="02-Inference.html#null-and-alter"><i class="fa fa-check"></i><b>15.1</b> 什麼是假設檢驗 Hypothesis testing</a></li>
<li class="chapter" data-level="15.2" data-path="02-Inference.html"><a href="02-Inference.html#錯誤概率和效能方程-error-probabilities-and-the-power-function"><i class="fa fa-check"></i><b>15.2</b> 錯誤概率和效能方程 error probabilities and the power function</a><ul>
<li class="chapter" data-level="15.2.1" data-path="02-Inference.html"><a href="02-Inference.html#以二項分佈爲例-1"><i class="fa fa-check"></i><b>15.2.1</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="02-Inference.html"><a href="02-Inference.html#Neyman-Pearson"><i class="fa fa-check"></i><b>15.3</b> 如何選擇要檢驗的統計量</a><ul>
<li class="chapter" data-level="15.3.1" data-path="02-Inference.html"><a href="02-Inference.html#以已知方差的正態分佈爲例"><i class="fa fa-check"></i><b>15.3.1</b> 以已知方差的正態分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="02-Inference.html"><a href="02-Inference.html#複合假設-composite-hypotheses"><i class="fa fa-check"></i><b>15.4</b> 複合假設 composite hypotheses</a><ul>
<li class="chapter" data-level="15.4.1" data-path="02-Inference.html"><a href="02-Inference.html#單側替代假設"><i class="fa fa-check"></i><b>15.4.1</b> 單側替代假設</a></li>
<li class="chapter" data-level="15.4.2" data-path="02-Inference.html"><a href="02-Inference.html#雙側替代假設"><i class="fa fa-check"></i><b>15.4.2</b> 雙側替代假設</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="02-Inference.html"><a href="02-Inference.html#爲反對零假設-h_0-的證據定量"><i class="fa fa-check"></i><b>15.5</b> 爲反對零假設 <span class="math inline">\(H_0\)</span> 的證據定量</a><ul>
<li class="chapter" data-level="15.5.1" data-path="02-Inference.html"><a href="02-Inference.html#normal-mean-compare"><i class="fa fa-check"></i><b>15.5.1</b> 回到正態分佈的均值比較問題上來(單側替代假設)</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="02-Inference.html"><a href="02-Inference.html#雙側替代假設情況下雙側-p-值的定量方法"><i class="fa fa-check"></i><b>15.6</b> 雙側替代假設情況下，雙側 <span class="math inline">\(p\)</span> 值的定量方法</a></li>
<li class="chapter" data-level="15.7" data-path="02-Inference.html"><a href="02-Inference.html#test-summary"><i class="fa fa-check"></i><b>15.7</b> 假設檢驗構建之總結</a></li>
<li class="chapter" data-level="15.8" data-path="02-Inference.html"><a href="02-Inference.html#練習題-2"><i class="fa fa-check"></i><b>15.8</b> 練習題</a><ul>
<li class="chapter" data-level="15.8.1" data-path="02-Inference.html"><a href="02-Inference.html#q1-2"><i class="fa fa-check"></i><b>15.8.1</b> Q1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="02-Inference.html"><a href="02-Inference.html#假設檢驗的近似方法"><i class="fa fa-check"></i><b>16</b> 假設檢驗的近似方法</a><ul>
<li class="chapter" data-level="16.1" data-path="02-Inference.html"><a href="02-Inference.html#近似和精確檢驗-approximate-and-exact-tests"><i class="fa fa-check"></i><b>16.1</b> 近似和精確檢驗 approximate and exact tests</a></li>
<li class="chapter" data-level="16.2" data-path="02-Inference.html"><a href="02-Inference.html#LRT"><i class="fa fa-check"></i><b>16.2</b> 精確檢驗法之 – 似然比檢驗法 Likelihood ratio test</a></li>
<li class="chapter" data-level="16.3" data-path="02-Inference.html"><a href="02-Inference.html#練習題-3"><i class="fa fa-check"></i><b>16.3</b> 練習題</a></li>
<li class="chapter" data-level="16.4" data-path="02-Inference.html"><a href="02-Inference.html#Wald"><i class="fa fa-check"></i><b>16.4</b> 近似檢驗法之 – Wald 檢驗</a><ul>
<li class="chapter" data-level="16.4.1" data-path="02-Inference.html"><a href="02-Inference.html#再以二項分佈爲例"><i class="fa fa-check"></i><b>16.4.1</b> 再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="02-Inference.html"><a href="02-Inference.html#Score"><i class="fa fa-check"></i><b>16.5</b> 近似檢驗法之 – Score 检验</a><ul>
<li class="chapter" data-level="16.5.1" data-path="02-Inference.html"><a href="02-Inference.html#再再以二項分佈爲例"><i class="fa fa-check"></i><b>16.5.1</b> 再再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="02-Inference.html"><a href="02-Inference.html#LRTwaldScore-Compare"><i class="fa fa-check"></i><b>16.6</b> LRT, Wald, Score 檢驗三者的比較</a></li>
<li class="chapter" data-level="16.7" data-path="02-Inference.html"><a href="02-Inference.html#練習題-4"><i class="fa fa-check"></i><b>16.7</b> 練習題</a><ul>
<li class="chapter" data-level="16.7.1" data-path="02-Inference.html"><a href="02-Inference.html#q1-3"><i class="fa fa-check"></i><b>16.7.1</b> Q1</a></li>
<li class="chapter" data-level="16.7.2" data-path="02-Inference.html"><a href="02-Inference.html#q2-2"><i class="fa fa-check"></i><b>16.7.2</b> Q2</a></li>
<li class="chapter" data-level="16.7.3" data-path="02-Inference.html"><a href="02-Inference.html#q3-1"><i class="fa fa-check"></i><b>16.7.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="02-Inference.html"><a href="02-Inference.html#正態誤差模型-normal-error-models"><i class="fa fa-check"></i><b>17</b> 正態誤差模型 Normal error models</a><ul>
<li class="chapter" data-level="17.1" data-path="02-Inference.html"><a href="02-Inference.html#服從正態分佈的隨機變量"><i class="fa fa-check"></i><b>17.1</b> 服從正態分佈的隨機變量</a></li>
<li class="chapter" data-level="17.2" data-path="02-Inference.html"><a href="02-Inference.html#Fandtdistr"><i class="fa fa-check"></i><b>17.2</b> <span class="math inline">\(F\)</span> 分佈和 <span class="math inline">\(t\)</span> 分佈的概念</a></li>
<li class="chapter" data-level="17.3" data-path="02-Inference.html"><a href="02-Inference.html#兩個參數的模型"><i class="fa fa-check"></i><b>17.3</b> 兩個參數的模型</a><ul>
<li class="chapter" data-level="17.3.1" data-path="02-Inference.html"><a href="02-Inference.html#一組數據兩個參數"><i class="fa fa-check"></i><b>17.3.1</b> 一組數據兩個參數</a></li>
<li class="chapter" data-level="17.3.2" data-path="02-Inference.html"><a href="02-Inference.html#兩組數據各一個參數"><i class="fa fa-check"></i><b>17.3.2</b> 兩組數據各一個參數</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="02-Inference.html"><a href="02-Inference.html#正態分佈概率密度方程中總體均值和方差都未知-單樣本-t-檢驗-one-sample-t-test-的統計學推導"><i class="fa fa-check"></i><b>17.4</b> 正態分佈概率密度方程中總體均值和方差都未知 (單樣本 <span class="math inline">\(t\)</span> 檢驗 one sample <span class="math inline">\(t\)</span> test 的統計學推導)</a></li>
<li class="chapter" data-level="17.5" data-path="02-Inference.html"><a href="02-Inference.html#比較兩組獨立數據的均值-two-sample-t-test-with-equal-unknown-sigma2"><i class="fa fa-check"></i><b>17.5</b> 比較兩組獨立數據的均值 two sample <span class="math inline">\(t\)</span> test with equal unknown <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="17.6" data-path="02-Inference.html"><a href="02-Inference.html#各個統計分佈之間的關係"><i class="fa fa-check"></i><b>17.6</b> 各個統計分佈之間的關係</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="02-Inference.html"><a href="02-Inference.html#多個參數時的統計推斷-inference-with-multiple-parameters-i"><i class="fa fa-check"></i><b>18</b> 多個參數時的統計推斷 Inference with multiple parameters I</a><ul>
<li class="chapter" data-level="18.1" data-path="02-Inference.html"><a href="02-Inference.html#多參數-multiple-parameters---lrt"><i class="fa fa-check"></i><b>18.1</b> 多參數 multiple parameters - LRT</a><ul>
<li class="chapter" data-level="18.1.1" data-path="02-Inference.html"><a href="02-Inference.html#似然-likelihood"><i class="fa fa-check"></i><b>18.1.1</b> 似然 likelihood</a></li>
<li class="chapter" data-level="18.1.2" data-path="02-Inference.html"><a href="02-Inference.html#對數似然比檢驗"><i class="fa fa-check"></i><b>18.1.2</b> 對數似然比檢驗</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="02-Inference.html"><a href="02-Inference.html#多參數-wald-檢驗---wald-test"><i class="fa fa-check"></i><b>18.2</b> 多參數 Wald 檢驗 - Wald test</a></li>
<li class="chapter" data-level="18.3" data-path="02-Inference.html"><a href="02-Inference.html#多參數-score-檢驗---score-test"><i class="fa fa-check"></i><b>18.3</b> 多參數 Score 檢驗 - Score test</a></li>
<li class="chapter" data-level="18.4" data-path="02-Inference.html"><a href="02-Inference.html#condilikeli"><i class="fa fa-check"></i><b>18.4</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="18.5" data-path="02-Inference.html"><a href="02-Inference.html#練習"><i class="fa fa-check"></i><b>18.5</b> 練習</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="02-Inference.html"><a href="02-Inference.html#profile-log-likelihood"><i class="fa fa-check"></i><b>19</b> 多個參數時的統計推斷 – 子集似然函數 profile log-likelihoods</a><ul>
<li class="chapter" data-level="19.1" data-path="02-Inference.html"><a href="02-Inference.html#子集似然法推導的過程總結"><i class="fa fa-check"></i><b>19.1</b> 子集似然法推導的過程總結</a><ul>
<li class="chapter" data-level="19.1.1" data-path="02-Inference.html"><a href="02-Inference.html#子集對數似然方程的分佈"><i class="fa fa-check"></i><b>19.1.1</b> 子集對數似然方程的分佈</a></li>
<li class="chapter" data-level="19.1.2" data-path="02-Inference.html"><a href="02-Inference.html#假設檢驗過程舉例"><i class="fa fa-check"></i><b>19.1.2</b> 假設檢驗過程舉例</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="02-Inference.html"><a href="02-Inference.html#子集對數似然比的近似"><i class="fa fa-check"></i><b>19.2</b> 子集對數似然比的近似</a><ul>
<li class="chapter" data-level="19.2.1" data-path="02-Inference.html"><a href="02-Inference.html#子集對數似然比近似的一般化"><i class="fa fa-check"></i><b>19.2.1</b> 子集對數似然比近似的一般化</a></li>
<li class="chapter" data-level="19.2.2" data-path="02-Inference.html"><a href="02-Inference.html#事件發生率之比的-wald-檢驗統計量"><i class="fa fa-check"></i><b>19.2.2</b> 事件發生率之比的 Wald 檢驗統計量</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="02-Inference.html"><a href="02-Inference.html#練習-practical"><i class="fa fa-check"></i><b>19.3</b> 練習 Practical</a></li>
<li class="chapter" data-level="19.4" data-path="02-Inference.html"><a href="02-Inference.html#總結"><i class="fa fa-check"></i><b>19.4</b> 總結</a><ul>
<li class="chapter" data-level="19.4.1" data-path="02-Inference.html"><a href="02-Inference.html#快速複習"><i class="fa fa-check"></i><b>19.4.1</b> 快速複習</a></li>
<li class="chapter" data-level="19.4.2" data-path="02-Inference.html"><a href="02-Inference.html#試爲下面的醫學研究問題提出合適的統計學模型"><i class="fa fa-check"></i><b>19.4.2</b> 試爲下面的醫學研究問題提出合適的統計學模型</a></li>
<li class="chapter" data-level="19.4.3" data-path="02-Inference.html"><a href="02-Inference.html#醫生來找統計學家問問題"><i class="fa fa-check"></i><b>19.4.3</b> 醫生來找統計學家問問題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III 統計分析方法 Analytical Techniques</b></span></li>
<li class="chapter" data-level="20" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html"><i class="fa fa-check"></i><b>20</b> 探索數據和簡單描述</a><ul>
<li class="chapter" data-level="20.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#數據分析的流程"><i class="fa fa-check"></i><b>20.1</b> 數據分析的流程</a><ul>
<li class="chapter" data-level="20.1.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#研究設計和實施"><i class="fa fa-check"></i><b>20.1.1</b> 研究設計和實施</a></li>
<li class="chapter" data-level="20.1.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#數據分析"><i class="fa fa-check"></i><b>20.1.2</b> 數據分析</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#數據類型"><i class="fa fa-check"></i><b>20.2</b> 數據類型</a></li>
<li class="chapter" data-level="20.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#如何總結並展示數據"><i class="fa fa-check"></i><b>20.3</b> 如何總結並展示數據</a><ul>
<li class="chapter" data-level="20.3.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#離散型分類型數據的描述---頻數分佈表-frequency-table"><i class="fa fa-check"></i><b>20.3.1</b> 離散型分類型數據的描述 - 頻數分佈表 frequency table</a></li>
<li class="chapter" data-level="20.3.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#連續型變量"><i class="fa fa-check"></i><b>20.3.2</b> 連續型變量</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#數據總結方案位置分散偏度和峰度"><i class="fa fa-check"></i><b>20.4</b> 數據總結方案：位置，分散，偏度，和峰度</a><ul>
<li class="chapter" data-level="20.4.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#位置"><i class="fa fa-check"></i><b>20.4.1</b> 位置</a></li>
<li class="chapter" data-level="20.4.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#分散"><i class="fa fa-check"></i><b>20.4.2</b> 分散</a></li>
<li class="chapter" data-level="20.4.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#偏度-skewness"><i class="fa fa-check"></i><b>20.4.3</b> 偏度 skewness</a></li>
<li class="chapter" data-level="20.4.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#峯度-kurtosis"><i class="fa fa-check"></i><b>20.4.4</b> 峯度 kurtosis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#信賴區間-confidence-intervals-1"><i class="fa fa-check"></i><b>21</b> 信賴區間 confidence intervals</a><ul>
<li class="chapter" data-level="21.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#定義"><i class="fa fa-check"></i><b>21.1</b> 定義</a></li>
<li class="chapter" data-level="21.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#利用總體參數的樣本分佈求信賴區間"><i class="fa fa-check"></i><b>21.2</b> 利用總體參數的樣本分佈求信賴區間</a></li>
<li class="chapter" data-level="21.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#情況1已知方差的正態分佈數據均值的信賴區間"><i class="fa fa-check"></i><b>21.3</b> 情況1：已知方差的正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="21.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#CImean"><i class="fa fa-check"></i><b>21.4</b> 信賴區間的意義</a></li>
<li class="chapter" data-level="21.5" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#AT2-5"><i class="fa fa-check"></i><b>21.5</b> 情況2：未知方差，但是已知服從正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="21.6" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#varCI"><i class="fa fa-check"></i><b>21.6</b> 情況3：服從正態分佈的隨機變量方差的信賴區間</a></li>
<li class="chapter" data-level="21.7" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#當樣本量足夠大時"><i class="fa fa-check"></i><b>21.7</b> 當樣本量足夠大時</a></li>
<li class="chapter" data-level="21.8" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#情況4求人羣百分比的信賴區間"><i class="fa fa-check"></i><b>21.8</b> 情況4：求人羣百分比的信賴區間</a><ul>
<li class="chapter" data-level="21.8.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#一般原則"><i class="fa fa-check"></i><b>21.8.1</b> 一般原則</a></li>
<li class="chapter" data-level="21.8.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#exactprop"><i class="fa fa-check"></i><b>21.8.2</b> 二項分佈的“精確法”計算信賴區間</a></li>
<li class="chapter" data-level="21.8.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#二項分佈的近似法計算信賴區間"><i class="fa fa-check"></i><b>21.8.3</b> 二項分佈的近似法計算信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#CIrate"><i class="fa fa-check"></i><b>21.9</b> 率的信賴區間</a><ul>
<li class="chapter" data-level="21.9.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#利用泊松分佈精確計算"><i class="fa fa-check"></i><b>21.9.1</b> 利用泊松分佈精確計算</a></li>
<li class="chapter" data-level="21.9.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#利用正態近似法計算"><i class="fa fa-check"></i><b>21.9.2</b> 利用正態近似法計算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#假設檢驗"><i class="fa fa-check"></i><b>22</b> 假設檢驗</a><ul>
<li class="chapter" data-level="22.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#拋硬幣的例子"><i class="fa fa-check"></i><b>22.1</b> 拋硬幣的例子</a><ul>
<li class="chapter" data-level="22.1.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#單側和雙側檢驗"><i class="fa fa-check"></i><b>22.1.1</b> 單側和雙側檢驗</a></li>
<li class="chapter" data-level="22.1.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#p-值的意義"><i class="fa fa-check"></i><b>22.1.2</b> <span class="math inline">\(p\)</span> 值的意義</a></li>
<li class="chapter" data-level="22.1.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#p-值和信賴區間的關係"><i class="fa fa-check"></i><b>22.1.3</b> <span class="math inline">\(p\)</span> 值和信賴區間的關係</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#二項分佈的精確假設檢驗"><i class="fa fa-check"></i><b>22.2</b> 二項分佈的精確假設檢驗</a></li>
<li class="chapter" data-level="22.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#當樣本量較大"><i class="fa fa-check"></i><b>22.3</b> 當樣本量較大</a></li>
<li class="chapter" data-level="22.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#二項分佈的正態近似法假設檢驗"><i class="fa fa-check"></i><b>22.4</b> 二項分佈的正態近似法假設檢驗</a><ul>
<li class="chapter" data-level="22.4.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#連續性校正-continuity-correction"><i class="fa fa-check"></i><b>22.4.1</b> 連續性校正 continuity correction</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#AT3-5"><i class="fa fa-check"></i><b>22.5</b> 情況1：對均值進行假設檢驗 (方差已知)</a></li>
<li class="chapter" data-level="22.6" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#OneSampleT"><i class="fa fa-check"></i><b>22.6</b> 情況2：對均值進行假設檢驗 (方差未知) the one-sample t-test</a></li>
<li class="chapter" data-level="22.7" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#情況3對配對實驗數據的均值差進行假設檢驗-the-paired-t-test"><i class="fa fa-check"></i><b>22.7</b> 情況3：對配對實驗數據的均值差進行假設檢驗 the paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#相關-association"><i class="fa fa-check"></i><b>23</b> 相關 association</a><ul>
<li class="chapter" data-level="23.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#背景介紹"><i class="fa fa-check"></i><b>23.1</b> 背景介紹</a></li>
<li class="chapter" data-level="23.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#兩個連續型變量的相關分析"><i class="fa fa-check"></i><b>23.2</b> 兩個連續型變量的相關分析</a><ul>
<li class="chapter" data-level="23.2.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#相關係數的定義"><i class="fa fa-check"></i><b>23.2.1</b> 相關係數的定義</a></li>
<li class="chapter" data-level="23.2.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#相關係數的性質"><i class="fa fa-check"></i><b>23.2.2</b> 相關係數的性質</a></li>
<li class="chapter" data-level="23.2.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#對相關係數是否爲零進行假設檢驗"><i class="fa fa-check"></i><b>23.2.3</b> 對相關係數是否爲零進行假設檢驗</a></li>
<li class="chapter" data-level="23.2.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#相關係數的-95-信賴區間"><i class="fa fa-check"></i><b>23.2.4</b> 相關係數的 <span class="math inline">\(95\%\)</span> 信賴區間</a></li>
<li class="chapter" data-level="23.2.5" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#比較兩個相關係數是否相等"><i class="fa fa-check"></i><b>23.2.5</b> 比較兩個相關係數是否相等</a></li>
<li class="chapter" data-level="23.2.6" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#相關係數那些事兒"><i class="fa fa-check"></i><b>23.2.6</b> 相關係數那些事兒</a></li>
<li class="chapter" data-level="23.2.7" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#在-r-裏面計算相關係數"><i class="fa fa-check"></i><b>23.2.7</b> 在 R 裏面計算相關係數</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#二元變量之間的相關性-association-between-pairs-of-binary-variables"><i class="fa fa-check"></i><b>23.3</b> 二元變量之間的相關性 association between pairs of binary variables</a><ul>
<li class="chapter" data-level="23.3.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#or-的信賴區間"><i class="fa fa-check"></i><b>23.3.1</b> OR 的信賴區間</a></li>
<li class="chapter" data-level="23.3.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#比值比的假設檢驗"><i class="fa fa-check"></i><b>23.3.2</b> 比值比的假設檢驗</a></li>
<li class="chapter" data-level="23.3.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#chisquaretest"><i class="fa fa-check"></i><b>23.3.3</b> 兩個百分比的卡方檢驗</a></li>
<li class="chapter" data-level="23.3.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#確切檢驗法-fishers-exact-test"><i class="fa fa-check"></i><b>23.3.4</b> 確切檢驗法 Fisher’s “exact” test</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#多分類-無排序-的情況-mtimes-n-表格"><i class="fa fa-check"></i><b>23.4</b> 多分類 (無排序) 的情況 <span class="math inline">\(M\times N\)</span> 表格</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#比較-comparisons"><i class="fa fa-check"></i><b>24</b> 比較 Comparisons</a><ul>
<li class="chapter" data-level="24.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#比較兩個均值-comparing-two-population-means"><i class="fa fa-check"></i><b>24.1</b> 比較兩個均值 comparing two population means</a><ul>
<li class="chapter" data-level="24.1.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#當方差已知且數據服從正態分佈-z-test"><i class="fa fa-check"></i><b>24.1.1</b> 當方差已知，且數據服從正態分佈 Z-test</a></li>
<li class="chapter" data-level="24.1.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#當方差未知但是方差可以被認爲相等且數據服從正態分佈-two-sample-t-test"><i class="fa fa-check"></i><b>24.1.2</b> 當方差未知，但是方差可以被認爲相等，且數據服從正態分佈 two sample <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="24.1.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#練習-1"><i class="fa fa-check"></i><b>24.1.3</b> 練習</a></li>
<li class="chapter" data-level="24.1.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#當方差未知但是方差不可以被認爲相等且數據服從正態分佈"><i class="fa fa-check"></i><b>24.1.4</b> 當方差未知，但是方差<strong>不可以</strong>被認爲相等，且數據服從正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#兩個人羣的方差比較"><i class="fa fa-check"></i><b>24.2</b> 兩個人羣的方差比較</a><ul>
<li class="chapter" data-level="24.2.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#Ftest"><i class="fa fa-check"></i><b>24.2.1</b> 方差比值檢驗 variance ratio test</a></li>
<li class="chapter" data-level="24.2.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#信賴區間"><i class="fa fa-check"></i><b>24.2.2</b> 信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#比較兩個百分比"><i class="fa fa-check"></i><b>24.3</b> 比較兩個百分比</a><ul>
<li class="chapter" data-level="24.3.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#proportiontest"><i class="fa fa-check"></i><b>24.3.1</b> 兩個百分比差是否爲零的推斷 Risk difference</a></li>
<li class="chapter" data-level="24.3.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#兩個百分比商是否爲-1-的推斷-relative-riskrisk-ratio"><i class="fa fa-check"></i><b>24.3.2</b> 兩個百分比商是否爲 1 的推斷 relative risk/risk ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#前提和數據轉換-assumptions-and-transformations"><i class="fa fa-check"></i><b>25</b> 前提和數據轉換 Assumptions and transformations</a><ul>
<li class="chapter" data-level="25.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#穩健性"><i class="fa fa-check"></i><b>25.1</b> 穩健性</a></li>
<li class="chapter" data-level="25.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#正態性"><i class="fa fa-check"></i><b>25.2</b> 正態性</a><ul>
<li class="chapter" data-level="25.2.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#normalplot"><i class="fa fa-check"></i><b>25.2.1</b> 正態分佈圖 normal plot</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#總結連續型變量不服從正態分佈時的處理方案"><i class="fa fa-check"></i><b>25.3</b> 總結連續型變量不服從正態分佈時的處理方案</a></li>
<li class="chapter" data-level="25.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#數學冪轉換-power-transformations"><i class="fa fa-check"></i><b>25.4</b> 數學冪轉換 power transformations</a><ul>
<li class="chapter" data-level="25.4.1" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#對數轉換-logarithmic-transformation"><i class="fa fa-check"></i><b>25.4.1</b> 對數轉換 logarithmic Transformation</a></li>
<li class="chapter" data-level="25.4.2" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#逆轉換信賴區間-back-transformation-of-cis"><i class="fa fa-check"></i><b>25.4.2</b> 逆轉換信賴區間 back-transformation of CIs</a></li>
<li class="chapter" data-level="25.4.3" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#對數正態分佈-log-normal-distribution"><i class="fa fa-check"></i><b>25.4.3</b> 對數正態分佈 log-normal distribution</a></li>
<li class="chapter" data-level="25.4.4" data-path="03-Analytic-Technique.html"><a href="03-Analytic-Technique.html#百分比的轉換"><i class="fa fa-check"></i><b>25.4.4</b> 百分比的轉換</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 線性迴歸 Linear Regression</b></span></li>
<li class="chapter" data-level="26" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html"><i class="fa fa-check"></i><b>26</b> 簡單線性迴歸 Simple Linear Regression</a><ul>
<li class="chapter" data-level="26.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#一些背景和術語"><i class="fa fa-check"></i><b>26.1</b> 一些背景和術語</a></li>
<li class="chapter" data-level="26.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#簡單線性迴歸模型-simple-linear-regression-model"><i class="fa fa-check"></i><b>26.2</b> 簡單線性迴歸模型 simple linear regression model</a><ul>
<li class="chapter" data-level="26.2.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#數據-a"><i class="fa fa-check"></i><b>26.2.1</b> 數據 A</a></li>
<li class="chapter" data-level="26.2.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#數據-b"><i class="fa fa-check"></i><b>26.2.2</b> 數據 B</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#區分因變量和預測變量"><i class="fa fa-check"></i><b>26.3</b> 區分因變量和預測變量</a><ul>
<li class="chapter" data-level="26.3.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#meanfunction"><i class="fa fa-check"></i><b>26.3.1</b> 均值 (期待值) 公式</a></li>
<li class="chapter" data-level="26.3.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#條件分佈和方差-the-conditional-distribution-and-the-variance-function"><i class="fa fa-check"></i><b>26.3.2</b> 條件分佈和方差 the conditional distribution and the variance function</a></li>
<li class="chapter" data-level="26.3.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#defLM"><i class="fa fa-check"></i><b>26.3.3</b> 定義簡單線性迴歸模型</a></li>
<li class="chapter" data-level="26.3.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#殘差-residuals"><i class="fa fa-check"></i><b>26.3.4</b> 殘差 residuals</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#參數的估計-estimation-of-parameters"><i class="fa fa-check"></i><b>26.4</b> 參數的估計 estimation of parameters</a><ul>
<li class="chapter" data-level="26.4.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#MLEalphabeta"><i class="fa fa-check"></i><b>26.4.1</b> 普通最小二乘法估計 <span class="math inline">\(\alpha, \beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#ResidualVar"><i class="fa fa-check"></i><b>26.5</b> 殘差方差的估計 Estimation of the residual variance <span class="math inline">\((\sigma^2)\)</span></a></li>
<li class="chapter" data-level="26.6" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#growgam"><i class="fa fa-check"></i><b>26.6</b> R 演示 例 1： 圖 @ref(fig:age-wt) 數據</a></li>
<li class="chapter" data-level="26.7" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#binarylms"><i class="fa fa-check"></i><b>26.7</b> R 演示 例 2： 表@ref(tab:walk) 數據</a></li>
<li class="chapter" data-level="26.8" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#exeChol"><i class="fa fa-check"></i><b>26.8</b> 練習</a><ul>
<li class="chapter" data-level="26.8.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩次測量的膽固醇水平分別用-c_1-c_2-來標記的話考慮這樣的簡單線性迴歸模型c_2alphabeta-c_2-varepsilon我們進行這樣迴歸的前提假設有哪些"><i class="fa fa-check"></i><b>26.8.1</b> 兩次測量的膽固醇水平分別用 <span class="math inline">\(C_1, C_2\)</span> 來標記的話，考慮這樣的簡單線性迴歸模型：<span class="math inline">\(C_2=\alpha+\beta C_2 + \varepsilon\)</span>。我們進行這樣迴歸的前提假設有哪些？</a></li>
<li class="chapter" data-level="26.8.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#計算普通最小二乘法-ols-下截距和斜率的估計值-hatalpha-hatbeta"><i class="fa fa-check"></i><b>26.8.2</b> 計算普通最小二乘法 (OLS) 下，截距和斜率的估計值 <span class="math inline">\(\hat\alpha, \hat\beta\)</span></a></li>
<li class="chapter" data-level="26.8.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#和迴歸模型計算的結果作比較解釋這些估計值的含義"><i class="fa fa-check"></i><b>26.8.3</b> 和迴歸模型計算的結果作比較，解釋這些估計值的含義</a></li>
<li class="chapter" data-level="26.8.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#加上計算的估計值直線-即迴歸直線"><i class="fa fa-check"></i><b>26.8.4</b> 加上計算的估計值直線 (即迴歸直線)</a></li>
<li class="chapter" data-level="26.8.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#diagnosis"><i class="fa fa-check"></i><b>26.8.5</b> 下面的代碼用於模型的假設診斷</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#最小二乘估計的性質和推斷-ordinary-least-squares-estimators-and-inference"><i class="fa fa-check"></i><b>27</b> 最小二乘估計的性質和推斷 Ordinary Least Squares Estimators and Inference</a><ul>
<li class="chapter" data-level="27.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#ols-估計量的性質"><i class="fa fa-check"></i><b>27.1</b> OLS 估計量的性質</a></li>
<li class="chapter" data-level="27.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#beta"><i class="fa fa-check"></i><b>27.2</b> <span class="math inline">\(\hat\beta\)</span> 的性質</a><ul>
<li class="chapter" data-level="27.2.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#randbeta"><i class="fa fa-check"></i><b>27.2.1</b> <span class="math inline">\(Y\)</span> 對 <span class="math inline">\(X\)</span> 迴歸， 和 <span class="math inline">\(X\)</span> 對 <span class="math inline">\(Y\)</span> 迴歸</a></li>
<li class="chapter" data-level="27.2.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#例-1-還是圖-reffigage-wt-數據"><i class="fa fa-check"></i><b>27.2.2</b> 例 1： 還是圖 @ref(fig:age-wt) 數據</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#截距和迴歸係數的方差協方差"><i class="fa fa-check"></i><b>27.3</b> 截距和迴歸係數的方差，協方差</a><ul>
<li class="chapter" data-level="27.3.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#centring"><i class="fa fa-check"></i><b>27.3.1</b> 中心化 centring</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#alpha-beta-的推斷"><i class="fa fa-check"></i><b>27.4</b> <span class="math inline">\(\alpha, \beta\)</span> 的推斷</a><ul>
<li class="chapter" data-level="27.4.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#對迴歸係數進行假設檢驗"><i class="fa fa-check"></i><b>27.4.1</b> 對迴歸係數進行假設檢驗</a></li>
<li class="chapter" data-level="27.4.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#迴歸係數截距的信賴區間"><i class="fa fa-check"></i><b>27.4.2</b> 迴歸係數，截距的信賴區間</a></li>
<li class="chapter" data-level="27.4.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#預測值的信賴區間-置信帶---測量迴歸曲線本身的不確定性"><i class="fa fa-check"></i><b>27.4.3</b> 預測值的信賴區間 (置信帶) - 測量迴歸曲線本身的不確定性</a></li>
<li class="chapter" data-level="27.4.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#預測帶-reference-range---包含了-95-觀察值的區間"><i class="fa fa-check"></i><b>27.4.4</b> 預測帶 Reference range - 包含了 95% 觀察值的區間</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#rsquare"><i class="fa fa-check"></i><b>27.5</b> 線性迴歸模型和 Pearson 相關係數</a><ul>
<li class="chapter" data-level="27.5.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#r2-可以理解爲因變量平方和被模型解釋的比例"><i class="fa fa-check"></i><b>27.5.1</b> <span class="math inline">\(r^2\)</span> 可以理解爲因變量平方和被模型解釋的比例</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#t-r2-F"><i class="fa fa-check"></i><b>27.6</b> Pearson 相關係數和模型迴歸係數的檢驗統計量 <span class="math inline">\(t\)</span> 之間的關係</a></li>
<li class="chapter" data-level="27.7" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#練習-2"><i class="fa fa-check"></i><b>27.7</b> 練習</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#ANOVA"><i class="fa fa-check"></i><b>28</b> 方差分析 Introduction to Analysis of Variance</a><ul>
<li class="chapter" data-level="28.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#背景"><i class="fa fa-check"></i><b>28.1</b> 背景</a></li>
<li class="chapter" data-level="28.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#簡單線性迴歸模型的方差分析"><i class="fa fa-check"></i><b>28.2</b> 簡單線性迴歸模型的方差分析</a><ul>
<li class="chapter" data-level="28.2.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩個模型的參數估計"><i class="fa fa-check"></i><b>28.2.1</b> 兩個模型的參數估計</a></li>
<li class="chapter" data-level="28.2.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#分割零假設模型的殘差平方和"><i class="fa fa-check"></i><b>28.2.2</b> 分割零假設模型的殘差平方和</a></li>
<li class="chapter" data-level="28.2.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#Rsquare"><i class="fa fa-check"></i><b>28.2.3</b> <span class="math inline">\(R^2\)</span> – 我的名字叫<strong>決定係數</strong> coefficient of determination</a></li>
<li class="chapter" data-level="28.2.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#方差分析表格-the-anova-table"><i class="fa fa-check"></i><b>28.2.4</b> 方差分析表格 the ANOVA table</a></li>
<li class="chapter" data-level="28.2.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#用-anova-進行假設檢驗"><i class="fa fa-check"></i><b>28.2.5</b> 用 ANOVA 進行假設檢驗</a></li>
<li class="chapter" data-level="28.2.6" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#lm-Ftest"><i class="fa fa-check"></i><b>28.2.6</b> 簡單線性迴歸時的 <span class="math inline">\(F\)</span> 檢驗</a></li>
<li class="chapter" data-level="28.2.7" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#F-t-same"><i class="fa fa-check"></i><b>28.2.7</b> 簡單線性迴歸時 <span class="math inline">\(F\)</span> 檢驗和 <span class="math inline">\(t\)</span> 檢驗的一致性</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#分類變量用作預測變量時的-anova"><i class="fa fa-check"></i><b>28.3</b> 分類變量用作預測變量時的 ANOVA</a><ul>
<li class="chapter" data-level="28.3.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#一個二分類預測變量"><i class="fa fa-check"></i><b>28.3.1</b> 一個二分類預測變量</a></li>
<li class="chapter" data-level="28.3.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#一個模型兩種表述"><i class="fa fa-check"></i><b>28.3.2</b> 一個模型，兩種表述</a></li>
<li class="chapter" data-level="28.3.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#分組變量的平方和"><i class="fa fa-check"></i><b>28.3.3</b> 分組變量的平方和</a></li>
<li class="chapter" data-level="28.3.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#簡單模型的分組變量大於兩組的情況"><i class="fa fa-check"></i><b>28.3.4</b> 簡單模型的分組變量大於兩組的情況</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#多元模型分析-multivariable-models"><i class="fa fa-check"></i><b>29</b> 多元模型分析 Multivariable Models</a><ul>
<li class="chapter" data-level="29.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩個預測變量的線性迴歸模型"><i class="fa fa-check"></i><b>29.1</b> 兩個預測變量的線性迴歸模型</a><ul>
<li class="chapter" data-level="29.1.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#數學標記法和解釋"><i class="fa fa-check"></i><b>29.1.1</b> 數學標記法和解釋</a></li>
<li class="chapter" data-level="29.1.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#最小平方和估計-least-squares-estimation"><i class="fa fa-check"></i><b>29.1.2</b> 最小平方和估計 Least Squares Estimation</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#線性回歸模型中使用分組變量"><i class="fa fa-check"></i><b>29.2</b> 線性回歸模型中使用分組變量</a></li>
<li class="chapter" data-level="29.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#協方差分析模型-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>29.3</b> 協方差分析模型 the Analysis of Covariance (ANCOVA) Model</a></li>
<li class="chapter" data-level="29.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#偏回歸係數的變化"><i class="fa fa-check"></i><b>29.4</b> 偏回歸係數的變化</a><ul>
<li class="chapter" data-level="29.4.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#情況1-beta_1-beta_1"><i class="fa fa-check"></i><b>29.4.1</b> 情況1： <span class="math inline">\(\beta_1 &gt; \beta_1^*\)</span></a></li>
<li class="chapter" data-level="29.4.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#情況2beta_1beta_1"><i class="fa fa-check"></i><b>29.4.2</b> 情況2：<span class="math inline">\(\beta_1&lt;\beta_1^*\)</span></a></li>
<li class="chapter" data-level="29.4.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#情況3-beta_1-beta_1"><i class="fa fa-check"></i><b>29.4.3</b> 情況3： <span class="math inline">\(\beta_1 = \beta_1^*\)</span></a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#confounding"><i class="fa fa-check"></i><b>29.5</b> 混雜 confounding</a><ul>
<li class="chapter" data-level="29.5.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#作為媒介-mediation-effect"><i class="fa fa-check"></i><b>29.5.1</b> 作為媒介 mediation effect</a></li>
<li class="chapter" data-level="29.5.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩個預測變量之間的關係"><i class="fa fa-check"></i><b>29.5.2</b> 兩個預測變量之間的關係</a></li>
<li class="chapter" data-level="29.5.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#rct臨床實驗是個特例"><i class="fa fa-check"></i><b>29.5.3</b> RCT臨床實驗是個特例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#多元模型分析矩陣標記與其意義"><i class="fa fa-check"></i><b>30</b> 多元模型分析：矩陣標記與其意義</a><ul>
<li class="chapter" data-level="30.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#線性回歸模型的矩陣非矩陣標記法"><i class="fa fa-check"></i><b>30.1</b> 線性回歸模型的矩陣/非矩陣標記法</a><ul>
<li class="chapter" data-level="30.1.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#模型標記"><i class="fa fa-check"></i><b>30.1.1</b> 模型標記：</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#解讀參數"><i class="fa fa-check"></i><b>30.2</b> 解讀參數</a><ul>
<li class="chapter" data-level="30.2.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#最小二乘估計"><i class="fa fa-check"></i><b>30.2.1</b> 最小二乘估計</a></li>
<li class="chapter" data-level="30.2.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#因變量的期待值-mathbfhat-y"><i class="fa fa-check"></i><b>30.2.2</b> 因變量的期待值 <span class="math inline">\(\mathbf{\hat Y}\)</span></a></li>
<li class="chapter" data-level="30.2.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#殘差"><i class="fa fa-check"></i><b>30.2.3</b> 殘差</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#方差分析一般化和-f-檢驗"><i class="fa fa-check"></i><b>30.3</b> 方差分析一般化和 <span class="math inline">\(F\)</span> 檢驗</a><ul>
<li class="chapter" data-level="30.3.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#多元線性迴歸時的決定係數和殘差方差"><i class="fa fa-check"></i><b>30.3.1</b> 多元線性迴歸時的決定係數和殘差方差</a></li>
<li class="chapter" data-level="30.3.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#方差分析表格"><i class="fa fa-check"></i><b>30.3.2</b> 方差分析表格</a></li>
<li class="chapter" data-level="30.3.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#globalsig"><i class="fa fa-check"></i><b>30.3.3</b> 迴歸方程的顯著性檢驗</a></li>
<li class="chapter" data-level="30.3.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#partialF"><i class="fa fa-check"></i><b>30.3.4</b> <span class="math inline">\(\text{partial }F\)</span> 檢驗</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#添加新變量對迴歸模型的影響"><i class="fa fa-check"></i><b>30.4</b> 添加新變量對迴歸模型的影響</a><ul>
<li class="chapter" data-level="30.4.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#偏迴歸係數方差的改變"><i class="fa fa-check"></i><b>30.4.1</b> 偏迴歸係數方差的改變</a></li>
<li class="chapter" data-level="30.4.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#偏迴歸係數檢驗結果的改變"><i class="fa fa-check"></i><b>30.4.2</b> 偏迴歸係數檢驗結果的改變</a></li>
<li class="chapter" data-level="30.4.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#擬合值的改變"><i class="fa fa-check"></i><b>30.4.3</b> 擬合值的改變</a></li>
<li class="chapter" data-level="30.4.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#決定係數的改變"><i class="fa fa-check"></i><b>30.4.4</b> 決定係數的改變</a></li>
<li class="chapter" data-level="30.4.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#共線性-collinearity"><i class="fa fa-check"></i><b>30.4.5</b> 共線性 collinearity</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#實戰演習"><i class="fa fa-check"></i><b>30.5</b> 實戰演習</a><ul>
<li class="chapter" data-level="30.5.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#血清維生素-c-濃度的預測變量"><i class="fa fa-check"></i><b>30.5.1</b> 血清維生素 C 濃度的預測變量</a></li>
<li class="chapter" data-level="30.5.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#紅細胞容積與血紅蛋白"><i class="fa fa-check"></i><b>30.5.2</b> 紅細胞容積與血紅蛋白</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#線性迴歸的模型診斷"><i class="fa fa-check"></i><b>31</b> 線性迴歸的模型診斷</a><ul>
<li class="chapter" data-level="31.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#線性迴歸模型的前提條件"><i class="fa fa-check"></i><b>31.1</b> 線性迴歸模型的前提條件</a></li>
<li class="chapter" data-level="31.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#用圖形來視覺診斷"><i class="fa fa-check"></i><b>31.2</b> 用圖形來視覺診斷</a></li>
<li class="chapter" data-level="31.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#殘差圖"><i class="fa fa-check"></i><b>31.3</b> 殘差圖</a></li>
<li class="chapter" data-level="31.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#殘差正態圖-normal-plot-of-residuals"><i class="fa fa-check"></i><b>31.4</b> 殘差正態圖 normal plot of residuals</a><ul>
<li class="chapter" data-level="31.4.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#模型診斷實例"><i class="fa fa-check"></i><b>31.4.1</b> 模型診斷實例</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#前提條件的統計學檢驗"><i class="fa fa-check"></i><b>31.5</b> 前提條件的統計學檢驗</a><ul>
<li class="chapter" data-level="31.5.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#二次方程迴歸法檢驗非線性"><i class="fa fa-check"></i><b>31.5.1</b> 二次方程迴歸法檢驗非線性</a></li>
<li class="chapter" data-level="31.5.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#非線性關係模型"><i class="fa fa-check"></i><b>31.5.2</b> 非線性關係模型</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#異常值槓桿值和庫克距離"><i class="fa fa-check"></i><b>31.6</b> 異常值，槓桿值，和庫克距離</a><ul>
<li class="chapter" data-level="31.6.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#standardres"><i class="fa fa-check"></i><b>31.6.1</b> 異常值和標準化殘差</a></li>
<li class="chapter" data-level="31.6.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#槓桿值-leverage"><i class="fa fa-check"></i><b>31.6.2</b> 槓桿值 Leverage</a></li>
<li class="chapter" data-level="31.6.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#庫克距離-cooks-distance"><i class="fa fa-check"></i><b>31.6.3</b> 庫克距離 Cook’s Distance</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#在統計忍者包裏面對模型診斷作圖"><i class="fa fa-check"></i><b>31.7</b> 在統計忍者包裏面對模型診斷作圖</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#interaction"><i class="fa fa-check"></i><b>32</b> 交互作用 Interactions</a><ul>
<li class="chapter" data-level="32.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩個預測變量之間的線性模型交互作用"><i class="fa fa-check"></i><b>32.1</b> 兩個預測變量之間的線性模型交互作用</a><ul>
<li class="chapter" data-level="32.1.1" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#交互作用線性模型的一般表達式"><i class="fa fa-check"></i><b>32.1.1</b> 交互作用線性模型的一般表達式</a></li>
<li class="chapter" data-level="32.1.2" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#interaction-cont-bin"><i class="fa fa-check"></i><b>32.1.2</b> 連續型變量和二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="32.1.3" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩個二分類變量之間的交互作用"><i class="fa fa-check"></i><b>32.1.3</b> 兩個二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="32.1.4" data-path="04-Linear-Regression.html"><a href="04-Linear-Regression.html#兩個連續變量之間的交互作用"><i class="fa fa-check"></i><b>32.1.4</b> 兩個連續變量之間的交互作用</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V 臨床實驗 Clinical Trials</b></span></li>
<li class="chapter" data-level="33" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html"><i class="fa fa-check"></i><b>33</b> 樣本量計算問題</a><ul>
<li class="chapter" data-level="33.1" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#背景-1"><i class="fa fa-check"></i><b>33.1</b> 背景</a></li>
<li class="chapter" data-level="33.2" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#決定所需樣本量大小的統計學因素"><i class="fa fa-check"></i><b>33.2</b> 決定所需樣本量大小的統計學因素</a></li>
<li class="chapter" data-level="33.3" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#第一類和第二類錯誤-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>33.3</b> 第一類和第二類錯誤 Type I and type II errors</a></li>
<li class="chapter" data-level="33.4" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#比較兩組之間的百分比-percentages-or-proportions"><i class="fa fa-check"></i><b>33.4</b> 比較兩組之間的百分比 (percentages or proportions)</a><ul>
<li class="chapter" data-level="33.4.1" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#樣本量計算公式-使用顯著水平-5-和檢驗效能-90"><i class="fa fa-check"></i><b>33.4.1</b> 樣本量計算公式 (使用顯著水平 5%, 和檢驗效能 90%)</a></li>
<li class="chapter" data-level="33.4.2" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#樣本量計算公式的一般化-不同的顯著水平和檢驗效能條件下"><i class="fa fa-check"></i><b>33.4.2</b> 樣本量計算公式的一般化 (不同的顯著水平和檢驗效能條件下)</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#比較兩組之間的均值"><i class="fa fa-check"></i><b>33.5</b> 比較兩組之間的均值</a><ul>
<li class="chapter" data-level="33.5.1" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#樣本量計算公式"><i class="fa fa-check"></i><b>33.5.1</b> 樣本量計算公式</a></li>
</ul></li>
<li class="chapter" data-level="33.6" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#樣本量計算的調整"><i class="fa fa-check"></i><b>33.6</b> 樣本量計算的調整</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="05-clinical-trials.html"><a href="05-clinical-trials.html#baseline-adjustment-using-ancova"><i class="fa fa-check"></i><b>34</b> Baseline Adjustment using ANCOVA</a></li>
<li class="part"><span><b>VI 穩健統計方法 Robust Statistic Methods</b></span></li>
<li class="chapter" data-level="35" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html"><i class="fa fa-check"></i><b>35</b> 穩健統計方法入門</a></li>
<li class="chapter" data-level="36" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#基於秩次的非參數檢驗"><i class="fa fa-check"></i><b>36</b> 基於秩次的非參數檢驗</a><ul>
<li class="chapter" data-level="36.1" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#sign-test"><i class="fa fa-check"></i><b>36.1</b> 符號檢驗 the Sign test</a><ul>
<li class="chapter" data-level="36.1.1" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#符號檢驗的特點"><i class="fa fa-check"></i><b>36.1.1</b> 符號檢驗的特點</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#Wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>36.2</b> Wilcoxon 符號秩和檢驗，the Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="36.3" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#wilcoxon-mann-whitney-wmw-檢驗"><i class="fa fa-check"></i><b>36.3</b> Wilcoxon-Mann-Whitney (WMW) 檢驗</a></li>
<li class="chapter" data-level="36.4" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#秩相關spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>36.4</b> 秩相關，Spearman’s Rank Correlation Coefficient</a></li>
<li class="chapter" data-level="36.5" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#基於秩次的非參數檢驗的優缺點"><i class="fa fa-check"></i><b>36.5</b> 基於秩次的非參數檢驗的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#排列置換法-permutation-procedures"><i class="fa fa-check"></i><b>37</b> 排列置換法 Permutation procedures</a><ul>
<li class="chapter" data-level="37.1" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#背景介紹-1"><i class="fa fa-check"></i><b>37.1</b> 背景介紹</a></li>
<li class="chapter" data-level="37.2" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#直接上實例"><i class="fa fa-check"></i><b>37.2</b> 直接上實例</a></li>
<li class="chapter" data-level="37.3" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#排列置換法三板斧"><i class="fa fa-check"></i><b>37.3</b> 排列置換法三板斧</a><ul>
<li class="chapter" data-level="37.3.1" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#該如何選用合適的檢驗統計量-t"><i class="fa fa-check"></i><b>37.3.1</b> 該如何選用合適的檢驗統計量 <span class="math inline">\(T\)</span>？</a></li>
<li class="chapter" data-level="37.3.2" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#可以在排列置換法中對其他變量進行統計學調整-adjustment-嗎"><i class="fa fa-check"></i><b>37.3.2</b> 可以在排列置換法中對其他變量進行統計學調整 (adjustment) 嗎？</a></li>
<li class="chapter" data-level="37.3.3" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#排列置換法基於秩次的非參數檢驗之間的關係"><i class="fa fa-check"></i><b>37.3.3</b> 排列置換法，基於秩次的非參數檢驗之間的關係</a></li>
<li class="chapter" data-level="37.3.4" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#排列置換檢驗法是一種精確檢驗"><i class="fa fa-check"></i><b>37.3.4</b> 排列置換檢驗法，是一種精確檢驗</a></li>
</ul></li>
<li class="chapter" data-level="37.4" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#基於排序置換檢驗法計算信賴區間"><i class="fa fa-check"></i><b>37.4</b> 基於排序置換檢驗法計算信賴區間</a></li>
<li class="chapter" data-level="37.5" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#排序置換法的優缺點"><i class="fa fa-check"></i><b>37.5</b> 排序置換法的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#自助重抽法-the-bootstrap"><i class="fa fa-check"></i><b>38</b> 自助重抽法 The bootstrap</a><ul>
<li class="chapter" data-level="38.1" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#定義-1"><i class="fa fa-check"></i><b>38.1</b> 定義</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="06-RobustStatistic.html"><a href="06-RobustStatistic.html#the-sandwich-estimator"><i class="fa fa-check"></i><b>39</b> The sandwich estimator</a></li>
<li class="part"><span><b>VII 貝葉斯統計</b></span></li>
<li class="chapter" data-level="40" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html"><i class="fa fa-check"></i><b>40</b> 貝葉斯統計入門</a><ul>
<li class="chapter" data-level="40.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#概率論推斷的複習"><i class="fa fa-check"></i><b>40.1</b> 概率論推斷的複習</a></li>
<li class="chapter" data-level="40.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯概率推理逆概率-bayesian-reasoninginverse-probability"><i class="fa fa-check"></i><b>40.2</b> 貝葉斯概率推理/逆概率 Bayesian reasoning/inverse probability</a><ul>
<li class="chapter" data-level="40.2.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#演繹推理-deductive-reasoning-和-三段論-weak-syllogisms"><i class="fa fa-check"></i><b>40.2.1</b> 演繹推理 deductive reasoning 和 三段論 weak syllogisms</a></li>
<li class="chapter" data-level="40.2.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#如何給可能性定量-quantifying-plausibility"><i class="fa fa-check"></i><b>40.2.2</b> 如何給可能性定量 Quantifying plausibility</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯推理的統計學實現"><i class="fa fa-check"></i><b>40.3</b> 貝葉斯推理的統計學實現</a><ul>
<li class="chapter" data-level="40.3.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#醫學診斷測試-diagnostic-testing"><i class="fa fa-check"></i><b>40.3.1</b> 醫學診斷測試 diagnostic testing</a></li>
<li class="chapter" data-level="40.3.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#hiv-檢查時的應用"><i class="fa fa-check"></i><b>40.3.2</b> HIV 檢查時的應用</a></li>
<li class="chapter" data-level="40.3.3" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#說點小歷史"><i class="fa fa-check"></i><b>40.3.3</b> 說點小歷史</a></li>
</ul></li>
<li class="chapter" data-level="40.4" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#練習題-5"><i class="fa fa-check"></i><b>40.4</b> 練習題</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯定理的應用單一參數模型"><i class="fa fa-check"></i><b>41</b> 貝葉斯定理的應用：單一參數模型</a><ul>
<li class="chapter" data-level="41.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯理論下的事後二項分佈概率密度方程-notation-for-probability-density-functions"><i class="fa fa-check"></i><b>41.1</b> 貝葉斯理論下的事後二項分佈概率密度方程 notation for probability density functions</a></li>
<li class="chapter" data-level="41.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#theta-的先驗概率"><i class="fa fa-check"></i><b>41.2</b> <span class="math inline">\(\theta\)</span> 的先驗概率</a><ul>
<li class="chapter" data-level="41.2.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#beta-distribution-intro"><i class="fa fa-check"></i><b>41.2.1</b> beta 分佈 the beta distribution</a></li>
<li class="chapter" data-level="41.2.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#conjugate"><i class="fa fa-check"></i><b>41.2.2</b> 二項分佈數據事後概率分佈的一般化：共軛性</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#附贈加量不加價"><i class="fa fa-check"></i><b>41.3</b> 附贈–加量不加價</a></li>
<li class="chapter" data-level="41.4" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#練習題-6"><i class="fa fa-check"></i><b>41.4</b> 練習題</a><ul>
<li class="chapter" data-level="41.4.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#q1-4"><i class="fa fa-check"></i><b>41.4.1</b> Q1</a></li>
<li class="chapter" data-level="41.4.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#q2-3"><i class="fa fa-check"></i><b>41.4.2</b> Q2</a></li>
<li class="chapter" data-level="41.4.3" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#q3-2"><i class="fa fa-check"></i><b>41.4.3</b> Q3</a></li>
<li class="chapter" data-level="41.4.4" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#q4"><i class="fa fa-check"></i><b>41.4.4</b> Q4</a></li>
<li class="chapter" data-level="41.4.5" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#q5"><i class="fa fa-check"></i><b>41.4.5</b> Q5</a></li>
<li class="chapter" data-level="41.4.6" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#q6"><i class="fa fa-check"></i><b>41.4.6</b> Q6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="42" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯理論在正態分布數據中的應用-normal-distribution-applying-bayes-theorem"><i class="fa fa-check"></i><b>42</b> 貝葉斯理論在正態分布數據中的應用 Normal distribution applying Bayes’ Theorem</a><ul>
<li class="chapter" data-level="42.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#事後概率的總結方法"><i class="fa fa-check"></i><b>42.1</b> 事後概率的總結方法</a></li>
<li class="chapter" data-level="42.2" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯統計推斷中的正態分布"><i class="fa fa-check"></i><b>42.2</b> 貝葉斯統計推斷中的正態分布</a><ul>
<li class="chapter" data-level="42.2.1" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#n-independent-identically-distributed-observations"><i class="fa fa-check"></i><b>42.2.1</b> <span class="math inline">\(n\)</span> independent identically distributed observations</a></li>
</ul></li>
<li class="chapter" data-level="42.3" data-path="08-Intro-to-Bayes.html"><a href="08-Intro-to-Bayes.html#貝葉斯預測分布"><i class="fa fa-check"></i><b>42.3</b> 貝葉斯預測分布</a></li>
</ul></li>
<li class="part"><span><b>VIII 廣義線性迴歸模型 Generalised Linear Regression</b></span></li>
<li class="chapter" data-level="43" data-path="09-GLM.html"><a href="09-GLM.html"><i class="fa fa-check"></i><b>43</b> 重要概念複習</a><ul>
<li class="chapter" data-level="43.1" data-path="09-GLM.html"><a href="09-GLM.html#概率論學派統計推斷要點複習"><i class="fa fa-check"></i><b>43.1</b> 概率論學派統計推斷要點複習</a></li>
<li class="chapter" data-level="43.2" data-path="09-GLM.html"><a href="09-GLM.html#似然"><i class="fa fa-check"></i><b>43.2</b> 似然</a></li>
<li class="chapter" data-level="43.3" data-path="09-GLM.html"><a href="09-GLM.html#極大似然估計"><i class="fa fa-check"></i><b>43.3</b> 極大似然估計</a></li>
<li class="chapter" data-level="43.4" data-path="09-GLM.html"><a href="09-GLM.html#關於假設檢驗的複習"><i class="fa fa-check"></i><b>43.4</b> 關於假設檢驗的複習</a><ul>
<li class="chapter" data-level="43.4.1" data-path="09-GLM.html"><a href="09-GLM.html#子集似然函數"><i class="fa fa-check"></i><b>43.4.1</b> 子集似然函數</a></li>
</ul></li>
<li class="chapter" data-level="43.5" data-path="09-GLM.html"><a href="09-GLM.html#線性迴歸複習"><i class="fa fa-check"></i><b>43.5</b> 線性迴歸複習</a><ul>
<li class="chapter" data-level="43.5.1" data-path="09-GLM.html"><a href="09-GLM.html#簡單線性迴歸"><i class="fa fa-check"></i><b>43.5.1</b> 簡單線性迴歸</a></li>
<li class="chapter" data-level="43.5.2" data-path="09-GLM.html"><a href="09-GLM.html#多元線性迴歸"><i class="fa fa-check"></i><b>43.5.2</b> 多元線性迴歸</a></li>
<li class="chapter" data-level="43.5.3" data-path="09-GLM.html"><a href="09-GLM.html#score-equations"><i class="fa fa-check"></i><b>43.5.3</b> 簡單線性迴歸的統計推斷</a></li>
</ul></li>
<li class="chapter" data-level="43.6" data-path="09-GLM.html"><a href="09-GLM.html#glm-practical-01"><i class="fa fa-check"></i><b>43.6</b> GLM-Practical 01</a><ul>
<li class="chapter" data-level="43.6.1" data-path="09-GLM.html"><a href="09-GLM.html#建立似然方程"><i class="fa fa-check"></i><b>43.6.1</b> 建立似然方程</a></li>
<li class="chapter" data-level="43.6.2" data-path="09-GLM.html"><a href="09-GLM.html#建立對數似然方程"><i class="fa fa-check"></i><b>43.6.2</b> 建立對數似然方程</a></li>
<li class="chapter" data-level="43.6.3" data-path="09-GLM.html"><a href="09-GLM.html#線性回歸模型"><i class="fa fa-check"></i><b>43.6.3</b> 線性回歸模型</a></li>
<li class="chapter" data-level="43.6.4" data-path="09-GLM.html"><a href="09-GLM.html#似然比檢驗wald-檢驗score-檢驗"><i class="fa fa-check"></i><b>43.6.4</b> 似然比檢驗，Wald 檢驗，Score 檢驗</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="09-GLM.html"><a href="09-GLM.html#廣義線性迴歸入門"><i class="fa fa-check"></i><b>44</b> 廣義線性迴歸入門</a><ul>
<li class="chapter" data-level="44.1" data-path="09-GLM.html"><a href="09-GLM.html#指數分佈家族"><i class="fa fa-check"></i><b>44.1</b> 指數分佈家族</a><ul>
<li class="chapter" data-level="44.1.1" data-path="09-GLM.html"><a href="09-GLM.html#泊松分佈和二項分佈的指數分佈家族屬性"><i class="fa fa-check"></i><b>44.1.1</b> 泊松分佈和二項分佈的指數分佈家族屬性</a></li>
<li class="chapter" data-level="44.1.2" data-path="09-GLM.html"><a href="09-GLM.html#exercise.-exponential-distribution"><i class="fa fa-check"></i><b>44.1.2</b> Exercise. Exponential distribution</a></li>
</ul></li>
<li class="chapter" data-level="44.2" data-path="09-GLM.html"><a href="09-GLM.html#defineaGLM"><i class="fa fa-check"></i><b>44.2</b> 廣義線性迴歸模型之定義</a></li>
<li class="chapter" data-level="44.3" data-path="09-GLM.html"><a href="09-GLM.html#注意"><i class="fa fa-check"></i><b>44.3</b> 注意</a></li>
<li class="chapter" data-level="44.4" data-path="09-GLM.html"><a href="09-GLM.html#如何在-r-裏擬合-glm"><i class="fa fa-check"></i><b>44.4</b> 如何在 R 裏擬合 “GLM”</a><ul>
<li class="chapter" data-level="44.4.1" data-path="09-GLM.html"><a href="09-GLM.html#margins-命令"><i class="fa fa-check"></i><b>44.4.1</b> <code>margins</code> 命令</a></li>
<li class="chapter" data-level="44.4.2" data-path="09-GLM.html"><a href="09-GLM.html#ggplot2geom_smoothmethod-loess-命令"><i class="fa fa-check"></i><b>44.4.2</b> <code>ggplot2::geom_smooth(method = "loess")</code> 命令</a></li>
</ul></li>
<li class="chapter" data-level="44.5" data-path="09-GLM.html"><a href="09-GLM.html#glm-practical-02"><i class="fa fa-check"></i><b>44.5</b> GLM-Practical 02</a><ul>
<li class="chapter" data-level="44.5.1" data-path="09-GLM.html"><a href="09-GLM.html#思考本章中指數分布家族的參數設置假如有一個觀測值-y-來自指數家族試求證"><i class="fa fa-check"></i><b>44.5.1</b> 思考本章中指數分布家族的參數設置。假如，有一個觀測值 <span class="math inline">\(y\)</span> 來自指數家族。試求證:</a></li>
<li class="chapter" data-level="44.5.2" data-path="09-GLM.html"><a href="09-GLM.html#r-練習"><i class="fa fa-check"></i><b>44.5.2</b> R 練習</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="45" data-path="09-GLM.html"><a href="09-GLM.html#二項分佈數據的廣義線性迴歸模型-logistic-regression-model"><i class="fa fa-check"></i><b>45</b> 二項分佈數據的廣義線性迴歸模型 logistic regression model</a><ul>
<li class="chapter" data-level="45.1" data-path="09-GLM.html"><a href="09-GLM.html#彙總後個人-grouped-individual-的二項分佈數據"><i class="fa fa-check"></i><b>45.1</b> 彙總後/個人 (grouped / individual) 的二項分佈數據</a></li>
<li class="chapter" data-level="45.2" data-path="09-GLM.html"><a href="09-GLM.html#二項分佈數據的廣義線性迴歸模型"><i class="fa fa-check"></i><b>45.2</b> 二項分佈數據的廣義線性迴歸模型</a></li>
<li class="chapter" data-level="45.3" data-path="09-GLM.html"><a href="09-GLM.html#logit-or-log"><i class="fa fa-check"></i><b>45.3</b> 注</a><ul>
<li class="chapter" data-level="45.3.1" data-path="09-GLM.html"><a href="09-GLM.html#exercise.-link-functions."><i class="fa fa-check"></i><b>45.3.1</b> Exercise. Link functions.</a></li>
</ul></li>
<li class="chapter" data-level="45.4" data-path="09-GLM.html"><a href="09-GLM.html#邏輯迴歸模型迴歸係數的實際意義"><i class="fa fa-check"></i><b>45.4</b> 邏輯迴歸模型迴歸係數的實際意義</a></li>
<li class="chapter" data-level="45.5" data-path="09-GLM.html"><a href="09-GLM.html#BSEinfection"><i class="fa fa-check"></i><b>45.5</b> 邏輯迴歸實際案例</a><ul>
<li class="chapter" data-level="45.5.1" data-path="09-GLM.html"><a href="09-GLM.html#分析目的"><i class="fa fa-check"></i><b>45.5.1</b> 分析目的</a></li>
<li class="chapter" data-level="45.5.2" data-path="09-GLM.html"><a href="09-GLM.html#模型-1-飼料-羣"><i class="fa fa-check"></i><b>45.5.2</b> 模型 1 飼料 + 羣</a></li>
<li class="chapter" data-level="45.5.3" data-path="09-GLM.html"><a href="09-GLM.html#模型-2-增加交互作用項-飼料-times-羣"><i class="fa fa-check"></i><b>45.5.3</b> 模型 2 增加交互作用項 飼料 <span class="math inline">\(\times\)</span> 羣</a></li>
</ul></li>
<li class="chapter" data-level="45.6" data-path="09-GLM.html"><a href="09-GLM.html#glm-practical-03"><i class="fa fa-check"></i><b>45.6</b> GLM-Practical 03</a><ul>
<li class="chapter" data-level="45.6.1" data-path="09-GLM.html"><a href="09-GLM.html#昆蟲的死亡率"><i class="fa fa-check"></i><b>45.6.1</b> 昆蟲的死亡率</a></li>
<li class="chapter" data-level="45.6.2" data-path="09-GLM.html"><a href="09-GLM.html#哮喘門診數據"><i class="fa fa-check"></i><b>45.6.2</b> 哮喘門診數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="46" data-path="09-GLM.html"><a href="09-GLM.html#模型比較和擬合優度"><i class="fa fa-check"></i><b>46</b> 模型比較和擬合優度</a><ul>
<li class="chapter" data-level="46.1" data-path="09-GLM.html"><a href="09-GLM.html#嵌套式模型的比較-nested-models"><i class="fa fa-check"></i><b>46.1</b> 嵌套式模型的比較 nested models</a></li>
<li class="chapter" data-level="46.2" data-path="09-GLM.html"><a href="09-GLM.html#嵌套式模型比較實例"><i class="fa fa-check"></i><b>46.2</b> 嵌套式模型比較實例</a></li>
<li class="chapter" data-level="46.3" data-path="09-GLM.html"><a href="09-GLM.html#飽和模型模型的偏差擬合優度"><i class="fa fa-check"></i><b>46.3</b> 飽和模型，模型的偏差，擬合優度</a><ul>
<li class="chapter" data-level="46.3.1" data-path="09-GLM.html"><a href="09-GLM.html#飽和模型-saturated-model"><i class="fa fa-check"></i><b>46.3.1</b> 飽和模型 saturated model</a></li>
<li class="chapter" data-level="46.3.2" data-path="09-GLM.html"><a href="09-GLM.html#deviance"><i class="fa fa-check"></i><b>46.3.2</b> 模型偏差 deviance</a></li>
<li class="chapter" data-level="46.3.3" data-path="09-GLM.html"><a href="09-GLM.html#彙總型二項分佈數據-aggregatedgrouped-binary-data"><i class="fa fa-check"></i><b>46.3.3</b> 彙總型二項分佈數據 aggregated/grouped binary data</a></li>
</ul></li>
<li class="chapter" data-level="46.4" data-path="09-GLM.html"><a href="09-GLM.html#gof"><i class="fa fa-check"></i><b>46.4</b> 個人數據擬合模型的優度檢驗</a></li>
<li class="chapter" data-level="46.5" data-path="09-GLM.html"><a href="09-GLM.html#glm-practical-04"><i class="fa fa-check"></i><b>46.5</b> GLM Practical 04</a><ul>
<li class="chapter" data-level="46.5.1" data-path="09-GLM.html"><a href="09-GLM.html#回到之前的昆蟲數據嘗試評價該模型的擬合優度"><i class="fa fa-check"></i><b>46.5.1</b> 回到之前的昆蟲數據，嘗試評價該模型的擬合優度。</a></li>
<li class="chapter" data-level="46.5.2" data-path="09-GLM.html"><a href="09-GLM.html#低出生體重數據"><i class="fa fa-check"></i><b>46.5.2</b> 低出生體重數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="47" data-path="09-GLM.html"><a href="09-GLM.html#計數型因變量-poisson-regression"><i class="fa fa-check"></i><b>47</b> 計數型因變量 Poisson regression</a><ul>
<li class="chapter" data-level="47.1" data-path="09-GLM.html"><a href="09-GLM.html#泊松-glm"><i class="fa fa-check"></i><b>47.1</b> 泊松 GLM</a></li>
<li class="chapter" data-level="47.2" data-path="09-GLM.html"><a href="09-GLM.html#泊松迴歸實例"><i class="fa fa-check"></i><b>47.2</b> 泊松迴歸實例</a></li>
<li class="chapter" data-level="47.3" data-path="09-GLM.html"><a href="09-GLM.html#過度離散-overdispersion"><i class="fa fa-check"></i><b>47.3</b> 過度離散 overdispersion</a><ul>
<li class="chapter" data-level="47.3.1" data-path="09-GLM.html"><a href="09-GLM.html#過度離散怎麼查"><i class="fa fa-check"></i><b>47.3.1</b> 過度離散怎麼查？</a></li>
<li class="chapter" data-level="47.3.2" data-path="09-GLM.html"><a href="09-GLM.html#負二項式分佈模型-negative-binomial-model"><i class="fa fa-check"></i><b>47.3.2</b> 負二項式分佈模型 negative binomial model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="48" data-path="09-GLM.html"><a href="09-GLM.html#率的廣義線性迴歸-poisson-glm-for-rates"><i class="fa fa-check"></i><b>48</b> 率的廣義線性迴歸 Poisson GLM for rates</a><ul>
<li class="chapter" data-level="48.1" data-path="09-GLM.html"><a href="09-GLM.html#醫學中的率"><i class="fa fa-check"></i><b>48.1</b> 醫學中的率</a></li>
<li class="chapter" data-level="48.2" data-path="09-GLM.html"><a href="09-GLM.html#泊松過程"><i class="fa fa-check"></i><b>48.2</b> 泊松過程</a></li>
<li class="chapter" data-level="48.3" data-path="09-GLM.html"><a href="09-GLM.html#率的模型"><i class="fa fa-check"></i><b>48.3</b> 率的模型</a></li>
<li class="chapter" data-level="48.4" data-path="09-GLM.html"><a href="09-GLM.html#率的-glm"><i class="fa fa-check"></i><b>48.4</b> 率的 GLM</a></li>
<li class="chapter" data-level="48.5" data-path="09-GLM.html"><a href="09-GLM.html#實戰演練"><i class="fa fa-check"></i><b>48.5</b> 實戰演練</a><ul>
<li class="chapter" data-level="48.5.1" data-path="09-GLM.html"><a href="09-GLM.html#模型-1"><i class="fa fa-check"></i><b>48.5.1</b> 模型 1</a></li>
<li class="chapter" data-level="48.5.2" data-path="09-GLM.html"><a href="09-GLM.html#模型-2"><i class="fa fa-check"></i><b>48.5.2</b> 模型 2</a></li>
<li class="chapter" data-level="48.5.3" data-path="09-GLM.html"><a href="09-GLM.html#模型-3"><i class="fa fa-check"></i><b>48.5.3</b> 模型 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="49" data-path="09-GLM.html"><a href="09-GLM.html#混雜的調整交互作用和模型的可壓縮性"><i class="fa fa-check"></i><b>49</b> 混雜的調整，交互作用，和模型的可壓縮性</a><ul>
<li class="chapter" data-level="49.1" data-path="09-GLM.html"><a href="09-GLM.html#混雜因素的調整"><i class="fa fa-check"></i><b>49.1</b> 混雜因素的調整</a><ul>
<li class="chapter" data-level="49.1.1" data-path="09-GLM.html"><a href="09-GLM.html#woolf-法估算合併比值比"><i class="fa fa-check"></i><b>49.1.1</b> Woolf 法估算合併比值比</a></li>
</ul></li>
<li class="chapter" data-level="49.2" data-path="09-GLM.html"><a href="09-GLM.html#交互作用"><i class="fa fa-check"></i><b>49.2</b> 交互作用</a></li>
<li class="chapter" data-level="49.3" data-path="09-GLM.html"><a href="09-GLM.html#可壓縮性-collapsibility"><i class="fa fa-check"></i><b>49.3</b> 可壓縮性 collapsibility</a><ul>
<li class="chapter" data-level="49.3.1" data-path="09-GLM.html"><a href="09-GLM.html#線性迴歸的可壓縮性"><i class="fa fa-check"></i><b>49.3.1</b> 線性迴歸的可壓縮性</a></li>
<li class="chapter" data-level="49.3.2" data-path="09-GLM.html"><a href="09-GLM.html#collapsibility"><i class="fa fa-check"></i><b>49.3.2</b> 邏輯鏈接方程時的不可壓縮性</a></li>
</ul></li>
<li class="chapter" data-level="49.4" data-path="09-GLM.html"><a href="09-GLM.html#interaction-depend-scale"><i class="fa fa-check"></i><b>49.4</b> 交互作用對尺度的依賴性</a></li>
</ul></li>
<li class="chapter" data-level="50" data-path="09-GLM.html"><a href="09-GLM.html#流行病學中的邏輯迴歸"><i class="fa fa-check"></i><b>50</b> 流行病學中的邏輯迴歸</a><ul>
<li class="chapter" data-level="50.1" data-path="09-GLM.html"><a href="09-GLM.html#流行病學研究最常用的實驗設計"><i class="fa fa-check"></i><b>50.1</b> 流行病學研究最常用的實驗設計</a></li>
<li class="chapter" data-level="50.2" data-path="09-GLM.html"><a href="09-GLM.html#GLM8-3"><i class="fa fa-check"></i><b>50.2</b> 以簡單二分類暴露變量爲例</a><ul>
<li class="chapter" data-level="50.2.1" data-path="09-GLM.html"><a href="09-GLM.html#先決條件"><i class="fa fa-check"></i><b>50.2.1</b> 先決條件</a></li>
<li class="chapter" data-level="50.2.2" data-path="09-GLM.html"><a href="09-GLM.html#比值比-odds-ratios"><i class="fa fa-check"></i><b>50.2.2</b> 比值比 Odds ratios</a></li>
<li class="chapter" data-level="50.2.3" data-path="09-GLM.html"><a href="09-GLM.html#GLM8-3-4"><i class="fa fa-check"></i><b>50.2.3</b> 邏輯迴歸應用於病例對照研究的合理性</a></li>
</ul></li>
<li class="chapter" data-level="50.3" data-path="09-GLM.html"><a href="09-GLM.html#拓展到多個暴露變量的邏輯迴歸模型"><i class="fa fa-check"></i><b>50.3</b> 拓展到多個暴露變量的邏輯迴歸模型</a><ul>
<li class="chapter" data-level="50.3.1" data-path="09-GLM.html"><a href="09-GLM.html#mantel-haenszel-法"><i class="fa fa-check"></i><b>50.3.1</b> Mantel Haenszel 法</a></li>
<li class="chapter" data-level="50.3.2" data-path="09-GLM.html"><a href="09-GLM.html#隊列研究和病例對照研究的似然"><i class="fa fa-check"></i><b>50.3.2</b> 隊列研究和病例對照研究的似然</a></li>
<li class="chapter" data-level="50.3.3" data-path="09-GLM.html"><a href="09-GLM.html#病例對照研究中的邏輯迴歸"><i class="fa fa-check"></i><b>50.3.3</b> 病例對照研究中的邏輯迴歸</a></li>
</ul></li>
<li class="chapter" data-level="50.4" data-path="09-GLM.html"><a href="09-GLM.html#流行病學研究中變量的調整策略"><i class="fa fa-check"></i><b>50.4</b> 流行病學研究中變量的調整策略</a></li>
</ul></li>
<li class="chapter" data-level="51" data-path="09-GLM.html"><a href="09-GLM.html#分析策略"><i class="fa fa-check"></i><b>51</b> 分析策略</a><ul>
<li class="chapter" data-level="51.1" data-path="09-GLM.html"><a href="09-GLM.html#明確分析目的"><i class="fa fa-check"></i><b>51.1</b> 明確分析目的</a></li>
<li class="chapter" data-level="51.2" data-path="09-GLM.html"><a href="09-GLM.html#分析目的-1.1-估計-rct-中治療效果-treatment-effect"><i class="fa fa-check"></i><b>51.2</b> 分析目的 1.1 – 估計 RCT 中治療效果 (treatment effect)</a><ul>
<li class="chapter" data-level="51.2.1" data-path="09-GLM.html"><a href="09-GLM.html#rct-數據分析的一些不成熟的小建議"><i class="fa fa-check"></i><b>51.2.1</b> RCT 數據分析的一些不成熟的小建議</a></li>
</ul></li>
<li class="chapter" data-level="51.3" data-path="09-GLM.html"><a href="09-GLM.html#分析目的-1.2-估計流行病學研究中暴露變量和結果變量的關係-exposure-effect"><i class="fa fa-check"></i><b>51.3</b> 分析目的 1.2 – 估計流行病學研究中暴露變量和結果變量的關係 (exposure effect)</a><ul>
<li class="chapter" data-level="51.3.1" data-path="09-GLM.html"><a href="09-GLM.html#不成熟的小策略"><i class="fa fa-check"></i><b>51.3.1</b> 不成熟的小策略</a></li>
<li class="chapter" data-level="51.3.2" data-path="09-GLM.html"><a href="09-GLM.html#補充"><i class="fa fa-check"></i><b>51.3.2</b> 補充</a></li>
</ul></li>
<li class="chapter" data-level="51.4" data-path="09-GLM.html"><a href="09-GLM.html#分析目的-2-和-3-建立預測模型-predictive-models"><i class="fa fa-check"></i><b>51.4</b> 分析目的 2 和 3 – 建立預測模型 (predictive models)</a></li>
</ul></li>
<li class="chapter" data-level="52" data-path="09-GLM.html"><a href="09-GLM.html#檢查你的模型-model-checking---glm"><i class="fa fa-check"></i><b>52</b> 檢查你的模型 Model Checking - GLM</a><ul>
<li class="chapter" data-level="52.1" data-path="09-GLM.html"><a href="09-GLM.html#線性預測方程的定義"><i class="fa fa-check"></i><b>52.1</b> 線性預測方程的定義</a><ul>
<li class="chapter" data-level="52.1.1" data-path="09-GLM.html"><a href="09-GLM.html#殘差-1"><i class="fa fa-check"></i><b>52.1.1</b> 殘差</a></li>
<li class="chapter" data-level="52.1.2" data-path="09-GLM.html"><a href="09-GLM.html#glm-在-r-裏獲取殘差"><i class="fa fa-check"></i><b>52.1.2</b> GLM 在 R 裏獲取殘差</a></li>
<li class="chapter" data-level="52.1.3" data-path="09-GLM.html"><a href="09-GLM.html#如何利用獲得的殘差"><i class="fa fa-check"></i><b>52.1.3</b> 如何利用獲得的殘差</a></li>
</ul></li>
<li class="chapter" data-level="52.2" data-path="09-GLM.html"><a href="09-GLM.html#共變量模式殘差-covariate-pattern-residuals"><i class="fa fa-check"></i><b>52.2</b> 共變量模式殘差 covariate pattern residuals</a></li>
<li class="chapter" data-level="52.3" data-path="09-GLM.html"><a href="09-GLM.html#鏈接方程"><i class="fa fa-check"></i><b>52.3</b> 鏈接方程</a></li>
<li class="chapter" data-level="52.4" data-path="09-GLM.html"><a href="09-GLM.html#NHANESdrinker"><i class="fa fa-check"></i><b>52.4</b> NHANES 飲酒量數據實例</a></li>
<li class="chapter" data-level="52.5" data-path="09-GLM.html"><a href="09-GLM.html#practical-10"><i class="fa fa-check"></i><b>52.5</b> Practical 10</a></li>
</ul></li>
<li class="chapter" data-level="53" data-path="09-GLM.html"><a href="09-GLM.html#評價模型的表現-assessing-model-performance"><i class="fa fa-check"></i><b>53</b> 評價模型的表現 Assessing model performance</a><ul>
<li class="chapter" data-level="53.1" data-path="09-GLM.html"><a href="09-GLM.html#calibration"><i class="fa fa-check"></i><b>53.1</b> 精準度 calibration</a></li>
<li class="chapter" data-level="53.2" data-path="09-GLM.html"><a href="09-GLM.html#可解釋因變量的變異度及-r2-決定係數"><i class="fa fa-check"></i><b>53.2</b> 可解釋因變量的變異度及 <span class="math inline">\(R^2\)</span> 決定係數</a></li>
<li class="chapter" data-level="53.3" data-path="09-GLM.html"><a href="09-GLM.html#分辨能力-descrimination"><i class="fa fa-check"></i><b>53.3</b> 分辨能力 descrimination</a><ul>
<li class="chapter" data-level="53.3.1" data-path="09-GLM.html"><a href="09-GLM.html#敏感度和特異度"><i class="fa fa-check"></i><b>53.3.1</b> 敏感度和特異度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="54" data-path="09-GLM.html"><a href="09-GLM.html#配對實驗數據的分析法"><i class="fa fa-check"></i><b>54</b> 配對實驗數據的分析法</a><ul>
<li class="chapter" data-level="54.1" data-path="09-GLM.html"><a href="09-GLM.html#配對的原理"><i class="fa fa-check"></i><b>54.1</b> 配對的原理</a><ul>
<li class="chapter" data-level="54.1.1" data-path="09-GLM.html"><a href="09-GLM.html#爲了提升估計的精確度"><i class="fa fa-check"></i><b>54.1.1</b> 爲了提升估計的精確度</a></li>
<li class="chapter" data-level="54.1.2" data-path="09-GLM.html"><a href="09-GLM.html#控制混雜因素"><i class="fa fa-check"></i><b>54.1.2</b> 控制混雜因素</a></li>
</ul></li>
<li class="chapter" data-level="54.2" data-path="09-GLM.html"><a href="09-GLM.html#結果變量爲連續型變量的配對實驗"><i class="fa fa-check"></i><b>54.2</b> 結果變量爲連續型變量的配對實驗</a><ul>
<li class="chapter" data-level="54.2.1" data-path="09-GLM.html"><a href="09-GLM.html#一般檢驗方法"><i class="fa fa-check"></i><b>54.2.1</b> 一般檢驗方法</a></li>
<li class="chapter" data-level="54.2.2" data-path="09-GLM.html"><a href="09-GLM.html#用迴歸法分析"><i class="fa fa-check"></i><b>54.2.2</b> 用迴歸法分析</a></li>
</ul></li>
<li class="chapter" data-level="54.3" data-path="09-GLM.html"><a href="09-GLM.html#結果變量是二分類變量的配對實驗"><i class="fa fa-check"></i><b>54.3</b> 結果變量是二分類變量的配對實驗</a><ul>
<li class="chapter" data-level="54.3.1" data-path="09-GLM.html"><a href="09-GLM.html#第一步-對數據作表格"><i class="fa fa-check"></i><b>54.3.1</b> 第一步 對數據作表格</a></li>
<li class="chapter" data-level="54.3.2" data-path="09-GLM.html"><a href="09-GLM.html#mcnemars-test"><i class="fa fa-check"></i><b>54.3.2</b> McNemar’s test</a></li>
<li class="chapter" data-level="54.3.3" data-path="09-GLM.html"><a href="09-GLM.html#二分類型結果變量配對實驗的比值比"><i class="fa fa-check"></i><b>54.3.3</b> 二分類型結果變量配對實驗的比值比</a></li>
<li class="chapter" data-level="54.3.4" data-path="09-GLM.html"><a href="09-GLM.html#配對實驗比值比的信賴區間"><i class="fa fa-check"></i><b>54.3.4</b> 配對實驗比值比的信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="54.4" data-path="09-GLM.html"><a href="09-GLM.html#條件-conditional-比值比和邊際-marginal-比值比"><i class="fa fa-check"></i><b>54.4</b> 條件 (conditional) 比值比和邊際 (marginal) 比值比</a></li>
</ul></li>
<li class="chapter" data-level="55" data-path="09-GLM.html"><a href="09-GLM.html#條件邏輯迴歸-conditional-logistic-regression"><i class="fa fa-check"></i><b>55</b> 條件邏輯迴歸 Conditional logistic regression</a><ul>
<li class="chapter" data-level="55.1" data-path="09-GLM.html"><a href="09-GLM.html#配對實驗的邏輯迴歸模型"><i class="fa fa-check"></i><b>55.1</b> 配對實驗的邏輯迴歸模型</a><ul>
<li class="chapter" data-level="55.1.1" data-path="09-GLM.html"><a href="09-GLM.html#配對病例對照研究"><i class="fa fa-check"></i><b>55.1.1</b> 配對病例對照研究</a></li>
<li class="chapter" data-level="55.1.2" data-path="09-GLM.html"><a href="09-GLM.html#配對隊列研究"><i class="fa fa-check"></i><b>55.1.2</b> 配對隊列研究</a></li>
</ul></li>
<li class="chapter" data-level="55.2" data-path="09-GLM.html"><a href="09-GLM.html#條件邏輯回歸-二分類暴露變量"><i class="fa fa-check"></i><b>55.2</b> 條件邏輯回歸 – 二分類暴露變量</a><ul>
<li class="chapter" data-level="55.2.1" data-path="09-GLM.html"><a href="09-GLM.html#充分統計量-sufficient-statistics"><i class="fa fa-check"></i><b>55.2.1</b> 充分統計量 sufficient statistics</a></li>
<li class="chapter" data-level="55.2.2" data-path="09-GLM.html"><a href="09-GLM.html#條件邏輯回歸的推導"><i class="fa fa-check"></i><b>55.2.2</b> 條件邏輯回歸的推導</a></li>
<li class="chapter" data-level="55.2.3" data-path="09-GLM.html"><a href="09-GLM.html#條件似然-conditional-likelihood"><i class="fa fa-check"></i><b>55.2.3</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="55.2.4" data-path="09-GLM.html"><a href="09-GLM.html#進一步擴展"><i class="fa fa-check"></i><b>55.2.4</b> 進一步擴展</a></li>
</ul></li>
<li class="chapter" data-level="55.3" data-path="09-GLM.html"><a href="09-GLM.html#條件邏輯回歸模型的一般化"><i class="fa fa-check"></i><b>55.3</b> 條件邏輯回歸模型的一般化</a></li>
</ul></li>
<li class="chapter" data-level="56" data-path="09-GLM.html"><a href="09-GLM.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>56</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="57" data-path="09-GLM.html"><a href="09-GLM.html#ordinal-logistic-regression"><i class="fa fa-check"></i><b>57</b> Ordinal Logistic Regression</a></li>
<li class="part"><span><b>IX 等級線性迴歸模型 analysis of hierarchical and other dependent data</b></span></li>
<li class="chapter" data-level="58" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html"><i class="fa fa-check"></i><b>58</b> 相互依賴數據及簡單的應對方案</a><ul>
<li class="chapter" data-level="58.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#相互依賴的數據"><i class="fa fa-check"></i><b>58.1</b> 相互依賴的數據</a></li>
<li class="chapter" data-level="58.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#依賴性的來源在哪裏"><i class="fa fa-check"></i><b>58.2</b> 依賴性的來源在哪裏</a></li>
<li class="chapter" data-level="58.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#數據有依賴性導致的結果"><i class="fa fa-check"></i><b>58.3</b> 數據有依賴性導致的結果</a></li>
<li class="chapter" data-level="58.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#邊際模型和條件模型-marginal-and-conditional-models"><i class="fa fa-check"></i><b>58.4</b> 邊際模型和條件模型 marginal and conditional models</a><ul>
<li class="chapter" data-level="58.4.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#標記法-notation"><i class="fa fa-check"></i><b>58.4.1</b> 標記法 notation</a></li>
<li class="chapter" data-level="58.4.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#合並每個階層"><i class="fa fa-check"></i><b>58.4.2</b> 合並每個階層</a></li>
<li class="chapter" data-level="58.4.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#生物學悖論-ecological-fallacy"><i class="fa fa-check"></i><b>58.4.3</b> 生物學悖論 ecological fallacy</a></li>
<li class="chapter" data-level="58.4.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#分解層級數據"><i class="fa fa-check"></i><b>58.4.4</b> 分解層級數據</a></li>
<li class="chapter" data-level="58.4.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#固定效應模型-fixed-effect-model"><i class="fa fa-check"></i><b>58.4.5</b> 固定效應模型 fixed effect model</a></li>
</ul></li>
<li class="chapter" data-level="58.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#簡單線性迴歸複習"><i class="fa fa-check"></i><b>58.5</b> 簡單線性迴歸複習</a></li>
<li class="chapter" data-level="58.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#練習題-7"><i class="fa fa-check"></i><b>58.6</b> 練習題</a><ul>
<li class="chapter" data-level="58.6.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#數據"><i class="fa fa-check"></i><b>58.6.1</b> 數據</a></li>
<li class="chapter" data-level="58.6.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#問題"><i class="fa fa-check"></i><b>58.6.2</b> 問題</a></li>
<li class="chapter" data-level="58.6.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#將-high-school-and-beyond-數據導入-r-中熟悉數據結構及內容特別要注意觀察每個學校的學生特徵"><i class="fa fa-check"></i><b>58.6.3</b> 將 High-School-and-Beyond 數據導入 R 中，熟悉數據結構及內容，特別要注意觀察每個學校的學生特徵。</a></li>
<li class="chapter" data-level="58.6.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#爲了簡便起見接下來的分析只節選數據中前五所學校-188-名學生的數學成績和-ses分別計算每所學校的數學成績及-ses-的平均值"><i class="fa fa-check"></i><b>58.6.4</b> 爲了簡便起見，接下來的分析只節選數據中前五所學校 188 名學生的數學成績，和 SES。分別計算每所學校的數學成績,及 SES 的平均值。</a></li>
<li class="chapter" data-level="58.6.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#先無視掉學校這一分層變量把所有學生看作是相互獨立的擬合總體的-ses-和數學成績的線性迴歸-total-regression-model把該總體模型的預測值提取並存儲在數據庫中"><i class="fa fa-check"></i><b>58.6.5</b> 先無視掉學校這一分層變量，把所有學生看作是相互獨立的，擬合總體的 SES 和數學成績的線性迴歸 <strong>(Total regression model)</strong>。把該總體模型的預測值提取並存儲在數據庫中。</a></li>
<li class="chapter" data-level="58.6.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#用各個學校-ses-和數學成績的均值擬合一個學校間的線性迴歸模型-between-regression-model"><i class="fa fa-check"></i><b>58.6.6</b> 用各個學校 SES 和數學成績的均值擬合一個學校間的線性迴歸模型 <strong>(between regression model)</strong>。</a></li>
<li class="chapter" data-level="58.6.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#分別對每個學校內的學生進行-ses-和數學成績擬合線性迴歸模型"><i class="fa fa-check"></i><b>58.6.7</b> 分別對每個學校內的學生進行 SES 和數學成績擬合線性迴歸模型。</a></li>
<li class="chapter" data-level="58.6.8" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#比較三種模型計算的數學成績的擬合值他們一致還是有所不同爲什麼會有不同"><i class="fa fa-check"></i><b>58.6.8</b> 比較三種模型計算的數學成績的擬合值，他們一致？還是有所不同？爲什麼會有不同？</a></li>
<li class="chapter" data-level="58.6.9" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#把三種模型的數學成績擬合值散點圖繪製在同一張圖內"><i class="fa fa-check"></i><b>58.6.9</b> 把三種模型的數學成績擬合值散點圖繪製在同一張圖內。</a></li>
<li class="chapter" data-level="58.6.10" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#用這-5-個學校的數據擬合一個固定效應線性迴歸模型"><i class="fa fa-check"></i><b>58.6.10</b> 用這 5 個學校的數據擬合一個固定效應線性迴歸模型</a></li>
<li class="chapter" data-level="58.6.11" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#讀入-pefr-數據"><i class="fa fa-check"></i><b>58.6.11</b> 讀入 PEFR 數據。</a></li>
<li class="chapter" data-level="58.6.12" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#求每個患者的-wp-兩次測量平均值"><i class="fa fa-check"></i><b>58.6.12</b> 求每個患者的 <code>wp</code> 兩次測量平均值</a></li>
<li class="chapter" data-level="58.6.13" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#在-r-裏先用-anova-分析個人的-wp-變異再用-lme4lmer-擬合用-id-作隨機效應的混合效應模型確認後者報告的-std.dev-for-id-effect-其實可以用-anova-結果的-sqrtfractextmms-msen-n-是每個個體重複測量值的個數"><i class="fa fa-check"></i><b>58.6.13</b> 在 R 裏先用 ANOVA 分析個人的 <code>wp</code> 變異。再用 <code>lme4::lmer</code> 擬合用 <code>id</code> 作隨機效應的混合效應模型。確認後者報告的 <code>Std.Dev for id effect</code> 其實可以用 ANOVA 結果的 <span class="math inline">\(\sqrt{\frac{\text{MMS-MSE}}{n}}\)</span> (n 是每個個體重複測量值的個數)。</a></li>
<li class="chapter" data-level="58.6.14" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#擬合結果變量爲-wp解釋變量爲-id-的簡單線性迴歸模型用數學表達式描述這個模型"><i class="fa fa-check"></i><b>58.6.14</b> 擬合結果變量爲 <code>wp</code>，解釋變量爲 <code>id</code> 的簡單線性迴歸模型。用數學表達式描述這個模型。</a></li>
<li class="chapter" data-level="58.6.15" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#將-wp-中心化之後重新擬合相同的模型把截距去除掉寫下這個模型的數學表達式"><i class="fa fa-check"></i><b>58.6.15</b> 將 <code>wp</code> 中心化之後，重新擬合相同的模型，把截距去除掉。寫下這個模型的數學表達式。</a></li>
<li class="chapter" data-level="58.6.16" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#計算這些迴歸係數-其實是不同羣之間的隨機截距-的均值和標準差"><i class="fa fa-check"></i><b>58.6.16</b> 計算這些迴歸係數 (其實是不同羣之間的隨機截距) 的均值和標準差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="59" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機截距模型-random-intercept-model"><i class="fa fa-check"></i><b>59</b> 隨機截距模型 random intercept model</a><ul>
<li class="chapter" data-level="59.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機截距模型的定義"><i class="fa fa-check"></i><b>59.1</b> 隨機截距模型的定義</a></li>
<li class="chapter" data-level="59.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機截距模型的參數估計"><i class="fa fa-check"></i><b>59.2</b> 隨機截距模型的參數估計</a></li>
<li class="chapter" data-level="59.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#如何在-r-中進行隨機截距模型的擬合"><i class="fa fa-check"></i><b>59.3</b> 如何在 R 中進行隨機截距模型的擬合</a></li>
<li class="chapter" data-level="59.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機截距模型中的統計推斷"><i class="fa fa-check"></i><b>59.4</b> 隨機截距模型中的統計推斷</a><ul>
<li class="chapter" data-level="59.4.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#fixed-inference"><i class="fa fa-check"></i><b>59.4.1</b> 固定效應部分的推斷</a></li>
<li class="chapter" data-level="59.4.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機效應部分的推斷"><i class="fa fa-check"></i><b>59.4.2</b> 隨機效應部分的推斷</a></li>
</ul></li>
<li class="chapter" data-level="59.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#練習題-8"><i class="fa fa-check"></i><b>59.5</b> 練習題</a><ul>
<li class="chapter" data-level="59.5.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#數據-1"><i class="fa fa-check"></i><b>59.5.1</b> 數據</a></li>
<li class="chapter" data-level="59.5.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#讀入-ghq-數據探索其內容該數據是否是平衡數據-balanced計算每名學生的兩次問卷成績平均分"><i class="fa fa-check"></i><b>59.5.2</b> 讀入 GHQ 數據，探索其內容，該數據是否是平衡數據 (balanced)？計算每名學生的兩次問卷成績平均分。</a></li>
<li class="chapter" data-level="59.5.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#把數據從寬-wide-改變成長-long-的形式"><i class="fa fa-check"></i><b>59.5.3</b> 把數據從寬 (wide) 改變成長 (long) 的形式</a></li>
<li class="chapter" data-level="59.5.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#對數據按照-id-分層進行-anova"><i class="fa fa-check"></i><b>59.5.4</b> 對數據按照 <code>id</code> 分層進行 ANOVA</a></li>
<li class="chapter" data-level="59.5.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#用-r-裏的-nlme-包使用限制性極大似然法-restricted-maximum-likelihood-reml-擬合截距混合效應模型比較其結果和前文中隨機效應-anova-的結果"><i class="fa fa-check"></i><b>59.5.5</b> 用 R 裏的 <code>nlme</code> 包，使用限制性極大似然法 (restricted maximum likelihood, REML) 擬合截距混合效應模型，比較其結果和前文中隨機效應 ANOVA 的結果</a></li>
<li class="chapter" data-level="59.5.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#用極大似然法-maximum-likelihood-ml-method-ml-重新擬合前面的混合效應模型比較結果有什麼不同"><i class="fa fa-check"></i><b>59.5.6</b> 用極大似然法 (maximum likelihood, ML) <code>method = "ML"</code> 重新擬合前面的混合效應模型，比較結果有什麼不同。</a></li>
<li class="chapter" data-level="59.5.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#用簡單線性迴歸擬合一個固定效應模型"><i class="fa fa-check"></i><b>59.5.7</b> 用簡單線性迴歸擬合一個固定效應模型</a></li>
<li class="chapter" data-level="59.5.8" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#計算這些隨機截距的均值和標準差"><i class="fa fa-check"></i><b>59.5.8</b> 計算這些隨機截距的均值和標準差</a></li>
<li class="chapter" data-level="59.5.9" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#忽略掉所有的分層和解釋變量擬合-ghq-的簡單線性迴歸"><i class="fa fa-check"></i><b>59.5.9</b> 忽略掉所有的分層和解釋變量擬合 <code>GHQ</code> 的簡單線性迴歸</a></li>
<li class="chapter" data-level="59.5.10" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#用分層的穩健法-三明治標準誤法-計算簡單線性迴歸時截距的標準誤差和簡單線性迴歸時的結果作比較"><i class="fa fa-check"></i><b>59.5.10</b> 用分層的穩健法 (三明治標準誤法) 計算簡單線性迴歸時，截距的標準誤差，和簡單線性迴歸時的結果作比較</a></li>
<li class="chapter" data-level="59.5.11" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#讀入-siblings-數據先總結嬰兒的出生體重思考這個數據中嬰兒出生體重之間是否可能存在關聯性它的來源是哪裏用這個數據擬合兩個混合效應模型-ml-reml不加入任何解釋變量"><i class="fa fa-check"></i><b>59.5.11</b> 讀入 <code>siblings</code> 數據。先總結嬰兒的出生體重，思考這個數據中嬰兒出生體重之間是否可能存在關聯性？它的來源是哪裏。用這個數據擬合兩個混合效應模型 (ML, REML)，不加入任何解釋變量。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="60" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機截距模型中加入共變量-random-intercept-model-with-covariates"><i class="fa fa-check"></i><b>60</b> 隨機截距模型中加入共變量 random intercept model with covariates</a><ul>
<li class="chapter" data-level="60.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#多元線性回歸模型的延伸"><i class="fa fa-check"></i><b>60.1</b> 多元線性回歸模型的延伸</a></li>
<li class="chapter" data-level="60.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#siblings-數據中新生兒體重的實例"><i class="fa fa-check"></i><b>60.2</b> <code>siblings</code> 數據中新生兒體重的實例</a></li>
<li class="chapter" data-level="60.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#賦值予隨機效應成分"><i class="fa fa-check"></i><b>60.3</b> 賦值予隨機效應成分</a><ul>
<li class="chapter" data-level="60.3.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#簡單預測-simple-prediction"><i class="fa fa-check"></i><b>60.3.1</b> 簡單預測 simple prediction</a></li>
<li class="chapter" data-level="60.3.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#eb-預測值"><i class="fa fa-check"></i><b>60.3.2</b> EB 預測值</a></li>
</ul></li>
<li class="chapter" data-level="60.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#混合效應模型的診斷"><i class="fa fa-check"></i><b>60.4</b> 混合效應模型的診斷</a></li>
<li class="chapter" data-level="60.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#第二層級-cluster-levellevel-2-的協方差"><i class="fa fa-check"></i><b>60.5</b> 第二層級 (cluster level/level 2) 的協方差</a></li>
<li class="chapter" data-level="60.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#層內層間效應估計"><i class="fa fa-check"></i><b>60.6</b> 層內層間效應估計</a></li>
<li class="chapter" data-level="60.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#到底選擇固定還是混合模型"><i class="fa fa-check"></i><b>60.7</b> 到底選擇固定還是混合模型？</a></li>
<li class="chapter" data-level="60.8" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#練習題目"><i class="fa fa-check"></i><b>60.8</b> 練習題目</a><ul>
<li class="chapter" data-level="60.8.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#把-high-school-and-beyond-數據讀入-r-中"><i class="fa fa-check"></i><b>60.8.1</b> 把 High-school-and-Beyond 數據讀入 R 中。</a></li>
<li class="chapter" data-level="60.8.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#擬合兩個隨機截距模型-ml-reml結果變量用-mathach解釋變量用-ses觀察結果是否不同"><i class="fa fa-check"></i><b>60.8.2</b> 擬合兩個隨機截距模型 (ML, REML)，結果變量用 <code>mathach</code>，解釋變量用 <code>ses</code>。觀察結果是否不同。</a></li>
<li class="chapter" data-level="60.8.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#觀察學校類型是否爲天主教學校-sector-的分佈把它加入剛擬合的兩個隨機截距模型它們估計的隨機效應標準差-hatsigma_u和隨機誤差標準差-hatsigma_e和之前有什麼不同-mlreml-的選用對結果有影響嗎"><i class="fa fa-check"></i><b>60.8.3</b> 觀察學校類型是否爲天主教學校 <code>sector</code> 的分佈，把它加入剛擬合的兩個隨機截距模型，它們估計的隨機效應標準差 <span class="math inline">\(\hat\sigma_u\)</span>，和隨機誤差標準差 <span class="math inline">\(\hat\sigma_e\)</span>，和之前有什麼不同？ “ML，REML” 的選用對結果有影響嗎？</a></li>
<li class="chapter" data-level="60.8.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#現在把學校規模-size-這一變量加入混合效應模型的固定效應部分記得先把該變量中心化並除以-100會有助於對結果的解釋-比平均值每增加100名學生仔細觀察模型結果中隨機效應標準差和隨機誤差標準殘差的變化"><i class="fa fa-check"></i><b>60.8.4</b> 現在把學校規模 <code>size</code> 這一變量加入混合效應模型的固定效應部分，記得先把該變量中心化，並除以 100，會有助於對結果的解釋 (比平均值每增加100名學生)。仔細觀察模型結果中隨機效應標準差和隨機誤差標準殘差的變化。</a></li>
<li class="chapter" data-level="60.8.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#在模型的固定效應部分增加-sizesector-的交互作用項觀察輸出結果中該交互作用項是否有意義用什麼檢驗方法判斷這個交互作用項能否幫助模型更加擬合數據"><i class="fa fa-check"></i><b>60.8.5</b> 在模型的固定效應部分增加 <code>size*sector</code> 的交互作用項。觀察輸出結果中該交互作用項是否有意義。用什麼檢驗方法判斷這個交互作用項能否幫助模型更加擬合數據？</a></li>
<li class="chapter" data-level="60.8.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#把上面八個模型估計的隨機效應標準差和隨機誤差標準差總結成表格它們之間有什麼規律嗎"><i class="fa fa-check"></i><b>60.8.6</b> 把上面八個模型估計的隨機效應標準差，和隨機誤差標準差總結成表格，它們之間有什麼規律嗎？</a></li>
<li class="chapter" data-level="60.8.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#在混合效應模型的固定效應部分增加學生性別-female和學生是否是少數族裔-minority-兩個變量再觀察-hatsigma_u-hatsigma_e-是否發生變化"><i class="fa fa-check"></i><b>60.8.7</b> 在混合效應模型的固定效應部分增加學生性別 <code>female</code>，和學生是否是少數族裔 <code>minority</code> 兩個變量。再觀察 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span> 是否發生變化？</a></li>
<li class="chapter" data-level="60.8.8" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#檢查學生性別和族裔是否和學校是否是天主教會學校有關係先作分類型數據的分佈表格然後把它們各自與-sector-的交互作用項加入混合效應模型中的固定效應部分記錄下此時的-hatsigma_u-hatsigma_e"><i class="fa fa-check"></i><b>60.8.8</b> 檢查學生性別和族裔是否和學校是否是天主教會學校有關係，先作分類型數據的分佈表格，然後把它們各自與 <code>sector</code> 的交互作用項加入混合效應模型中的固定效應部分，記錄下此時的 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span></a></li>
<li class="chapter" data-level="60.8.9" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#對上面最後一個模型進行殘差分析和模型的診斷"><i class="fa fa-check"></i><b>60.8.9</b> 對上面最後一個模型進行殘差分析和模型的診斷。</a></li>
<li class="chapter" data-level="60.8.10" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#通過剛剛所求的隨機效應方差的殘差確認哪個學校存在相對極端的值"><i class="fa fa-check"></i><b>60.8.10</b> 通過剛剛所求的隨機效應方差的殘差，確認哪個學校存在相對極端的值。</a></li>
<li class="chapter" data-level="60.8.11" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#計算學校水平的-ses-平均值以及每個學生自己和所在學校均值之間的差值大小分別擬合兩個不同的混合效應模型一個只用-ses另一個換做使用新計算的組均值和組內均差"><i class="fa fa-check"></i><b>60.8.11</b> 計算學校水平的 SES 平均值，以及每個學生自己和所在學校均值之間的差值大小。分別擬合兩個不同的混合效應模型，一個只用 <code>SES</code>，另一個換做使用新計算的組均值和組內均差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="61" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機回歸系數模型-random-coefficient-model"><i class="fa fa-check"></i><b>61</b> 隨機回歸系數模型 random coefficient model</a><ul>
<li class="chapter" data-level="61.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#gcse-scores-實例"><i class="fa fa-check"></i><b>61.1</b> GCSE scores 實例</a></li>
<li class="chapter" data-level="61.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機回歸系數的實質"><i class="fa fa-check"></i><b>61.2</b> 隨機回歸系數的實質</a></li>
<li class="chapter" data-level="61.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#繼續-gcse-scores-實例"><i class="fa fa-check"></i><b>61.3</b> 繼續 GCSE scores 實例</a></li>
<li class="chapter" data-level="61.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#使用模型結果推斷"><i class="fa fa-check"></i><b>61.4</b> 使用模型結果推斷</a></li>
<li class="chapter" data-level="61.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#random-var"><i class="fa fa-check"></i><b>61.5</b> 隨機效應的方差</a></li>
<li class="chapter" data-level="61.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#模型效果評估"><i class="fa fa-check"></i><b>61.6</b> 模型效果評估</a></li>
<li class="chapter" data-level="61.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#練習題-9"><i class="fa fa-check"></i><b>61.7</b> 練習題</a><ul>
<li class="chapter" data-level="61.7.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#先忽略學校編號爲-48-的學校擬合一個只有固定效應-簡單線性回歸模型結果變量是-gcse解釋變量是-lrt-和學校"><i class="fa fa-check"></i><b>61.7.1</b> 先忽略學校編號爲 48 的學校，擬合一個只有固定效應 (簡單線性回歸模型)，結果變量是 GCSE，解釋變量是 LRT 和學校。</a></li>
<li class="chapter" data-level="61.7.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#僅有固定效應模型的學校變量變更爲學校類型-男校女校或混合校從這個新模型的結果來看你是否認爲學校類型和學校編號本身相比能夠解釋相同的學校層面的方差-lrt-的估計回歸參數發生了怎樣的變化"><i class="fa fa-check"></i><b>61.7.2</b> 僅有固定效應模型的學校變量變更爲學校類型 (男校女校或混合校)，從這個新模型的結果來看，你是否認爲學校類型，和學校編號本身相比能夠解釋相同的學校層面的方差？ <code>lrt</code> 的估計回歸參數發生了怎樣的變化？</a></li>
<li class="chapter" data-level="61.7.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#使用限制性極大似然法擬合一個隨機截距模型記錄此時的限制性對數似然的大小-log-likelihood用-lmertestrand-命令對隨機效應部分的方差是否爲零做檢驗指明該檢驗的零假設是什麼並解釋其結果的含義"><i class="fa fa-check"></i><b>61.7.3</b> 使用限制性極大似然法擬合一個隨機截距模型。記錄此時的限制性對數似然的大小 (log-likelihood)。用 <code>lmerTest::rand</code> 命令對隨機效應部分的方差是否爲零做檢驗，指明該檢驗的零假設是什麼，並解釋其結果的含義。</a></li>
<li class="chapter" data-level="61.7.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#在前一題的隨機截距模型中加入-schgend-變量作爲解釋隨機截距的一個自變量觀察輸出結果解釋其是否有意義記錄這個模型的限制性似然"><i class="fa fa-check"></i><b>61.7.4</b> 在前一題的隨機截距模型中加入 <code>schgend</code> 變量，作爲解釋隨機截距的一個自變量，觀察輸出結果，解釋其是否有意義。記錄這個模型的限制性似然。</a></li>
<li class="chapter" data-level="61.7.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#擬合隨機截距隨機斜率模型固定效應部分的-lrt-也加入進隨機效應部分"><i class="fa fa-check"></i><b>61.7.5</b> 擬合隨機截距隨機斜率模型，固定效應部分的 <code>lrt</code> 也加入進隨機效應部分。</a></li>
<li class="chapter" data-level="61.7.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#通過上面幾個模型計算獲得的似然嘗試檢驗隨機斜率標準差以及該標準差和隨機截距標準差的協相關是否有意義"><i class="fa fa-check"></i><b>61.7.6</b> 通過上面幾個模型計算獲得的似然，嘗試檢驗隨機斜率標準差，以及該標準差和隨機截距標準差的協相關是否有意義。</a></li>
<li class="chapter" data-level="61.7.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#模型中的-schgend-改成-mean_girl-會給出怎樣的結果呢"><i class="fa fa-check"></i><b>61.7.7</b> 模型中的 <code>schgend</code> 改成 <code>mean_girl</code> 會給出怎樣的結果呢？</a></li>
<li class="chapter" data-level="61.7.8" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#現在我們把注意力改爲關心學校編號爲-48-的學校的情況用且禁用它一所學校的數據擬合一個簡單線性回歸結果變量是-gcse解釋變量是-lrt"><i class="fa fa-check"></i><b>61.7.8</b> 現在我們把注意力改爲關心學校編號爲 48 的學校的情況。用且禁用它一所學校的數據，擬合一個簡單線性回歸，結果變量是 <code>gcse</code>，解釋變量是 <code>lrt</code>。</a></li>
<li class="chapter" data-level="61.7.9" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#這次不排除-48-號學校擬合所有學校的數據進入-fixed_reml2-模型中去結果有發生顯著的變化嗎"><i class="fa fa-check"></i><b>61.7.9</b> 這次不排除 48 號學校，擬合所有學校的數據進入 <code>Fixed_reml2</code> 模型中去，結果有發生顯著的變化嗎？</a></li>
<li class="chapter" data-level="61.7.10" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#計算這個模型的第二階級level-2-school-level的殘差"><i class="fa fa-check"></i><b>61.7.10</b> 計算這個模型的第二階級(level 2, <code>school</code> level)的殘差。</a></li>
<li class="chapter" data-level="61.7.11" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#計算這個模型的第一階級level-1-student殘差分析其分布查看第48所學校的殘差表現如何"><i class="fa fa-check"></i><b>61.7.11</b> 計算這個模型的第一階級(level 1, student)殘差，分析其分布，查看第48所學校的殘差表現如何。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="62" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#縱向研究數據-longitudinal-data-1"><i class="fa fa-check"></i><b>62</b> 縱向研究數據 longitudinal data 1</a><ul>
<li class="chapter" data-level="62.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#固定測量時刻-fixed-occasions"><i class="fa fa-check"></i><b>62.1</b> 固定測量時刻 fixed occasions</a><ul>
<li class="chapter" data-level="62.1.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#缺失值-missing-data"><i class="fa fa-check"></i><b>62.1.1</b> 缺失值 Missing data</a></li>
</ul></li>
<li class="chapter" data-level="62.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#不固定測量時刻-variable-occasions"><i class="fa fa-check"></i><b>62.2</b> 不固定測量時刻 variable occasions</a></li>
<li class="chapter" data-level="62.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#預測軌跡-predicting-trajectories"><i class="fa fa-check"></i><b>62.3</b> 預測軌跡 predicting trajectories</a></li>
<li class="chapter" data-level="62.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#practical-05-hier"><i class="fa fa-check"></i><b>62.4</b> Practical 05-Hier</a></li>
</ul></li>
<li class="chapter" data-level="63" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#縱向研究數據-longitudinal-data-2"><i class="fa fa-check"></i><b>63</b> 縱向研究數據 longitudinal data 2</a><ul>
<li class="chapter" data-level="63.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#邊際結構-marginal-structures"><i class="fa fa-check"></i><b>63.1</b> 邊際結構 marginal structures</a><ul>
<li class="chapter" data-level="63.1.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機截距模型"><i class="fa fa-check"></i><b>63.1.1</b> 隨機截距模型</a></li>
<li class="chapter" data-level="63.1.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#隨機系數模型"><i class="fa fa-check"></i><b>63.1.2</b> 隨機系數模型</a></li>
</ul></li>
<li class="chapter" data-level="63.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#矩陣記法"><i class="fa fa-check"></i><b>63.2</b> 矩陣記法</a></li>
<li class="chapter" data-level="63.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#混合效應模型的一般化公式"><i class="fa fa-check"></i><b>63.3</b> 混合效應模型的一般化公式</a></li>
<li class="chapter" data-level="63.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#其他可選擇的方差協方差矩陣特徵"><i class="fa fa-check"></i><b>63.4</b> 其他可選擇的方差協方差矩陣特徵</a></li>
<li class="chapter" data-level="63.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#其他要點評論"><i class="fa fa-check"></i><b>63.5</b> 其他要點評論</a></li>
<li class="chapter" data-level="63.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#不平衡數據"><i class="fa fa-check"></i><b>63.6</b> 不平衡數據</a></li>
<li class="chapter" data-level="63.7" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#practical-06-hier"><i class="fa fa-check"></i><b>63.7</b> Practical 06-Hier</a></li>
</ul></li>
<li class="chapter" data-level="64" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#縱向研究數據-longitudinal-data-3"><i class="fa fa-check"></i><b>64</b> 縱向研究數據 longitudinal data 3</a><ul>
<li class="chapter" data-level="64.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#第一層級的異質性-level-1-heterogeneity"><i class="fa fa-check"></i><b>64.1</b> 第一層級的異質性 level 1 heterogeneity</a></li>
<li class="chapter" data-level="64.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#第二層級異質性-level-2-heterogeneity"><i class="fa fa-check"></i><b>64.2</b> 第二層級異質性 level 2 heterogeneity</a></li>
<li class="chapter" data-level="64.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#分析策略-1"><i class="fa fa-check"></i><b>64.3</b> 分析策略</a><ul>
<li class="chapter" data-level="64.3.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#模型選擇和建模步驟"><i class="fa fa-check"></i><b>64.3.1</b> 模型選擇和建模步驟</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="65" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#generalized-estimating-equation"><i class="fa fa-check"></i><b>65</b> Generalized Estimating Equation</a></li>
<li class="chapter" data-level="66" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#cluster-analysisunsupervised-learning-聚類分析"><i class="fa fa-check"></i><b>66</b> Cluster analysis/unsupervised learning 聚類分析</a><ul>
<li class="chapter" data-level="66.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#聚類分析過程"><i class="fa fa-check"></i><b>66.1</b> 聚類分析過程</a><ul>
<li class="chapter" data-level="66.1.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#連續型變量-continuous-variables-in-cluster-analysis"><i class="fa fa-check"></i><b>66.1.1</b> 連續型變量 continuous variables in cluster analysis</a></li>
<li class="chapter" data-level="66.1.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#二分類或者分類型變量之間的距離-distances-for-binarycategorical-variables"><i class="fa fa-check"></i><b>66.1.2</b> 二分類或者分類型變量之間的距離 distances for binary/categorical variables</a></li>
<li class="chapter" data-level="66.1.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#定義分類方法"><i class="fa fa-check"></i><b>66.1.3</b> 定義分類方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="67" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#missing-data-1"><i class="fa fa-check"></i><b>67</b> Missing data 1</a></li>
<li class="chapter" data-level="68" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#principal-component-analysis-主成分分析"><i class="fa fa-check"></i><b>68</b> Principal Component Analysis 主成分分析</a><ul>
<li class="chapter" data-level="68.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#數據有相關性時產生的問題"><i class="fa fa-check"></i><b>68.1</b> 數據有相關性時產生的問題</a></li>
<li class="chapter" data-level="68.2" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#最大化方差等價於最大化數據點到新座標軸投影projection的長度"><i class="fa fa-check"></i><b>68.2</b> 最大化方差等價於最大化數據點到新座標軸<strong>“投影(projection)”</strong>的長度</a></li>
<li class="chapter" data-level="68.3" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#數學推導"><i class="fa fa-check"></i><b>68.3</b> 數學推導</a><ul>
<li class="chapter" data-level="68.3.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#超越對稱矩陣奇異值分解-singular-value-decomposition-svd"><i class="fa fa-check"></i><b>68.3.1</b> 超越對稱矩陣：奇異值分解 (singular value decomposition, SVD)</a></li>
</ul></li>
<li class="chapter" data-level="68.4" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#主成分分析數據實例"><i class="fa fa-check"></i><b>68.4</b> 主成分分析數據實例</a></li>
<li class="chapter" data-level="68.5" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#在pca圖形中加入補充變量和補充個體-supplementary-elements"><i class="fa fa-check"></i><b>68.5</b> 在PCA圖形中加入補充變量和補充個體 (supplementary elements)</a><ul>
<li class="chapter" data-level="68.5.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#展示分類輔助性變量和個體的關係"><i class="fa fa-check"></i><b>68.5.1</b> 展示分類輔助性變量和個體的關係</a></li>
</ul></li>
<li class="chapter" data-level="68.6" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#cluster-analysispca-practical"><i class="fa fa-check"></i><b>68.6</b> Cluster analysis/PCA practical</a><ul>
<li class="chapter" data-level="68.6.1" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#使用的數據和簡單背景知識"><i class="fa fa-check"></i><b>68.6.1</b> 使用的數據和簡單背景知識</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="69" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#missing-data-2"><i class="fa fa-check"></i><b>69</b> Missing data 2</a></li>
<li class="chapter" data-level="70" data-path="10-Hierarchical-models.html"><a href="10-Hierarchical-models.html#further-issues"><i class="fa fa-check"></i><b>70</b> Further issues</a></li>
<li class="part"><span><b>X 生存分析 Survival Analysis</b></span></li>
<li class="chapter" data-level="71" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html"><i class="fa fa-check"></i><b>71</b> 生存分析入門</a><ul>
<li class="chapter" data-level="71.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#什麼是生存分析"><i class="fa fa-check"></i><b>71.1</b> 什麼是生存分析</a></li>
<li class="chapter" data-level="71.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存數據在哪裏"><i class="fa fa-check"></i><b>71.2</b> 生存數據在哪裏</a></li>
<li class="chapter" data-level="71.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存數據分析之前要理清楚的問題"><i class="fa fa-check"></i><b>71.3</b> 生存數據分析之前要理清楚的問題</a></li>
<li class="chapter" data-level="71.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存數據的左右截尾"><i class="fa fa-check"></i><b>71.4</b> 生存數據的左右截尾</a><ul>
<li class="chapter" data-level="71.4.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#左側截尾數據-left-truncation"><i class="fa fa-check"></i><b>71.4.1</b> 左側截尾數據 left-truncation</a></li>
</ul></li>
<li class="chapter" data-level="71.5" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#初步分析生存數據"><i class="fa fa-check"></i><b>71.5</b> 初步分析生存數據</a></li>
<li class="chapter" data-level="71.6" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#初步描述生存數據"><i class="fa fa-check"></i><b>71.6</b> 初步描述生存數據</a><ul>
<li class="chapter" data-level="71.6.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存方程"><i class="fa fa-check"></i><b>71.6.1</b> 生存方程</a></li>
<li class="chapter" data-level="71.6.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#風險度方程"><i class="fa fa-check"></i><b>71.6.2</b> 風險度方程</a></li>
<li class="chapter" data-level="71.6.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#概率密度方程"><i class="fa fa-check"></i><b>71.6.3</b> 概率密度方程</a></li>
<li class="chapter" data-level="71.6.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#各方程之間的關系"><i class="fa fa-check"></i><b>71.6.4</b> 各方程之間的關系</a></li>
</ul></li>
<li class="chapter" data-level="71.7" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存時間的參數分布"><i class="fa fa-check"></i><b>71.7</b> 生存時間的參數分布</a><ul>
<li class="chapter" data-level="71.7.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#指數分布"><i class="fa fa-check"></i><b>71.7.1</b> 指數分布</a></li>
<li class="chapter" data-level="71.7.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#weibull-分布"><i class="fa fa-check"></i><b>71.7.2</b> Weibull 分布</a></li>
</ul></li>
<li class="chapter" data-level="71.8" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#極大似然法估計"><i class="fa fa-check"></i><b>71.8</b> 極大似然法估計</a></li>
<li class="chapter" data-level="71.9" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#practical-survival-01"><i class="fa fa-check"></i><b>71.9</b> Practical Survival 01</a><ul>
<li class="chapter" data-level="71.9.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存分析的時間尺度"><i class="fa fa-check"></i><b>71.9.1</b> 生存分析的時間尺度</a></li>
<li class="chapter" data-level="71.9.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#擬合最簡單的指數分布生存數據"><i class="fa fa-check"></i><b>71.9.2</b> 擬合最簡單的指數分布生存數據</a></li>
<li class="chapter" data-level="71.9.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#探索服從-weibull-分布時風險度方程的曲線"><i class="fa fa-check"></i><b>71.9.3</b> 探索服從 Weibull 分布時風險度方程的曲線</a></li>
<li class="chapter" data-level="71.9.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#探索-對數邏輯-log-logistic-分布時風險度方程曲線會有哪些特性"><i class="fa fa-check"></i><b>71.9.4</b> 探索 對數邏輯 (log-logistic) 分布時，風險度方程曲線會有哪些特性？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="72" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#nonparametric"><i class="fa fa-check"></i><b>72</b> 非參數法分析生存數據</a><ul>
<li class="chapter" data-level="72.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存分析中的非參數分析法"><i class="fa fa-check"></i><b>72.1</b> 生存分析中的非參數分析法</a></li>
<li class="chapter" data-level="72.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#kaplan-meier-法分析生存方程"><i class="fa fa-check"></i><b>72.2</b> Kaplan-Meier 法分析生存方程</a><ul>
<li class="chapter" data-level="72.2.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#當數據中沒有刪失值"><i class="fa fa-check"></i><b>72.2.1</b> 當數據中沒有刪失值</a></li>
<li class="chapter" data-level="72.2.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#當數據中有刪失值"><i class="fa fa-check"></i><b>72.2.2</b> 當數據中有刪失值</a></li>
</ul></li>
<li class="chapter" data-level="72.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#kaplan-meier-數據的不確定性"><i class="fa fa-check"></i><b>72.3</b> Kaplan-Meier 數據的不確定性</a></li>
<li class="chapter" data-level="72.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#另一種非參數法分析-生命表格估計"><i class="fa fa-check"></i><b>72.4</b> 另一種非參數法分析 – 生命表格估計</a></li>
<li class="chapter" data-level="72.5" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#兩組之間生存概率的比較"><i class="fa fa-check"></i><b>72.5</b> 兩組之間生存概率的比較</a><ul>
<li class="chapter" data-level="72.5.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#the-log-rank-test"><i class="fa fa-check"></i><b>72.5.1</b> The log rank test</a></li>
</ul></li>
<li class="chapter" data-level="72.6" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#計算累積風險度-cumulative-hazard"><i class="fa fa-check"></i><b>72.6</b> 計算累積風險度 cumulative hazard</a></li>
<li class="chapter" data-level="72.7" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#practical-02---survival-analysis"><i class="fa fa-check"></i><b>72.7</b> Practical 02 - survival analysis</a></li>
</ul></li>
<li class="chapter" data-level="73" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存數據中的回歸模型"><i class="fa fa-check"></i><b>73</b> 生存數據中的回歸模型</a><ul>
<li class="chapter" data-level="73.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存數據的似然方程"><i class="fa fa-check"></i><b>73.1</b> 生存數據的似然方程</a></li>
<li class="chapter" data-level="73.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#如何加入解釋變量"><i class="fa fa-check"></i><b>73.2</b> 如何加入解釋變量</a></li>
<li class="chapter" data-level="73.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#指數模型-exponential-model"><i class="fa fa-check"></i><b>73.3</b> 指數模型 exponential model</a></li>
<li class="chapter" data-level="73.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#weibull-分布-1"><i class="fa fa-check"></i><b>73.4</b> Weibull 分布</a></li>
<li class="chapter" data-level="73.5" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#weibull-和-指數模型的比較"><i class="fa fa-check"></i><b>73.5</b> Weibull 和 指數模型的比較</a><ul>
<li class="chapter" data-level="73.5.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#繪圖法"><i class="fa fa-check"></i><b>73.5.1</b> 繪圖法</a></li>
<li class="chapter" data-level="73.5.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#統計檢驗法"><i class="fa fa-check"></i><b>73.5.2</b> 統計檢驗法</a></li>
</ul></li>
<li class="chapter" data-level="73.6" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#多於-1-個解釋變量的參數模型"><i class="fa fa-check"></i><b>73.6</b> 多於 1 個解釋變量的參數模型</a></li>
<li class="chapter" data-level="73.7" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#practical-survival-03"><i class="fa fa-check"></i><b>73.7</b> Practical Survival 03</a></li>
</ul></li>
<li class="chapter" data-level="74" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#cox-比例風險模型"><i class="fa fa-check"></i><b>74</b> Cox 比例風險模型</a><ul>
<li class="chapter" data-level="74.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#該用半參數模型還是用全參數模型"><i class="fa fa-check"></i><b>74.1</b> 該用半參數模型還是用全參數模型</a></li>
</ul></li>
<li class="chapter" data-level="75" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#分析策略和模型檢查-model-checking-survival-analysis"><i class="fa fa-check"></i><b>75</b> 分析策略和模型檢查 Model checking-survival analysis</a><ul>
<li class="chapter" data-level="75.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存分析策略"><i class="fa fa-check"></i><b>75.1</b> 生存分析策略</a></li>
<li class="chapter" data-level="75.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#針對臨床實驗"><i class="fa fa-check"></i><b>75.2</b> 針對臨床實驗</a></li>
<li class="chapter" data-level="75.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#針對觀察性研究"><i class="fa fa-check"></i><b>75.3</b> 針對觀察性研究</a></li>
<li class="chapter" data-level="75.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#模型檢查的要點"><i class="fa fa-check"></i><b>75.4</b> 模型檢查的要點</a></li>
<li class="chapter" data-level="75.5" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#比例風險假設的檢查-check-the-proportional-hazard-assumtion"><i class="fa fa-check"></i><b>75.5</b> 比例風險假設的檢查 check the proportional hazard assumtion</a><ul>
<li class="chapter" data-level="75.5.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#比例風險檢查的統計檢驗法"><i class="fa fa-check"></i><b>75.5.1</b> 比例風險檢查的統計檢驗法</a></li>
<li class="chapter" data-level="75.5.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#用-schoenfeld-殘差繪圖"><i class="fa fa-check"></i><b>75.5.2</b> 用 Schoenfeld 殘差繪圖</a></li>
</ul></li>
<li class="chapter" data-level="75.6" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#評價模型擬合的其他有趣方法"><i class="fa fa-check"></i><b>75.6</b> 評價模型擬合的其他有趣方法</a><ul>
<li class="chapter" data-level="75.6.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#martingale-殘差-assessing-the-functional-form-of-continuous-variables"><i class="fa fa-check"></i><b>75.6.1</b> Martingale 殘差-assessing the functional form of continuous variables</a></li>
<li class="chapter" data-level="75.6.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#deviance-偏差殘差-identifying-individuals-for-whom-the-model-does-not-provide-a-good-fit"><i class="fa fa-check"></i><b>75.6.2</b> Deviance 偏差殘差 – identifying individuals for whom the model does not provide a good fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="76" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#競爭風險模型-competing-risk"><i class="fa fa-check"></i><b>76</b> 競爭風險模型 competing risk</a><ul>
<li class="chapter" data-level="76.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#cause-specific-hazard"><i class="fa fa-check"></i><b>76.1</b> Cause-specific hazard</a><ul>
<li class="chapter" data-level="76.1.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#cause-specific-hazards-models"><i class="fa fa-check"></i><b>76.1.1</b> Cause-specific hazards models</a></li>
</ul></li>
<li class="chapter" data-level="76.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#cumulative-incidence-function"><i class="fa fa-check"></i><b>76.2</b> Cumulative incidence function</a></li>
<li class="chapter" data-level="76.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#subdistribution-hazard---fine-and-gray-model"><i class="fa fa-check"></i><b>76.3</b> Subdistribution hazard - Fine and Gray model</a><ul>
<li class="chapter" data-level="76.3.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#subdistribution-hazard-model"><i class="fa fa-check"></i><b>76.3.1</b> Subdistribution hazard model</a></li>
</ul></li>
<li class="chapter" data-level="76.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#multi-state-models"><i class="fa fa-check"></i><b>76.4</b> Multi-state models</a><ul>
<li class="chapter" data-level="76.4.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#the-markov-model"><i class="fa fa-check"></i><b>76.4.1</b> The Markov model</a></li>
<li class="chapter" data-level="76.4.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#cox-proportional-hazards-model-for-transition-intensities"><i class="fa fa-check"></i><b>76.4.2</b> Cox proportional hazards model for transition intensities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="77" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#生存分析的其他手段"><i class="fa fa-check"></i><b>77</b> 生存分析的其他手段</a><ul>
<li class="chapter" data-level="77.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#分層cox生存分析-stratified-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>77.1</b> 分層Cox生存分析 stratified Cox proportional hazards model</a></li>
<li class="chapter" data-level="77.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#加速失效模型-accelerated-failure-time-aft-model"><i class="fa fa-check"></i><b>77.2</b> 加速失效模型 Accelerated failure time (AFT) model</a><ul>
<li class="chapter" data-level="77.2.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#weibull-模型也是一種-aft-模型"><i class="fa fa-check"></i><b>77.2.1</b> Weibull 模型也是一種 AFT 模型</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="78" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#時間依存變量-time-dependent-variables-和脆弱模型-frailty-model"><i class="fa fa-check"></i><b>78</b> 時間依存變量 Time-dependent variables 和脆弱模型 frailty model</a><ul>
<li class="chapter" data-level="78.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#時間依存變量指的是什麼"><i class="fa fa-check"></i><b>78.1</b> 時間依存變量指的是什麼</a></li>
<li class="chapter" data-level="78.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#extended-cox-model-把cox模型擴展開去"><i class="fa fa-check"></i><b>78.2</b> Extended Cox model 把Cox模型擴展開去</a><ul>
<li class="chapter" data-level="78.2.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#練習題-exercise-8.1"><i class="fa fa-check"></i><b>78.2.1</b> 練習題 exercise 8.1</a></li>
<li class="chapter" data-level="78.2.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#解答"><i class="fa fa-check"></i><b>78.2.2</b> 解答</a></li>
</ul></li>
<li class="chapter" data-level="78.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#時間依存變量數據的結構"><i class="fa fa-check"></i><b>78.3</b> 時間依存變量數據的結構</a><ul>
<li class="chapter" data-level="78.3.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#值得注意的點"><i class="fa fa-check"></i><b>78.3.1</b> 值得注意的點</a></li>
</ul></li>
<li class="chapter" data-level="78.4" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#frailty-models-脆弱模型"><i class="fa fa-check"></i><b>78.4</b> Frailty Models (脆弱模型?)</a><ul>
<li class="chapter" data-level="78.4.1" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#individual-frailty-model"><i class="fa fa-check"></i><b>78.4.1</b> Individual frailty model</a></li>
<li class="chapter" data-level="78.4.2" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#application-to-a-weibull-model"><i class="fa fa-check"></i><b>78.4.2</b> Application to a Weibull model</a></li>
<li class="chapter" data-level="78.4.3" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#shared-frailty-model"><i class="fa fa-check"></i><b>78.4.3</b> Shared frailty model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="79" data-path="11-Survival-analysis.html"><a href="11-Survival-analysis.html#時間事件數據的高級分析法"><i class="fa fa-check"></i><b>79</b> 時間事件數據的高級分析法</a></li>
<li class="part"><span><b>XI 貝葉斯統計學 Bayesian Statistics</b></span></li>
<li class="chapter" data-level="80" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html"><i class="fa fa-check"></i><b>80</b> 爲什麼我們要用貝葉斯統計學方法？</a><ul>
<li class="chapter" data-level="80.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#氨甲喋呤-methotrexate-在系統性硬皮病-systematic-sclerosis-ssc-中的療效"><i class="fa fa-check"></i><b>80.1</b> 氨甲喋呤 (methotrexate) 在系統性硬皮病 (systematic sclerosis, SSc) 中的療效</a><ul>
<li class="chapter" data-level="80.1.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#背景資料-ssc-trial"><i class="fa fa-check"></i><b>80.1.1</b> 背景資料-SSc trial</a></li>
<li class="chapter" data-level="80.1.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#概率論者分析結果"><i class="fa fa-check"></i><b>80.1.2</b> 概率論者分析結果</a></li>
<li class="chapter" data-level="80.1.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯統計分析結果"><i class="fa fa-check"></i><b>80.1.3</b> 貝葉斯統計分析結果</a></li>
</ul></li>
<li class="chapter" data-level="80.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#example-the-great-trial"><i class="fa fa-check"></i><b>80.2</b> Example: The GREAT trial</a><ul>
<li class="chapter" data-level="80.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#background-great-trial"><i class="fa fa-check"></i><b>80.2.1</b> Background (GREAT trial)</a></li>
<li class="chapter" data-level="80.2.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#試驗結果"><i class="fa fa-check"></i><b>80.2.2</b> 試驗結果</a></li>
<li class="chapter" data-level="80.2.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#經典統計學分析方法"><i class="fa fa-check"></i><b>80.2.3</b> 經典統計學分析方法</a></li>
<li class="chapter" data-level="80.2.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯統計學分析方法"><i class="fa fa-check"></i><b>80.2.4</b> 貝葉斯統計學分析方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="81" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#MC-estimation"><i class="fa fa-check"></i><b>81</b> 蒙特卡羅估計和預測 Mente Carlo estimation and prediction</a><ul>
<li class="chapter" data-level="81.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#起源"><i class="fa fa-check"></i><b>81.1</b> 起源</a><ul>
<li class="chapter" data-level="81.1.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#作出預測"><i class="fa fa-check"></i><b>81.1.1</b> 作出預測</a></li>
<li class="chapter" data-level="81.1.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#example-新藥表現預測"><i class="fa fa-check"></i><b>81.1.2</b> Example: 新藥表現預測</a></li>
</ul></li>
<li class="chapter" data-level="81.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#蒙特卡羅估計"><i class="fa fa-check"></i><b>81.2</b> 蒙特卡羅估計</a><ul>
<li class="chapter" data-level="81.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#用蒙特卡羅法估計概率分佈尾側累積概率面積"><i class="fa fa-check"></i><b>81.2.1</b> 用蒙特卡羅法估計概率分佈尾側累積概率(面積)</a></li>
<li class="chapter" data-level="81.2.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#用蒙特卡羅法計算預測概率分佈"><i class="fa fa-check"></i><b>81.2.2</b> 用蒙特卡羅法計算預測概率分佈</a></li>
</ul></li>
<li class="chapter" data-level="81.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#蒙特卡羅法分析軟件-openbugs"><i class="fa fa-check"></i><b>81.3</b> 蒙特卡羅法分析軟件 OpenBUGS</a><ul>
<li class="chapter" data-level="81.3.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#用-openbugs-分析投擲硬幣數據"><i class="fa fa-check"></i><b>81.3.1</b> 用 OpenBUGS 分析投擲硬幣數據</a></li>
<li class="chapter" data-level="81.3.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#用-openbugs-對藥物臨牀試驗的結果做預測"><i class="fa fa-check"></i><b>81.3.2</b> 用 OpenBUGS 對藥物臨牀試驗的結果做預測</a></li>
<li class="chapter" data-level="81.3.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#用蒙特卡羅法計算一個臨牀試驗的統計效能-allow-uncertainty-in-power-calculation"><i class="fa fa-check"></i><b>81.3.3</b> 用蒙特卡羅法計算一個臨牀試驗的統計效能 allow uncertainty in power calculation</a></li>
</ul></li>
<li class="chapter" data-level="81.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#practical-bayesian-statistics-02"><i class="fa fa-check"></i><b>81.4</b> Practical Bayesian Statistics 02</a></li>
</ul></li>
<li class="chapter" data-level="82" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#共軛先驗概率-conjugate-priors"><i class="fa fa-check"></i><b>82</b> 共軛先驗概率 Conjugate priors</a><ul>
<li class="chapter" data-level="82.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯推斷的基礎"><i class="fa fa-check"></i><b>82.1</b> 貝葉斯推斷的基礎</a></li>
<li class="chapter" data-level="82.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#二項分布似然數據的共軛先驗概率"><i class="fa fa-check"></i><b>82.2</b> 二項分布(似然)數據的共軛先驗概率</a><ul>
<li class="chapter" data-level="82.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#事後概率分布預測"><i class="fa fa-check"></i><b>82.2.1</b> 事後概率分布預測</a></li>
</ul></li>
<li class="chapter" data-level="82.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#正態分布似然數據的共軛先驗概率"><i class="fa fa-check"></i><b>82.3</b> 正態分布(似然)數據的共軛先驗概率</a></li>
<li class="chapter" data-level="82.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#泊淞分布似然數據的共軛先驗概率"><i class="fa fa-check"></i><b>82.4</b> 泊淞分布(似然)數據的共軛先驗概率</a></li>
<li class="chapter" data-level="82.5" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#共軛先驗概率分布的總結"><i class="fa fa-check"></i><b>82.5</b> 共軛先驗概率分布的總結</a></li>
<li class="chapter" data-level="82.6" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#BayesPrac03"><i class="fa fa-check"></i><b>82.6</b> Practical Bayesian Statistics 03</a></li>
</ul></li>
<li class="chapter" data-level="83" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#MCMC-methods"><i class="fa fa-check"></i><b>83</b> 馬爾可夫鏈蒙特卡羅MCMC，圖形模型，BUGS語言</a><ul>
<li class="chapter" data-level="83.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#markov-chain-monte-carlo-馬爾可夫鏈蒙特卡羅算法"><i class="fa fa-check"></i><b>83.1</b> Markov Chain Monte Carlo 馬爾可夫鏈蒙特卡羅算法</a><ul>
<li class="chapter" data-level="83.1.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#爲什麼我們需要用計算機模擬算法simulation-methods來進行貝葉斯統計推斷"><i class="fa fa-check"></i><b>83.1.1</b> 爲什麼我們需要用計算機模擬算法(simulation methods)來進行貝葉斯統計推斷？</a></li>
<li class="chapter" data-level="83.1.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#Gibbs-sampling"><i class="fa fa-check"></i><b>83.1.2</b> 吉布斯採樣</a></li>
<li class="chapter" data-level="83.1.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#初始值-initial-values"><i class="fa fa-check"></i><b>83.1.3</b> 初始值 initial values</a></li>
</ul></li>
<li class="chapter" data-level="83.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#使用-mcmc-時需要考慮的一些問題"><i class="fa fa-check"></i><b>83.2</b> 使用 MCMC 時需要考慮的一些問題</a><ul>
<li class="chapter" data-level="83.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#收斂時間"><i class="fa fa-check"></i><b>83.2.1</b> 收斂時間</a></li>
<li class="chapter" data-level="83.2.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#模型效率-efficiency-of-mcmc"><i class="fa fa-check"></i><b>83.2.2</b> 模型效率 efficiency of MCMC</a></li>
</ul></li>
<li class="chapter" data-level="83.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#bugs-軟件"><i class="fa fa-check"></i><b>83.3</b> BUGS 軟件</a></li>
<li class="chapter" data-level="83.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#圖形模型-statistical-graphical-models---directed-acyclic-graphs-dags"><i class="fa fa-check"></i><b>83.4</b> 圖形模型 statistical graphical models - Directed Acyclic Graphs (DAGs)</a><ul>
<li class="chapter" data-level="83.4.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#條件獨立的概念-conditional-independence-concept"><i class="fa fa-check"></i><b>83.4.1</b> 條件獨立的概念 conditional independence concept</a></li>
</ul></li>
<li class="chapter" data-level="83.5" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#bugs-language"><i class="fa fa-check"></i><b>83.5</b> BUGS language</a><ul>
<li class="chapter" data-level="83.5.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#節點的種類-types-of-nodes"><i class="fa fa-check"></i><b>83.5.1</b> 節點的種類 types of nodes</a></li>
<li class="chapter" data-level="83.5.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#分布的標記法"><i class="fa fa-check"></i><b>83.5.2</b> 分布的標記法</a></li>
<li class="chapter" data-level="83.5.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#arrays-and-loops"><i class="fa fa-check"></i><b>83.5.3</b> Arrays and loops</a></li>
<li class="chapter" data-level="83.5.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#常用的方程"><i class="fa fa-check"></i><b>83.5.4</b> 常用的方程</a></li>
</ul></li>
<li class="chapter" data-level="83.6" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#爲bugs-model模型準備格式正確的數據"><i class="fa fa-check"></i><b>83.6</b> 爲BUGS model模型準備格式正確的數據</a></li>
<li class="chapter" data-level="83.7" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#practical-bayesian-statistics-04"><i class="fa fa-check"></i><b>83.7</b> Practical Bayesian Statistics 04</a></li>
</ul></li>
<li class="chapter" data-level="84" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#建模和模型的檢查"><i class="fa fa-check"></i><b>84</b> 建模和模型的檢查</a><ul>
<li class="chapter" data-level="84.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#BayesianLM"><i class="fa fa-check"></i><b>84.1</b> 簡單線性回歸模型</a></li>
<li class="chapter" data-level="84.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#children-in-the-gambia"><i class="fa fa-check"></i><b>84.2</b> Children in the Gambia</a><ul>
<li class="chapter" data-level="84.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#岡比亞兒童數據模型"><i class="fa fa-check"></i><b>84.2.1</b> 岡比亞兒童數據模型</a></li>
<li class="chapter" data-level="84.2.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#bugs-model-for-gambia-example"><i class="fa fa-check"></i><b>84.2.2</b> BUGS model for Gambia example</a></li>
<li class="chapter" data-level="84.2.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#data-file-for-the-gambia-example"><i class="fa fa-check"></i><b>84.2.3</b> Data file for the Gambia example</a></li>
<li class="chapter" data-level="84.2.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#初始值文件-initial-value-files"><i class="fa fa-check"></i><b>84.2.4</b> 初始值文件 initial value files</a></li>
<li class="chapter" data-level="84.2.5" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#給岡比亞兒童體重數據的貝葉斯模型檢查收斂-mcmc-check-1"><i class="fa fa-check"></i><b>84.2.5</b> 給岡比亞兒童體重數據的貝葉斯模型檢查收斂 (MCMC check 1)</a></li>
<li class="chapter" data-level="84.2.6" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#岡比亞兒童體重數據的貝葉斯統計學推斷結果"><i class="fa fa-check"></i><b>84.2.6</b> 岡比亞兒童體重數據的貝葉斯統計學推斷結果</a></li>
<li class="chapter" data-level="84.2.7" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#檢查岡比亞兒童體重數據貝葉斯模型的有效樣本量-effective-sample-size-mcmc-check-2"><i class="fa fa-check"></i><b>84.2.7</b> 檢查岡比亞兒童體重數據貝葉斯模型的有效樣本量 effective sample size (MCMC check 2)</a></li>
<li class="chapter" data-level="84.2.8" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#檢查模型擬合程度-checking-model-fit-for-the-gambia-example"><i class="fa fa-check"></i><b>84.2.8</b> 檢查模型擬合程度 checking model fit for the Gambia example</a></li>
<li class="chapter" data-level="84.2.9" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#tdreplacegaussian"><i class="fa fa-check"></i><b>84.2.9</b> 其他的替代模型 alternative model with t-errors</a></li>
</ul></li>
<li class="chapter" data-level="84.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯統計模型的比較-bayesian-model-comparison"><i class="fa fa-check"></i><b>84.3</b> 貝葉斯統計模型的比較 Bayesian model comparison</a><ul>
<li class="chapter" data-level="84.3.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#deviance-information-criterion-dic"><i class="fa fa-check"></i><b>84.3.1</b> Deviance Information Criterion (DIC)</a></li>
<li class="chapter" data-level="84.3.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#岡比亞兒童體重數據模型比較"><i class="fa fa-check"></i><b>84.3.2</b> 岡比亞兒童體重數據模型比較</a></li>
</ul></li>
<li class="chapter" data-level="84.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#practical-bayesian-statistics-05"><i class="fa fa-check"></i><b>84.4</b> Practical Bayesian Statistics 05</a><ul>
<li class="chapter" data-level="84.4.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#增加年齡二次方項-adding-age-squared"><i class="fa fa-check"></i><b>84.4.1</b> 增加年齡二次方項 adding age squared</a></li>
<li class="chapter" data-level="84.4.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#增加年齡和性別的交互作用項-adding-an-interaction-term"><i class="fa fa-check"></i><b>84.4.2</b> 增加年齡和性別的交互作用項 adding an interaction term</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="85" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#不同實驗研究設計時適用的貝葉斯模型"><i class="fa fa-check"></i><b>85</b> 不同實驗/研究設計時適用的貝葉斯模型</a><ul>
<li class="chapter" data-level="85.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#隊列研究設計時的貝葉斯模型"><i class="fa fa-check"></i><b>85.1</b> 隊列研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="85.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#病例對照研究設計時的貝葉斯模型"><i class="fa fa-check"></i><b>85.2</b> 病例對照研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="85.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#橫斷面研究設計時的貝葉斯模型"><i class="fa fa-check"></i><b>85.3</b> 橫斷面研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="85.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#把不同實驗設計的數據用貝葉斯模型連接起來"><i class="fa fa-check"></i><b>85.4</b> 把不同實驗設計的數據用貝葉斯模型連接起來</a><ul>
<li class="chapter" data-level="85.4.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#linking-sub-models-throug-common-parameters"><i class="fa fa-check"></i><b>85.4.1</b> Linking sub-models throug common parameters</a></li>
</ul></li>
<li class="chapter" data-level="85.5" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#practical-bayesian-statistics-06"><i class="fa fa-check"></i><b>85.5</b> Practical Bayesian Statistics 06</a><ul>
<li class="chapter" data-level="85.5.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#the-great-trial"><i class="fa fa-check"></i><b>85.5.1</b> The GREAT Trial</a></li>
<li class="chapter" data-level="85.5.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#吸煙與癌症"><i class="fa fa-check"></i><b>85.5.2</b> 吸煙與癌症</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="86" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯廣義線性回歸"><i class="fa fa-check"></i><b>86</b> 貝葉斯廣義線性回歸</a><ul>
<li class="chapter" data-level="86.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#如何在bugs語言中描述分類型變量"><i class="fa fa-check"></i><b>86.1</b> 如何在BUGS語言中描述分類型變量</a><ul>
<li class="chapter" data-level="86.1.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#啞變量的數據矩陣"><i class="fa fa-check"></i><b>86.1.1</b> 啞變量的數據矩陣</a></li>
<li class="chapter" data-level="86.1.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#雙重索引bugs語言標記法"><i class="fa fa-check"></i><b>86.1.2</b> 雙重索引BUGS語言標記法</a></li>
</ul></li>
<li class="chapter" data-level="86.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#邏輯回歸-bayesian-logistic-regression"><i class="fa fa-check"></i><b>86.2</b> 邏輯回歸 Bayesian Logistic Regression</a><ul>
<li class="chapter" data-level="86.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#低出生體重數據-1"><i class="fa fa-check"></i><b>86.2.1</b> 低出生體重數據</a></li>
</ul></li>
<li class="chapter" data-level="86.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯泊鬆回歸-bayesian-poisson-regression"><i class="fa fa-check"></i><b>86.3</b> 貝葉斯泊鬆回歸 Bayesian Poisson Regression</a></li>
<li class="chapter" data-level="86.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#glm-in-a-bayesian-way"><i class="fa fa-check"></i><b>86.4</b> GLM in a Bayesian way</a></li>
<li class="chapter" data-level="86.5" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#Bayesian-practical07"><i class="fa fa-check"></i><b>86.5</b> Practical Bayesian Statistics 07</a></li>
</ul></li>
<li class="chapter" data-level="87" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯等級回歸模型"><i class="fa fa-check"></i><b>87</b> 貝葉斯等級回歸模型</a><ul>
<li class="chapter" data-level="87.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#關於等級迴歸模型"><i class="fa fa-check"></i><b>87.1</b> 關於等級迴歸模型</a></li>
<li class="chapter" data-level="87.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#多層數據在模型中可能要用到的前提條件"><i class="fa fa-check"></i><b>87.2</b> 多層數據在模型中可能要用到的前提條件</a><ul>
<li class="chapter" data-level="87.2.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#參數是相同的-identical-parameters"><i class="fa fa-check"></i><b>87.2.1</b> 參數是相同的 (identical parameters)</a></li>
<li class="chapter" data-level="87.2.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#參數是獨立的-independent-parameters"><i class="fa fa-check"></i><b>87.2.2</b> 參數是獨立的 (independent parameters)</a></li>
<li class="chapter" data-level="87.2.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#參數是可交換的-exchangeable-parameters"><i class="fa fa-check"></i><b>87.2.3</b> 參數是可交換的 (exchangeable parameters)</a></li>
</ul></li>
<li class="chapter" data-level="87.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#抗抑鬱臨牀試驗實例"><i class="fa fa-check"></i><b>87.3</b> 抗抑鬱臨牀試驗實例</a><ul>
<li class="chapter" data-level="87.3.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#縱向數據"><i class="fa fa-check"></i><b>87.3.1</b> 縱向數據</a></li>
<li class="chapter" data-level="87.3.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#hamd-example"><i class="fa fa-check"></i><b>87.3.2</b> HAMD example</a></li>
<li class="chapter" data-level="87.3.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯簡單線性迴歸模型"><i class="fa fa-check"></i><b>87.3.3</b> 貝葉斯簡單線性迴歸模型</a></li>
<li class="chapter" data-level="87.3.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯等級線性回歸隨機截距模型"><i class="fa fa-check"></i><b>87.3.4</b> 貝葉斯等級線性回歸–隨機截距模型</a></li>
<li class="chapter" data-level="87.3.5" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯等級線性回歸模型隨機截距和隨機斜率模型"><i class="fa fa-check"></i><b>87.3.5</b> 貝葉斯等級線性回歸模型–隨機截距和隨機斜率模型</a></li>
<li class="chapter" data-level="87.3.6" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#hamd-數據不同模型結果的比較"><i class="fa fa-check"></i><b>87.3.6</b> HAMD 數據不同模型結果的比較</a></li>
<li class="chapter" data-level="87.3.7" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#hamd-數據實例結果的解釋"><i class="fa fa-check"></i><b>87.3.7</b> HAMD 數據實例結果的解釋</a></li>
</ul></li>
<li class="chapter" data-level="87.4" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#practical-bayesian-statistics-08"><i class="fa fa-check"></i><b>87.4</b> Practical Bayesian Statistics 08</a></li>
</ul></li>
<li class="chapter" data-level="88" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#再訪-mcmc"><i class="fa fa-check"></i><b>88</b> 再訪 MCMC</a><ul>
<li class="chapter" data-level="88.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#metropolis-hastings-algorithm"><i class="fa fa-check"></i><b>88.1</b> Metropolis-Hastings algorithm</a></li>
<li class="chapter" data-level="88.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#適應階段-adaptive-phase"><i class="fa fa-check"></i><b>88.2</b> 適應階段 adaptive phase</a></li>
</ul></li>
<li class="chapter" data-level="89" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#貝葉斯和概率論的比較"><i class="fa fa-check"></i><b>89</b> 貝葉斯和概率論的比較</a><ul>
<li class="chapter" data-level="89.1" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#兩種方法的不同點總覽"><i class="fa fa-check"></i><b>89.1</b> 兩種方法的不同點總覽</a></li>
<li class="chapter" data-level="89.2" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#亞組分析-subgroup-analysis"><i class="fa fa-check"></i><b>89.2</b> 亞組分析 subgroup analysis</a></li>
<li class="chapter" data-level="89.3" data-path="12-Bayesian-stats.html"><a href="12-Bayesian-stats.html#多重比較問題-multiple-comparisons"><i class="fa fa-check"></i><b>89.3</b> 多重比較問題 multiple comparisons</a></li>
</ul></li>
<li class="part"><span><b>XII 因果推斷 Causal Inference</b></span></li>
<li class="chapter" data-level="90" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html"><i class="fa fa-check"></i><b>90</b> Causal Languages 因果推斷的語法</a><ul>
<li class="chapter" data-level="90.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#當我們在談論因果推斷的時候我們在談論什麼"><i class="fa fa-check"></i><b>90.1</b> 當我們在談論因果推斷的時候，我們在談論什麼？</a></li>
<li class="chapter" data-level="90.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#傳統的統計學方法"><i class="fa fa-check"></i><b>90.2</b> 傳統的統計學方法</a><ul>
<li class="chapter" data-level="90.2.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#初步分析"><i class="fa fa-check"></i><b>90.2.1</b> 初步分析</a></li>
<li class="chapter" data-level="90.2.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#混雜"><i class="fa fa-check"></i><b>90.2.2</b> 混雜</a></li>
<li class="chapter" data-level="90.2.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#以共變量爲條件-conditioning-on-covariates"><i class="fa fa-check"></i><b>90.2.3</b> 以共變量爲條件 conditioning on covariates</a></li>
</ul></li>
<li class="chapter" data-level="90.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#更加正規的方法"><i class="fa fa-check"></i><b>90.3</b> 更加正規的方法</a><ul>
<li class="chapter" data-level="90.3.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#因果推斷使用的語言"><i class="fa fa-check"></i><b>90.3.1</b> 因果推斷使用的語言</a></li>
<li class="chapter" data-level="90.3.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#因果推斷的被估計量-causal-estimands"><i class="fa fa-check"></i><b>90.3.2</b> 因果推斷的被估計量 causal estimands</a></li>
<li class="chapter" data-level="90.3.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#鑑定因果推斷時的前提假設-assumptions-for-identification"><i class="fa fa-check"></i><b>90.3.3</b> 鑑定因果推斷時的前提假設 assumptions for identification</a></li>
<li class="chapter" data-level="90.3.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#鑑定-identification"><i class="fa fa-check"></i><b>90.3.4</b> 鑑定 identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="91" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#graphical-models-因果推斷的圖形模型"><i class="fa fa-check"></i><b>91</b> Graphical Models 因果推斷的圖形模型</a><ul>
<li class="chapter" data-level="91.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#統計學中的有向無環圖"><i class="fa fa-check"></i><b>91.1</b> 統計學中的有向無環圖</a><ul>
<li class="chapter" data-level="91.1.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#dag-和條件獨立性-conditional-independence"><i class="fa fa-check"></i><b>91.1.1</b> DAG 和條件獨立性 conditional independence</a></li>
<li class="chapter" data-level="91.1.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#dag-圖的術語"><i class="fa fa-check"></i><b>91.1.2</b> DAG 圖的術語</a></li>
<li class="chapter" data-level="91.1.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#阻斷通路-blocking-paths"><i class="fa fa-check"></i><b>91.1.3</b> 阻斷通路 blocking paths</a></li>
<li class="chapter" data-level="91.1.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#以對撞因子爲條件-conditioning-on-a-collider"><i class="fa fa-check"></i><b>91.1.4</b> 以對撞因子爲條件 conditioning on a collider</a></li>
</ul></li>
<li class="chapter" data-level="91.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#以非對撞銀子爲條件-conditioning-on-a-non-collider"><i class="fa fa-check"></i><b>91.2</b> 以非對撞銀子爲條件 conditioning on a non-collider</a><ul>
<li class="chapter" data-level="91.2.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#條件的總結"><i class="fa fa-check"></i><b>91.2.1</b> 條件的總結</a></li>
<li class="chapter" data-level="91.2.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#d-分離-d-separation"><i class="fa fa-check"></i><b>91.2.2</b> D 分離 d-separation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="92" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#regression-methods-with-continuous-outcomes-結果變量爲連續型變量"><i class="fa fa-check"></i><b>92</b> Regression Methods with continuous outcomes 結果變量爲連續型變量</a><ul>
<li class="chapter" data-level="92.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用於對連續型結果變量做因果推斷的被估計量"><i class="fa fa-check"></i><b>92.1</b> 用於對連續型結果變量做因果推斷的被估計量</a></li>
<li class="chapter" data-level="92.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#鑑定-identification---revision"><i class="fa fa-check"></i><b>92.2</b> 鑑定 identification - revision</a><ul>
<li class="chapter" data-level="92.2.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#條件因果均差-conditional-causal-mean-difference"><i class="fa fa-check"></i><b>92.2.1</b> 條件因果均差 conditional causal mean difference</a></li>
<li class="chapter" data-level="92.2.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#簡單分類型條件變量-c-的-ace"><i class="fa fa-check"></i><b>92.2.2</b> 簡單分類型條件變量 <span class="math inline">\(C\)</span> 的 ACE</a></li>
<li class="chapter" data-level="92.2.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#簡單連續型條件變量-c-的ace"><i class="fa fa-check"></i><b>92.2.3</b> 簡單連續型條件變量 <span class="math inline">\(C\)</span> 的ACE</a></li>
</ul></li>
<li class="chapter" data-level="92.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#通過線性回歸模型來估計-ace"><i class="fa fa-check"></i><b>92.3</b> 通過線性回歸模型來估計 ACE</a><ul>
<li class="chapter" data-level="92.3.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#條件因果均值差"><i class="fa fa-check"></i><b>92.3.1</b> 條件因果均值差</a></li>
<li class="chapter" data-level="92.3.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#效應修正-effect-modification-和-交互作用-interaction"><i class="fa fa-check"></i><b>92.3.2</b> 效應修正 effect modification 和 交互作用 interaction</a></li>
<li class="chapter" data-level="92.3.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#分類型條件變量的平均因果效應-ace"><i class="fa fa-check"></i><b>92.3.3</b> 分類型條件變量的平均因果效應 (ACE)</a></li>
<li class="chapter" data-level="92.3.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#positivity-非零性"><i class="fa fa-check"></i><b>92.3.4</b> Positivity 非零性</a></li>
<li class="chapter" data-level="92.3.5" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#連續型變量的平均因果效應"><i class="fa fa-check"></i><b>92.3.5</b> 連續型變量的平均因果效應</a></li>
</ul></li>
<li class="chapter" data-level="92.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#practical03---causal-inference"><i class="fa fa-check"></i><b>92.4</b> Practical03 - causal inference</a></li>
</ul></li>
<li class="chapter" data-level="93" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#regression-methods-with-binary-outcomes-結果變量爲二分類變量"><i class="fa fa-check"></i><b>93</b> Regression Methods with binary outcomes 結果變量爲二分類變量</a><ul>
<li class="chapter" data-level="93.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#二分類結果變量的因果被估計量-causal-estimand"><i class="fa fa-check"></i><b>93.1</b> 二分類結果變量的因果被估計量 (causal estimand):</a><ul>
<li class="chapter" data-level="93.1.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#比值比的不可壓縮性-non-collapsibility-of-the-odds-ratio"><i class="fa fa-check"></i><b>93.1.1</b> 比值比的不可壓縮性 non-collapsibility of the odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="93.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#鑑定-identification---conditional-effects"><i class="fa fa-check"></i><b>93.2</b> 鑑定 identification - conditional effects</a></li>
<li class="chapter" data-level="93.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#鑑定-identification---marginal-effects"><i class="fa fa-check"></i><b>93.3</b> 鑑定 identification - marginal effects</a><ul>
<li class="chapter" data-level="93.3.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#marginal-causal-risk-difference-ace"><i class="fa fa-check"></i><b>93.3.1</b> Marginal causal risk difference (ACE)</a></li>
<li class="chapter" data-level="93.3.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#marginal-causal-log-risk-ratio"><i class="fa fa-check"></i><b>93.3.2</b> Marginal causal log risk ratio</a></li>
</ul></li>
<li class="chapter" data-level="93.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#通過邏輯回歸估計這些被估計量"><i class="fa fa-check"></i><b>93.4</b> 通過邏輯回歸估計這些被估計量</a></li>
<li class="chapter" data-level="93.5" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#average-causaltreatment-effect-in-the-exposedtreated-atet"><i class="fa fa-check"></i><b>93.5</b> Average causal/treatment effect in the exposed/treated (ATET)</a></li>
<li class="chapter" data-level="93.6" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#practical04---causal-inference"><i class="fa fa-check"></i><b>93.6</b> Practical04 - causal inference</a><ul>
<li class="chapter" data-level="93.6.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#在stata裡打開數據初步分析和熟悉數據"><i class="fa fa-check"></i><b>93.6.1</b> 在STATA裡打開數據，初步分析和熟悉數據</a></li>
<li class="chapter" data-level="93.6.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用標準邏輯回歸模型分析-rfa-暴露-和-dodp-結果-之間的關係"><i class="fa fa-check"></i><b>93.6.2</b> 用標準邏輯回歸模型分析 <code>rfa</code> (暴露) 和 <code>dodp</code> (結果) 之間的關係</a></li>
<li class="chapter" data-level="93.6.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#比較上面a和b兩個邏輯回歸模型的結果你認為混雜因素對暴露和結果的關係的影響是怎樣的"><i class="fa fa-check"></i><b>93.6.3</b> 比較上面(a)和(b)兩個邏輯回歸模型的結果，你認為混雜因素對暴露和結果的關係的影響是怎樣的？</a></li>
<li class="chapter" data-level="93.6.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#在怎樣的前提假設條件下上面模型-b-可以被賦予因果關係的解釋"><i class="fa fa-check"></i><b>93.6.4</b> 在怎樣的前提假設條件下，上面模型 (b) 可以被賦予因果關係的解釋？</a></li>
<li class="chapter" data-level="93.6.5" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#在前面提出的所有前提假設都滿足的情況下請給模型-b-的回歸係數賦予一個因果效應的解釋"><i class="fa fa-check"></i><b>93.6.5</b> 在前面提出的所有前提假設都滿足的情況下，請給模型 (b) 的回歸係數賦予一個因果效應的解釋。</a></li>
<li class="chapter" data-level="93.6.6" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用-stata-的-teffects-ra-擬合上面兩個模型"><i class="fa fa-check"></i><b>93.6.6</b> 用 STATA 的 <code>teffects ra</code> 擬合上面兩個模型</a></li>
<li class="chapter" data-level="93.6.7" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#在怎樣的假設前提條件下前一步擬合的模型-b-結果中的-ate-可以被賦予因果關係的解釋"><i class="fa fa-check"></i><b>93.6.7</b> 在怎樣的假設前提條件下，前一步擬合的模型 (b) 結果中的 ATE 可以被賦予因果關係的解釋？</a></li>
<li class="chapter" data-level="93.6.8" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#前一問和你擬合完簡單的邏輯回歸之後做的模型假設的回答有什麼不同"><i class="fa fa-check"></i><b>93.6.8</b> 前一問和你擬合完簡單的邏輯回歸之後做的模型假設的回答，有什麼不同？</a></li>
<li class="chapter" data-level="93.6.9" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用因果關係語言解釋-teffects-ra-擬合的模型-b-的結果"><i class="fa fa-check"></i><b>93.6.9</b> 用因果關係語言解釋 <code>teffects ra</code> 擬合的模型 (b) 的結果</a></li>
<li class="chapter" data-level="93.6.10" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#如果模型中加入-age-gender-smoke-nodules-mets-duration-primary-等和預後相關但是和決定療法並不太有關係的變量結果會有什麼不同呢"><i class="fa fa-check"></i><b>93.6.10</b> 如果模型中加入 <code>age, gender, smoke, nodules, mets, duration, primary</code> 等和預後相關但是和決定療法並不太有關係的變量，結果會有什麼不同呢？</a></li>
<li class="chapter" data-level="93.6.11" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#如果再向模型中加入和暴露變量相關和預後沒什麼關係的變量-coag結果該怎麼解讀"><i class="fa fa-check"></i><b>93.6.11</b> 如果再向模型中加入和暴露變量相關，和預後沒什麼關係的變量 <code>coag</code>，結果該怎麼解讀？</a></li>
<li class="chapter" data-level="93.6.12" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#使用-atet-的選項重新擬合上面的因果效應模型解釋結果發生的變化並作出相應的結論"><i class="fa fa-check"></i><b>93.6.12</b> 使用 <code>atet</code> 的選項重新擬合上面的因果效應模型，解釋結果發生的變化，並作出相應的結論。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="94" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#prospensity-score-傾向性評分"><i class="fa fa-check"></i><b>94</b> Prospensity Score 傾向性評分</a><ul>
<li class="chapter" data-level="94.0.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#關於條件可置換性"><i class="fa fa-check"></i><b>94.0.1</b> 關於條件可置換性</a></li>
<li class="chapter" data-level="94.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#怎樣使用傾向性評分"><i class="fa fa-check"></i><b>94.1</b> 怎樣使用傾向性評分</a><ul>
<li class="chapter" data-level="94.1.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#分層法-stratification"><i class="fa fa-check"></i><b>94.1.1</b> 分層法 stratification</a></li>
<li class="chapter" data-level="94.1.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#配對法-matching"><i class="fa fa-check"></i><b>94.1.2</b> 配對法 matching</a></li>
<li class="chapter" data-level="94.1.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#回歸模型校正法-adjustment"><i class="fa fa-check"></i><b>94.1.3</b> 回歸模型校正法 adjustment</a></li>
</ul></li>
<li class="chapter" data-level="94.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#practical05---causal-inference"><i class="fa fa-check"></i><b>94.2</b> Practical05 - causal inference</a><ul>
<li class="chapter" data-level="94.2.1" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#初步熟悉數據內容"><i class="fa fa-check"></i><b>94.2.1</b> 初步熟悉數據內容</a></li>
<li class="chapter" data-level="94.2.2" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#把連續型變量以分類型數據的形式放入模型中"><i class="fa fa-check"></i><b>94.2.2</b> 把連續型變量以分類型數據的形式放入模型中:</a></li>
<li class="chapter" data-level="94.2.3" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用相同的模型結構估計每個人的傾向性評分"><i class="fa fa-check"></i><b>94.2.3</b> 用相同的模型結構估計每個人的傾向性評分</a></li>
<li class="chapter" data-level="94.2.4" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用-ps-評分來把對象分層-stratification"><i class="fa fa-check"></i><b>94.2.4</b> 用 PS 評分來把對象分層 stratification</a></li>
<li class="chapter" data-level="94.2.5" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#用配對法計算-ace"><i class="fa fa-check"></i><b>94.2.5</b> 用配對法計算 ACE</a></li>
<li class="chapter" data-level="94.2.6" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#模型校正-ps"><i class="fa fa-check"></i><b>94.2.6</b> 模型校正 PS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="95" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#inverse-probability-weighted-estimation-and-doubly-robust-methods"><i class="fa fa-check"></i><b>95</b> Inverse probability weighted estimation and doubly robust methods</a></li>
<li class="chapter" data-level="96" data-path="16-ASM-Causal-infer.html"><a href="16-ASM-Causal-infer.html#causal-mediation-analysis"><i class="fa fa-check"></i><b>96</b> Causal mediation analysis</a></li>
<li class="part"><span><b>XIII Statistical Methods in Epidemiology</b></span></li>
<li class="chapter" data-level="97" data-path="29SME.html"><a href="29SME.html"><i class="fa fa-check"></i><b>97</b> Crude and stratified rate ratios</a></li>
<li class="chapter" data-level="" data-path="30-references.html"><a href="30-references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">醫學統計學</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="生存分析入門" class="section level1">
<h1><span class="header-section-number">第 71 章</span> 生存分析入門</h1>
<blockquote>
<dl>
<dt>The best thing about being a statistician is that you get to play in everyone’s backyard.</dt>
<dd>John Tukey
</dd>
</dl>
</blockquote>

<div class="rmdnote">
The Survival Analysis lectures were orgainised and taught by Professor <a href="https://www.lshtm.ac.uk/aboutus/people/keogh.ruth">Ruth Keogh</a>, and Professor <a href="https://aurelienbelot.netlify.com">Aurélien Belot</a>.
</div>

<div id="什麼是生存分析" class="section level2">
<h2><span class="header-section-number">71.1</span> 什麼是生存分析</h2>
<p>生存分析，研究的是隨訪中研究對象發生我們關心的事件與否，以及比較發生該事件之前時間的長短 (生存時間) 的一種分析方法。生存數據的常見例子如下:</p>
<ul>
<li>死亡 (all cause);</li>
<li>診斷/治療後直至死亡發生的時間;</li>
<li>孕婦的懷孕時間 (孕期長短);</li>
<li>對象以健康狀態進入研究時開始，直至其診斷爲患有某種疾病的時間。</li>
</ul>
<p>生存分析中的常見術語:</p>
<ul>
<li>生存時間 survival time = 失敗時間 failure time = 事件時間 event time。</li>
<li>生存分析本身常被叫做事件史分析 time-to-event analysis。</li>
</ul>
<p>生存分析的結果，可以用來回答很多我們關心的問題:</p>
<ol style="list-style-type: decimal">
<li>研究特定人羣中，在某段時間內人口生存 (或死亡) 的模式 (平均壽命): 在英國，某年 (例如 1970 年) 出生的人，能夠生存到 5 歲，40 歲，100 歲的概率是多大？ (關心的是死亡在某人身上發生的概率)</li>
<li>比較兩組或多組人羣之間，不同的特徵導致的死亡時間的差異大小的估計: 某種新療法對於同時被診斷爲相同程度肺癌的患者，和標準療法相比是否能有效延長其生存時間？</li>
<li>研究多種變量 (例如體重，年齡，性別，吸煙，飲食等) 和事件發生時間長短之間的關系: 例如收集健康對象，研究其體質指數 (BMI) 和最終發生二型糖尿病幾率之間的關系，同時要調整其他已知的混雜因素。</li>
<li>預測特定患者的存活幾率: 肝癌患者診斷後的 5 年生存率，10 年生存率的推算。</li>
</ol>
</div>
<div id="生存數據在哪裏" class="section level2">
<h2><span class="header-section-number">71.2</span> 生存數據在哪裏</h2>
<p>生存數據其實很常見，下面是幾個例子:</p>
<ol style="list-style-type: decimal">
<li>特定國家特定時間內對人口出生死亡的登記數據;</li>
<li>在隨機雙盲對照臨牀試驗中，治療組和安慰劑組相比，治療組的生存時間是否真的較長;</li>
<li>前瞻性隊列研究;</li>
<li>非醫學的例子也有很多，例如分析暴風雪降臨之前的時間，或者推測地震可能發生的幾率。</li>
</ol>
</div>
<div id="生存數據分析之前要理清楚的問題" class="section level2">
<h2><span class="header-section-number">71.3</span> 生存數據分析之前要理清楚的問題</h2>
<ol style="list-style-type: decimal">
<li>對於結果/事件的定義;</li>
<li>研究的時間起點;</li>
<li>研究的時間單位是用的月份，周，還是年，是觀察時間，還是患者的實際年齡 (實際年齡就是實際生存時間);</li>
<li>事件發生時的時間，是否被精確定義了？</li>
</ol>
</div>
<div id="生存數據的左右截尾" class="section level2">
<h2><span class="header-section-number">71.4</span> 生存數據的左右截尾</h2>
<p>沒有哪個研究能保證觀察隨訪到所有的研究對象最終是否發生了事件 (死亡)，有些對象在研究中途就會退出實驗。所以這些沒有觀察到事件發生，但是在研究的過程中貢獻了生存時間數據的對象，被稱爲刪失數據 (censored)。刪失數據又根據其發生原因的不同被分爲下面幾種:</p>
<ol style="list-style-type: decimal">
<li><strong>行政刪失 (administrative censoring)</strong>: 如果最終事件，被定義爲死亡的話，研究者不大可能等到所有的觀察對象都死亡 (可能耗時幾十年) 之後再分析數據，而是認爲地定義某個時間點作爲研究結束，不再隨訪的時間。</li>
<li><strong>隨訪失敗 (loss to follow-up)</strong>: 無論是幹預型實驗，還是觀察性實驗，有些觀察對象中途無法聯系上，或者改變主義推出實驗的人並不少見。這些對象的出現都意味着研究者無法再對他們進行事件發生與否的觀察了。</li>
<li><strong>死於其他原因 (death from other causes)</strong>: 可能某些研究只關心患者吸煙習慣與死於肺癌的時間長短的關系，當某些觀察對象確實發生了死亡事件，但是死因並不是肺癌時 (肝癌，或者自殺，車禍等)，這些人也被認爲是刪失數據。</li>
</ol>
<p>上述幾種可能發生的刪失數據，這幾種類型的刪失數據，被叫做<strong>右側刪失數據 (right censoring)，在分析中不能被刪除，因爲他們在未離開研究之前，我們確定他們是沒有發生事件的，他們的觀察時間也應當被放入統計模型中加以考慮。</strong></p>
<div id="左側截尾數據-left-truncation" class="section level3">
<h3><span class="header-section-number">71.4.1</span> 左側截尾數據 left-truncation</h3>
<p>左側截尾現象，又被叫做<strong>延時進入 (delayed entry)</strong>: 由於觀察對象實際進入研究時的年齡各不相同，對所有人的觀察時間，都從出生日開始算起的研究，實施難度極大。此時，應當注意把進入研究之前的生存時間 (進入實驗時的年齡)，考慮進來，因爲這些人至少活到了進入研究的年齡。這也是一種生存偏倚現象，因爲人羣中被觀察到的人，只是一小部分樣本，所以把所有人都當作相同概率進入研究是不恰當的，有許多對象沒有活到進入研究的時間。</p>
</div>
</div>
<div id="初步分析生存數據" class="section level2">
<h2><span class="header-section-number">71.5</span> 初步分析生存數據</h2>
<p>生存數據，比較的是生存時間。由於時間本身是連續型變量，我們可能會想到利用處理連續型變量時的方法來進行初步的比較:</p>
<ol style="list-style-type: decimal">
<li>每個人生存時間的柱狀圖 (histogram);</li>
<li>計算生存時間的簡單統計量: 中位數 (median)。</li>
</ol>
<p>即使是拿穩健統計學方法比較治療組和對照組的中位數是否不同，也無法解決刪失數據的問題。我們需要新的方法來處理生存數據。</p>
</div>
<div id="初步描述生存數據" class="section level2">
<h2><span class="header-section-number">71.6</span> 初步描述生存數據</h2>
<p>描述生存數據的統計學正式方案是:</p>
<ol style="list-style-type: decimal">
<li>生存方程 the survival function</li>
<li>風險度方程和累積風險度 the hazard function and the cumulative hazard</li>
<li>概率密度方程 the probability density function</li>
</ol>
<div id="生存方程" class="section level3">
<h3><span class="header-section-number">71.6.1</span> 生存方程</h3>
<p>生存方程的定義是，觀測生存時間 <span class="math inline">\(T\)</span>，大於某個時間 <span class="math inline">\(t\)</span> 的概率:</p>
<p><span class="math display">\[
S(t) = \text{Pr}(T &gt; t)
\]</span></p>
<p>累計概率方程是</p>
<p><span class="math display">\[
F(t) = \text{Pr}(T \leqslant t) = 1 - S(t)
\]</span></p>
</div>
<div id="風險度方程" class="section level3">
<h3><span class="header-section-number">71.6.2</span> 風險度方程</h3>
<p>風險度有時候就只叫做風險 (hazard)，時間 <span class="math inline">\(t\)</span> 時的風險度爲 <span class="math inline">\(h(t)\)</span>。風險度方程被定義爲:</p>
<p><span class="math display">\[
h(t) = \lim_{\delta\rightarrow0}\frac{1}{\delta}\text{Pr}(t\leqslant T &lt; t + \delta | T\geqslant t)
\]</span></p>
<p>風險度利用的是數學中的極限理論，表示在時間 <span class="math inline">\(t\)</span> 和時間 <span class="math inline">\(t+\delta\)</span> (其中<span class="math inline">\(\delta \rightarrow 0\)</span>) 之間，觀察對象沒有發生事件的概率。風險度的概念明白了以後，風險度在時間軸上的積分，就被叫做<strong>累積風險度</strong>:</p>
<p><span class="math display">\[
H(t) = \int_0^th(u)\text{d}u
\]</span></p>
</div>
<div id="概率密度方程" class="section level3">
<h3><span class="header-section-number">71.6.3</span> 概率密度方程</h3>
<p>和其他的方程類似，常用 <span class="math inline">\(f(t)\)</span> 標記生存時間的概率密度方程:</p>
<p><span class="math display">\[
f(t) = \frac{\text{d}}{\text{d}t}F(t) = \lim_{\delta\rightarrow0}\frac{1}{\delta}\text{Pr}(t\leqslant T &lt; t + \delta)
\]</span></p>
</div>
<div id="各方程之間的關系" class="section level3">
<h3><span class="header-section-number">71.6.4</span> 各方程之間的關系</h3>
<p><span class="math display">\[
\begin{aligned}
f(t) &amp; = \frac{\text{d}}{\text{d}t}F(t)  = \frac{\text{d}}{\text{d}t}\{ 1-S(t) \} = - \frac{\text{d}}{\text{d}t}S(t) \\
S(t) &amp; = 1 - F(t)  = 1 - \int_0^t f(u)\text{d}u = \int_t^\infty f(u)\text{d}u \\
h(t) &amp; = \lim_{\delta\rightarrow0}\frac{1}{\delta}\text{Pr}(t \leqslant T &lt; t+ \delta | T &gt; t) \\
     &amp; = \lim_{\delta\rightarrow0}\frac{1}{\delta}\frac{\text{Pr}(t \leqslant T &lt; t+ \delta, T &gt; t)}{\text{Pr}(T &gt; t)} (\text{Bayes&#39; Theroem}) \\
     &amp; = \lim_{\delta\rightarrow0}\frac{1}{\delta}\frac{\text{Pr}(t \leqslant T &lt; t+ \delta)}{\text{Pr}(T &gt; t)} \\
     &amp; = \frac{f(t)}{S(t)} \\
h(t) &amp; = \frac{f(t)}{S(t)} = \frac{\frac{\text{d}}{\text{d}t}F(t)}{S(t)} = \frac{- \frac{\text{d}}{\text{d}t}S(t)}{S(t)} = - \frac{\text{d}}{\text{d}t}\text{log}[S(t)] \\
\end{aligned}
\]</span></p>
<p><strong>推導</strong> <span class="math inline">\(S(t), H(t)\)</span> 之間的關系:</p>
<p><span class="math display">\[
\begin{aligned}
\because h(t) &amp; = - \frac{\text{d}}{\text{d}t}\text{log}[S(t)] \\
\text{intergrate both} &amp; \text{ sides over the range from 0 to }t: \\
\int_0^th(u)\text{d}u &amp; = - \int_0^t\frac{\text{d}}{\text{d}u}\text{log}[S(t)]\text{d}u \\
                      &amp; = -[\text{log } S(u)]_{u = 0}^{u = t} \\
                      &amp; = -[\text{log } S(t) - \text{log } S(0)] \\
                      &amp; = -\text{log }S(t) \\
\Rightarrow S(t)      &amp; = \exp\{ - \int_0^th(u)\text{d}u\} = \exp\{ -H(t) \}
\end{aligned}
\]</span></p>
</div>
</div>
<div id="生存時間的參數分布" class="section level2">
<h2><span class="header-section-number">71.7</span> 生存時間的參數分布</h2>
<div id="指數分布" class="section level3">
<h3><span class="header-section-number">71.7.1</span> 指數分布</h3>
<p>適用於生存時間最簡單的分布是指數分布 (exponentiential distribution)。指數分布默認風險率 (hazard rate，<span class="math inline">\(\lambda\)</span>) 不隨時間變化。在指數分布中，風險度方程，生存方程和概率密度方程分別是:</p>
<p><span class="math display" id="eq:survival01-11">\[
\begin{aligned}
h(t) &amp; = \lambda, \\
S(t) &amp; = e^{-\lambda t} \\
f(t) &amp; = h(t)S(t) \\
     &amp; = \lambda e^{-\lambda t}
\end{aligned}
\tag{71.1}
\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:Surv-fig1-4"></span>
<img src="img/Selection_117.png" alt="The hazard function, survivor function and probability density function under an exponential distribution for survival times" width="90%" />
<p class="caption">
圖 71.1: The hazard function, survivor function and probability density function under an exponential distribution for survival times
</p>
</div>
</div>
<div id="weibull-分布" class="section level3">
<h3><span class="header-section-number">71.7.2</span> Weibull 分布</h3>
<p>指數分布的前提 – 事件發生率相同的假設過於強硬，許多真實數據，都不能滿足這個前提條件。另一個比指數分布靈活的分布是 Weibull 分布。它包含兩個參數，其風險度方程，生存方程和概率密度方程分別是:</p>
<p><span class="math display" id="eq:survival01-12">\[
\begin{aligned}
h(t) &amp; = \kappa\lambda t^{\kappa - 1}  \\
S(t) &amp; = \exp(-\lambda t^\kappa) \\
f(t) &amp; = \kappa \lambda t^{\kappa - 1} \exp(-\lambda t^\kappa)
\end{aligned}
\tag{71.2}
\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:Surv-fig1-6"></span>
<img src="img/Selection_118.png" alt="Illustrations of the hazard function under a Weibull distribution with different shape (kappa) and scale (lambda)." width="90%" />
<p class="caption">
圖 71.2: Illustrations of the hazard function under a Weibull distribution with different shape (kappa) and scale (lambda).
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:Surv-fig1-7"></span>
<img src="img/Selection_119.png" alt="Illustrations of the survival function and probability function under a Weibull distribution with different shape (kappa) and scale parameter lambda = 0.2." width="90%" />
<p class="caption">
圖 71.3: Illustrations of the survival function and probability function under a Weibull distribution with different shape (kappa) and scale parameter lambda = 0.2.
</p>
</div>
<p>當 <span class="math inline">\(\kappa = 1\)</span> 時，Weibull 分布就降級爲簡單指數分布。從圖中也可以看出，<strong>Weibull 分布只允許風險度隨着時間單調遞增/遞減</strong>。</p>
<p>除了這兩個常見的生存時間分布，另外還有許多不同類型的分布。練習題中也會再探索 log-logistic 分布的應用。</p>
</div>
</div>
<div id="極大似然法估計" class="section level2">
<h2><span class="header-section-number">71.8</span> 極大似然法估計</h2>
<p>假設，我們決定使用上面描述的簡單分布 - 指數分布來做爲生存時間的分布。接下來，就可以利用學習過的統計推斷的知識，對其做極大似然估計。</p>
<p>假設 <span class="math inline">\(n\)</span> 名研究對象編號各自爲 <span class="math inline">\(i = 1, \cdots,n\)</span>，研究者對他們完成了從起點時間 (time origin) 起的隨訪。有些人發生了相關事件 (Event)，所以，他們的生存時間 <span class="math inline">\(t_{E_i}\)</span>。有些人則由於各種原因變成了刪失值，他們的生存時間是 <span class="math inline">\(t_{C_i}\)</span>。關於刪失對象我們確切知道在時間 <span class="math inline">\(t_{C_i}\)</span> 之內，他們沒有發生相關事件，且他們退出研究之後是否發生了事件不得而知。我們再根據觀察對象是否發生相關事件，在模型中生成一個啞變量 <span class="math inline">\(\delta_i\)</span>，當 <span class="math inline">\(\delta_i = 1\)</span> 時，該對象的觀察生存時間是 <span class="math inline">\(t_{E_i}\)</span>，當 <span class="math inline">\(\delta_i = 0\)</span> 時，該對象的觀察生存時間就是 <span class="math inline">\(t_{C_i}\)</span>:</p>
<p><span class="math display">\[
\delta_{i}=\left\{ \begin{array}{ll}
1 \text{ if } t_{E_i} \text{ observed} \\
0 \text{ if }  t_{C_i} \text{ observed}\\ \end{array} \right.
t_{i}=\left\{ \begin{array}{ll}
t_{E_i} \text{ if } \delta_i = 1 \\
t_{C_i} \text{ if } \delta_i = 0 \\ \end{array} \right.
\]</span></p>
<table class="table table-striped table-bordered" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
表 71.1: Data on survival and censoring times for n individuals
</caption>
<thead>
<tr>
<th style="text-align:left;">
Individual
</th>
<th style="text-align:left;">
Survival or censoring time
</th>
<th style="text-align:left;">
Indicator of outcome or censoring
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(t_1\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\delta_1\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(t_2\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\delta_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(3\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(t_3\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\delta_3\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(n\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(t_n\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\delta_n\)</span>
</td>
</tr>
</tbody>
</table>
<p>對於那些觀察到事件的人，他們各自對似然的貢獻是 <span class="math inline">\(f(t_{E_i})\)</span>; 對於那些成爲刪失值的人，他們各自對似然的貢獻是 <span class="math inline">\(S(t_{C_i})\)</span>，所以該數據的似然就是:</p>
<p><span class="math display">\[
\begin{aligned}
L &amp; = \prod_{\text{Events}}f(t_{E_i})\prod_{\text{Censorings}}S(t_{C_i}) \\
  &amp; = \prod_i f(t_i)^{\delta_i} S(t_i)^{1-\delta_i} \\
  &amp; = \prod_i \{ h(t_i)S(t_i) \}^{\delta_i}S(t_i)^{1-\delta_i} \text{ because } h(t) = \frac{f(t)}{S(t)} \\
  &amp; = \prod_i h(t_i)^{\delta_i} S(t_i)
\end{aligned}
\]</span></p>
<p>極大似然法對各個參數的估計就可以用我們在統計推斷中使用的求對數極大似然的方法:</p>
<p><span class="math display">\[
\begin{aligned}
\ell &amp; = \sum_i[\delta_i\text{log}f(t_i) + (1-\delta_i)\text{log}S(t_i)] \\
     &amp; = \sum_i\{\delta_i\text{log}(\lambda e^{-\lambda t_i}) + (1-\delta_i)\text{log}(e^{-\lambda t_i}) \} \\
     &amp; = \sum_i\{ \delta_i\text{log}\lambda - \delta_i\lambda t_i -\lambda t_i + \delta_i\lambda t_i \} \\
     &amp; = \sum_i[\delta_i \text{log}\lambda - \lambda t_i] \\
     &amp; = \sum_i\delta_i\text{log}\lambda - \lambda\sum_it_i \\
\Rightarrow \ell^\prime &amp; = \frac{\sum_i\delta_i}{\lambda} - \sum_i t_i \\
\text{let } \ell^\prime &amp; =0 \Rightarrow \hat\lambda = \frac{\sum_i\delta_i}{\sum_i t_i}\\
\text{Because }\ell^{\prime\prime} &amp; = -\frac{\sum_i\delta_i}{\lambda^2} &lt; 0 \\
\text{Therefore } \hat\lambda &amp; = \frac{\sum_i\delta_i}{\sum_it_i} \\
\text{ is the MLE for} &amp; \text{  survival time follows exponential distribution.}
\end{aligned}
\]</span></p>
</div>
<div id="practical-survival-01" class="section level2">
<h2><span class="header-section-number">71.9</span> Practical Survival 01</h2>
<div id="生存分析的時間尺度" class="section level3">
<h3><span class="header-section-number">71.9.1</span> 生存分析的時間尺度</h3>
<div id="把-pbc-數據讀入-r-中d-time-datein-dateout-是什麼含義" class="section level4">
<h4><span class="header-section-number">71.9.1.1</span> 把 PBC 數據讀入 R 中，<code>d, time, datein, dateout</code> 是什麼含義？</h4>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1023-1" title="1">pbcbase &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/pbcbase.dta&quot;</span>)</a>
<a class="sourceLine" id="cb1023-2" title="2"><span class="co"># d 是表示是否發神事件的變量</span></a>
<a class="sourceLine" id="cb1023-3" title="3"><span class="co"># d = 0 表示該觀察對象是刪失值</span></a>
<a class="sourceLine" id="cb1023-4" title="4"><span class="co"># d = 1 表示該觀察對象在研究隨訪中死亡</span></a>
<a class="sourceLine" id="cb1023-5" title="5"></a>
<a class="sourceLine" id="cb1023-6" title="6"><span class="co"># datein 是該觀察對象進入臨牀試驗的日期</span></a>
<a class="sourceLine" id="cb1023-7" title="7"><span class="co"># dateout 是該觀察對象發生死亡事件/變成刪失值的日期</span></a>
<a class="sourceLine" id="cb1023-8" title="8"></a>
<a class="sourceLine" id="cb1023-9" title="9"><span class="co"># time 是從進入臨牀試驗到發生死亡時間或者變成刪失值這段時間的長度，以年爲單位</span></a>
<a class="sourceLine" id="cb1023-10" title="10"></a>
<a class="sourceLine" id="cb1023-11" title="11"><span class="kw">head</span>(pbcbase[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##      id datein     dateout     time     d
##   &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1     5 1980-02-19 1981-09-19  1.58     1
## 2    22 1980-08-22 1980-08-22  0        0
## 3    23 1980-07-22 1989-08-02  9.03     0
## 4    40 1980-08-08 1982-11-21  2.29     1
## 5    42 1980-09-06 1982-10-05  2.08     1
## 6    45 1980-02-09 1985-06-02  5.31     1</code></pre>
</div>
<div id="你認爲該研究應該使用哪種時間尺度" class="section level4">
<h4><span class="header-section-number">71.9.1.2</span> 你認爲該研究應該使用哪種時間尺度？</h4>
<p>這是一個比較兩種治療方案哪個更能延長患者生命時間的臨牀實驗，正確的時間尺度應該是從進入試驗開始，直至發生事件 (死亡) 或者離開試驗的這段時間 (隨訪時間 follow-up time)。</p>
</div>
<div id="試驗中多少患者發生了死亡事件又有多少患者是刪失值" class="section level4">
<h4><span class="header-section-number">71.9.1.3</span> 試驗中，多少患者發生了死亡事件，又有多少患者是刪失值？</h4>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1025-1" title="1"><span class="co"># 患者中 96 人 (50.3%) 發生了死亡事件; 95 人是刪失值。</span></a>
<a class="sourceLine" id="cb1025-2" title="2"><span class="kw">with</span>(pbcbase, <span class="kw">tab1</span>(d, <span class="dt">graph =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>## d : 
##         Frequency Percent Cum. percent
## 0              95    49.7         49.7
## 1              96    50.3        100.0
##   Total       191   100.0        100.0</code></pre>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1027-1" title="1"><span class="co"># 第一例死亡發生在隨訪開始的 0.025 年，最後一例死亡發生在隨訪開始的 9.26 年;</span></a>
<a class="sourceLine" id="cb1027-2" title="2"><span class="co"># 所有對象中隨訪時間最長達到 11.64 年。</span></a>
<a class="sourceLine" id="cb1027-3" title="3"><span class="co"># 死亡事件發生的病例中，隨訪時間的中位數是 2.85 年</span></a>
<a class="sourceLine" id="cb1027-4" title="4"><span class="co"># 刪失對象的病例中，隨訪時間的中位數是 4.62 年。</span></a>
<a class="sourceLine" id="cb1027-5" title="5"><span class="kw">with</span>(pbcbase, <span class="kw">summ</span>(time[d<span class="op">==</span><span class="dv">1</span>], <span class="dt">graph =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  96   3.243  2.847   2.357  0.025  9.259</code></pre>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1029-1" title="1"><span class="kw">with</span>(pbcbase, <span class="kw">summ</span>(time[d<span class="op">==</span><span class="dv">0</span>], <span class="dt">graph =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  95   4.587  4.616   3.052  0      11.644</code></pre>
</div>
<div id="讀入另一個數據-whitehall.csv使用是否發生冠心病-chd-變量作爲事件變量仔細觀察其時間的格式timein-timeout-timebth各自是什麼含義1987-年-1-月-30-日發生了什麼事件" class="section level4">
<h4><span class="header-section-number">71.9.1.4</span> 讀入另一個數據 <code>whitehall.csv</code>，使用是否發生冠心病 <code>chd</code> 變量作爲事件變量。仔細觀察其時間的格式，<code>timein, timeout, timebth</code>，各自是什麼含義？1987 年 1 月 30 日發生了什麼事件？</h4>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1031-1" title="1">whitehall &lt;-<span class="st">  </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/whitehall.dta&quot;</span>)</a>
<a class="sourceLine" id="cb1031-2" title="2"><span class="co"># timebth 是每個患者的出生日期</span></a>
<a class="sourceLine" id="cb1031-3" title="3"><span class="co"># timein  是每個患者進入試驗的日期，且注意到許多患者的進入試驗日期是相同的</span></a>
<a class="sourceLine" id="cb1031-4" title="4"><span class="co"># timeout 是隨訪結束的日期，對於 chd = 1 的人，這個日期是其死於冠心病的日期，</span></a>
<a class="sourceLine" id="cb1031-5" title="5"><span class="co"># 其餘的人則是刪失日期，且注意到許多刪失日期都是1987年1月30日，推測這是行政刪失日期。</span></a>
<a class="sourceLine" id="cb1031-6" title="6">whitehall[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">12</span><span class="op">:</span><span class="dv">14</span>)]</a></code></pre></div>
<pre><code>## # A tibble: 1,677 x 5
##       id   chd timein     timeout    timebth   
##    &lt;dbl&gt; &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;     &lt;date&gt;    
##  1  5001     0 1967-09-13 1987-01-30 1920-03-20
##  2  5019     0 1967-09-13 1987-01-30 1911-08-06
##  3  5038     0 1967-09-13 1987-01-30 1916-04-03
##  4  5039     0 1967-09-13 1987-01-30 1916-08-02
##  5  5042     0 1967-09-13 1983-04-12 1912-03-20
##  6  5052     0 1967-09-13 1984-07-10 1913-04-07
##  7  5064     0 1967-09-15 1984-05-13 1921-04-30
##  8  5078     1 1967-09-15 1983-11-29 1919-12-25
##  9  5089     0 1967-09-15 1987-01-30 1919-10-11
## 10  5090     0 1967-09-15 1987-01-30 1908-03-31
## # ... with 1,667 more rows</code></pre>
</div>
<div id="應該使用哪種時間尺度作爲此研究的時間呢" class="section level4">
<h4><span class="header-section-number">71.9.1.5</span> 應該使用哪種時間尺度作爲此研究的時間呢？</h4>
<p>很顯然，本實驗可以使用隨訪時間，作爲時間尺度。當然，考慮到不同的人進入實驗時的年齡不同，也可以用隨訪年齡作爲時間尺度。需要注意的是，如果使用年齡作爲時間尺度，不能使用 <code>timeout - timebth</code> 也就是隨訪結束減去出生日期作爲時間變量。因爲這樣的做法默認了所有人從出生時，就進入了實驗，這是無論如何也無法做到的。所以我們要用下面的第二個計算時間的代碼 <code>M1</code>，來考慮進入實驗時的年齡。因爲，進入實驗時，該觀察對象沒有發生事件，這已經是一個生存偏倚，需要告訴軟件加以考慮。注意比較三種方法計算的時間的最小值最大值的差別。</p>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1033-1" title="1"><span class="co"># 用隨訪時間做時間尺度</span></a>
<a class="sourceLine" id="cb1033-2" title="2">M0 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(<span class="dt">time =</span> (timeout <span class="op">-</span><span class="st"> </span>timein)<span class="op">/</span><span class="fl">365.25</span>, <span class="dt">event =</span> chd)<span class="op">~</span><span class="dv">1</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1033-3" title="3"><span class="kw">summ</span>(M0<span class="op">$</span>time, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  702  13.96  16.678  5.307  0.151  19.381</code></pre>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1035-1" title="1"><span class="co"># 考慮了左側截尾的時間尺度</span></a>
<a class="sourceLine" id="cb1035-2" title="2">M1 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(agein, agein <span class="op">+</span><span class="st"> </span>(timeout <span class="op">-</span><span class="st"> </span>timein)<span class="op">/</span><span class="fl">365.25</span>, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1035-3" title="3"><span class="kw">summ</span>(M1<span class="op">$</span>time, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  1670 68.568 67.888  6.582  44.391 85.766</code></pre>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1037-1" title="1"><span class="co"># 錯誤地認爲所有人都從出生日期開始進入試驗的時間尺度</span></a>
<a class="sourceLine" id="cb1037-2" title="2">M2 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>((timeout <span class="op">-</span><span class="st"> </span>timebth)<span class="op">/</span><span class="fl">365.25</span>, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1037-3" title="3"><span class="kw">summ</span>(M2<span class="op">$</span>time, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  1563 68.638 67.986  6.651  44.391 85.766</code></pre>
</div>
</div>
<div id="擬合最簡單的指數分布生存數據" class="section level3">
<h3><span class="header-section-number">71.9.2</span> 擬合最簡單的指數分布生存數據</h3>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1039-1" title="1">mydata &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;backupfiles/surv_data_practical1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1039-2" title="2">mydata</a></code></pre></div>
<pre><code>## # A tibble: 100 x 1
##    surv.times
##         &lt;dbl&gt;
##  1      0.442
##  2      2.01 
##  3      2.26 
##  4      1.64 
##  5      9.88 
##  6      1.19 
##  7      3.72 
##  8      7.14 
##  9     11.3  
## 10      6.69 
## # ... with 90 more rows</code></pre>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1041-1" title="1">exp.model &lt;-<span class="st"> </span><span class="kw">survreg</span>(<span class="kw">Surv</span>(surv.times) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">dist =</span> <span class="st">&quot;exponential&quot;</span>, <span class="dt">data =</span> mydata)</a>
<a class="sourceLine" id="cb1041-2" title="2"><span class="co"># 值得注意的是，在 R 裏擬合指數分布的生存數據時，計算獲得的是 -log(lambda)</span></a>
<a class="sourceLine" id="cb1041-3" title="3"><span class="kw">summary</span>(exp.model)</a></code></pre></div>
<pre><code>## 
## Call:
## survreg(formula = Surv(surv.times) ~ 1, data = mydata, dist = &quot;exponential&quot;)
##             Value Std. Error     z      p
## (Intercept) 1.527      0.100 15.27 &lt;2e-16
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= -252.7   Loglik(intercept only)= -252.7
## Number of Newton-Raphson Iterations: 5 
## n= 100</code></pre>
<div class="sourceCode" id="cb1043"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1043-1" title="1"><span class="co"># 風險度比 HR</span></a>
<a class="sourceLine" id="cb1043-2" title="2"><span class="kw">exp</span>(<span class="op">-</span>exp.model<span class="op">$</span>coefficients)</a></code></pre></div>
<pre><code>## (Intercept) 
##  0.21727013</code></pre>
<div class="sourceCode" id="cb1045"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1045-1" title="1"><span class="co"># HR 的 95% 信賴區間</span></a>
<a class="sourceLine" id="cb1045-2" title="2"><span class="kw">exp</span>(<span class="op">-</span>exp.model<span class="op">$</span>coefficients <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="kw">summary</span>(exp.model)<span class="op">$</span>table[<span class="dv">2</span>])</a></code></pre></div>
<pre><code>## (Intercept) 
##   0.1785987</code></pre>
<div class="sourceCode" id="cb1047"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1047-1" title="1"><span class="kw">exp</span>(<span class="op">-</span>exp.model<span class="op">$</span>coefficients <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="kw">summary</span>(exp.model)<span class="op">$</span>table[<span class="dv">2</span>])</a></code></pre></div>
<pre><code>## (Intercept) 
##  0.26431495</code></pre>
</div>
<div id="探索服從-weibull-分布時風險度方程的曲線" class="section level3">
<h3><span class="header-section-number">71.9.3</span> 探索服從 Weibull 分布時風險度方程的曲線</h3>
<div class="sourceCode" id="cb1049"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1049-1" title="1">wei.haz &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda, kappa) {</a>
<a class="sourceLine" id="cb1049-2" title="2">  kappa<span class="op">*</span>lambda<span class="op">*</span>x<span class="op">^</span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1049-3" title="3">}</a>
<a class="sourceLine" id="cb1049-4" title="4"><span class="kw">curve</span>(<span class="kw">wei.haz</span>(x, <span class="fl">0.2</span>, <span class="fl">0.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>), <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Hazard function&quot;</span>)</a>
<a class="sourceLine" id="cb1049-5" title="5"><span class="kw">curve</span>(<span class="kw">wei.haz</span>(x, <span class="fl">0.2</span>, <span class="fl">1.5</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb1049-6" title="6"><span class="kw">curve</span>(<span class="kw">wei.haz</span>(x, <span class="fl">0.2</span>, <span class="dv">1</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1049-7" title="7"><span class="kw">curve</span>(<span class="kw">wei.haz</span>(x, <span class="fl">0.2</span>, <span class="dv">2</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb1049-8" title="8"><span class="kw">curve</span>(<span class="kw">wei.haz</span>(x, <span class="fl">0.2</span>, <span class="dv">5</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:SurvPrac01-06"></span>
<img src="bookdown_files/figure-html/SurvPrac01-06-1.png" alt="Illustrations of the hazard function under a Weibull distribution with lambda = 0.2, and different shape (kappa)" width="80%" />
<p class="caption">
圖 71.4: Illustrations of the hazard function under a Weibull distribution with lambda = 0.2, and different shape (kappa)
</p>
</div>
<p>在 Weibull 分布下，參數 <span class="math inline">\(\kappa\)</span> 決定了風險度曲線的形狀。 <span class="math inline">\(\kappa &lt; 1\)</span> 時，風險度隨着時間下降，<span class="math inline">\(\kappa &gt; 1\)</span> 時，風險度隨着時間上升。當 <span class="math inline">\(\kappa = 1\)</span> 時，Weibull 分布降級爲簡單的指數分布 (圖中點狀直線)。當 <span class="math inline">\(\kappa = 2\)</span> 時，風險度和時間成線性關系。</p>
</div>
<div id="探索-對數邏輯-log-logistic-分布時風險度方程曲線會有哪些特性" class="section level3">
<h3><span class="header-section-number">71.9.4</span> 探索 對數邏輯 (log-logistic) 分布時，風險度方程曲線會有哪些特性？</h3>
<p><span class="math display">\[
h(t) = \frac{e^\theta \kappa t^{\kappa -1}}{1 + e^\theta t^\kappa}
\]</span></p>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1050-1" title="1">loglog.haz &lt;-<span class="st"> </span><span class="cf">function</span>(x, theta, kappa) {</a>
<a class="sourceLine" id="cb1050-2" title="2">  <span class="kw">exp</span>(theta)<span class="op">*</span>kappa<span class="op">*</span>x<span class="op">^</span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(theta)<span class="op">*</span>x<span class="op">^</span>kappa)</a>
<a class="sourceLine" id="cb1050-3" title="3">}</a>
<a class="sourceLine" id="cb1050-4" title="4"></a>
<a class="sourceLine" id="cb1050-5" title="5"><span class="kw">curve</span>(<span class="kw">loglog.haz</span>(x, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>), <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Hazard function&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb1050-6" title="6"><span class="kw">curve</span>(<span class="kw">loglog.haz</span>(x, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">add =</span> T, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb1050-7" title="7"><span class="kw">curve</span>(<span class="kw">loglog.haz</span>(x, <span class="dv">3</span>, <span class="dv">2</span>), <span class="dt">add =</span> T, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:SurvPrac01-07"></span>
<img src="bookdown_files/figure-html/SurvPrac01-07-1.png" alt="Illustrations of the hazard function under a log-logistic distribution with different theta, and different shape (kappa)" width="80%" />
<p class="caption">
圖 71.5: Illustrations of the hazard function under a log-logistic distribution with different theta, and different shape (kappa)
</p>
</div>
<p>在 Weibull 分布下，風險度只能隨着時間單調遞增或者遞減。但是，在對數邏輯分布下，風險度就可以跟隨時間有增有減。</p>
</div>
</div>
</div>
<div id="nonparametric" class="section level1">
<h1><span class="header-section-number">第 72 章</span> 非參數法分析生存數據</h1>
<div id="生存分析中的非參數分析法" class="section level2">
<h2><span class="header-section-number">72.1</span> 生存分析中的非參數分析法</h2>
<p>非參數法分析生存數據其實是所有人在分析生存數據時應該着手做的第一件事。</p>
<ul>
<li>非參數法可以對生存時間不必進行任何參數分布 (parametric assumption) 的假設，初步地估計生存方程和累積風險度方程;</li>
<li>使用非參數法可以用生存曲線圖的方式直觀地展示生存數據，包括刪失值在數據中的存在也可以通過圖表來表現出來;</li>
<li>非參數法可以初步地對不同組/羣之間生存曲線的變化進行比較;</li>
<li>通過非參數法對生存數據進行初步分析之後，可以對接下來的生存數據建模過程提供有參考價值的背景信息。</li>
</ul>
</div>
<div id="kaplan-meier-法分析生存方程" class="section level2">
<h2><span class="header-section-number">72.2</span> Kaplan-Meier 法分析生存方程</h2>
<div id="當數據中沒有刪失值" class="section level3">
<h3><span class="header-section-number">72.2.1</span> 當數據中沒有刪失值</h3>
<p>如果，研究對象裏的每個人都發生了事件，那麼研究對象裏的每個人身上都觀察到了生存時間，自然而然地特定時間 <span class="math inline">\(t\)</span> 時的生存方程是:</p>
<p><span class="math display">\[
\hat{S}(t) = \frac{\text{number of individuals with survival time} &gt; t}{\text{total number of individuals}}
\]</span></p>
<p>在每個觀察到事件的時間點 <span class="math inline">\(t_1 &lt; t_2 &lt; t_3 &lt; \cdots &lt; t_K\)</span>，我們可以計算該時間點的生存方程，然後假定兩個事件的時間點之間的生存概率保持不變，就可以繪制出一個階梯形狀的生存曲線。</p>
</div>
<div id="當數據中有刪失值" class="section level3">
<h3><span class="header-section-number">72.2.2</span> 當數據中有刪失值</h3>
<p>前一小節提到的非參數法繪制生存時間曲線的方法，其實完全可以拓展到含有刪失值的生存數據中。同樣地，用 <span class="math inline">\(t_1 &lt; t_2 &lt; t_3 &lt; \cdots &lt; t_K\)</span> 表示<strong>發生事件的觀察對象的生存時間</strong>。我們可以用以下的步驟來拓展生存時間曲線的繪制思路:</p>
<ol style="list-style-type: decimal">
<li>首先定義 <span class="math inline">\(h_j\)</span> 作爲時間 <span class="math inline">\(t_j\)</span> 時期的風險率 (hazard rate)，那麼每個發生事件的對象的風險和生存時間就有了各自的關聯 <span class="math inline">\(h_1, h_2, \cdots, h_k\)</span>;</li>
<li>在時間點 <span class="math inline">\(t_1\)</span> 時，隊列中的全部對象中，沒有發生事件的概率是 <span class="math inline">\(1-h_1\)</span>;</li>
<li>在時間點 <span class="math inline">\(t_2\)</span> 時，隊列中的全部對象中，在時間 <span class="math inline">\(t_1, t_2\)</span> 時都沒有發生事件的概率是 <span class="math inline">\((1-h_1)(1-h_2)\)</span>;</li>
<li>所以，生存方程就是，任何一個人，在任何一個時間點，在隊列中，且不發生事件的概率 <span class="math display">\[S(t_j) = \prod_{k=1}^j(1-h_k)\]</span></li>
</ol>
<p>此時，每個時間點風險度方程的無偏估計爲，該時間點中在隊列中發生事件的人數 <span class="math inline">\(d_j\)</span> 除以當時在隊列中的人數 <span class="math inline">\(n_j\)</span>:</p>
<p><span class="math display">\[
\hat h_j  = \frac{d_j}{n_j}
\]</span></p>
<p>用上面的這些初步結果，可以推導出在時間點 <span class="math inline">\(t_j\)</span> 時，隊列中的生存方程是:</p>
<p><span class="math display">\[
\hat S(t_j) = \prod_{k=1}^j (1-\hat h_k) = \prod_{k=1}^j ( 1- \frac{d_k}{n_k})
\]</span></p>
<p>它的更加一般化形式就是我們常常念叨的那個<strong>生存方程的 Kaplan-Meier 估計量</strong>，它的別名是 “the product limit estimate”:</p>
<p><span class="math display" id="eq:surv-2-6">\[
\begin{equation}
\hat S(t) = \prod_{j|t_j \leqslant t} (1 - \frac{d_j}{n_j})
\end{equation}
\tag{72.1}
\]</span></p>
<p><strong>例子:</strong> 下表羅列了某個白血病患者治療組生存數據的 Kaplan-Meier 生存方程估計和他們的計算過程，其中值得注意的是，如果生存表格中某時間點 (年或月或日，取決於你的研究使用的時間刻度) 同時有事件 (event) 和刪失 (censoring)，習慣上是默認刪失發生在事件發生之前:</p>
<table class="table table-striped table-bordered" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
表 72.1: Time to remission for leukaemia patients in the treatment group: Kaplan-Meier estimates of the survivor function
</caption>
<thead>
<tr>
<th style="text-align:left;">
Survival time <span class="math inline">\((t_j)\)</span> and censoring time
</th>
<th style="text-align:left;">
Number at risk
</th>
<th style="text-align:left;">
Number of events
</th>
<th style="text-align:left;">
Number of censorings
</th>
<th style="text-align:left;">
<span class="math inline">\(\hat{S}(t_j)\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
(1-3/21) = 0.857
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
(1-3/21)(1-1/17) = 0.807
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
(1-3/21)(1-1/17)(1-1/15) = 0.753
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.69
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.627
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.538
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0.448
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
</div>
</div>
<div id="kaplan-meier-數據的不確定性" class="section level2">
<h2><span class="header-section-number">72.3</span> Kaplan-Meier 數據的不確定性</h2>
<p><strong>Greenwood’s 公式的推導:</strong></p>
<p>如何推導獲得生存估計 <span class="math inline">\(\hat{S}(t_j)\)</span> 的方差呢？</p>
<p>利用方程 <a href="11-Survival-analysis.html#eq:surv-2-6">(72.1)</a> 的對數:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Var}\{ \text{log}\hat{S}(t) \} &amp; = \text{Var}\{ \text{log}\prod_{j|t_j \leqslant t} (1 - \hat{h}_j)\} \\
                                     &amp; = \text{Var}\{ \sum_{j|t_j \leqslant t} \text{log}(1-\hat{h}_j)\} \\
                                     &amp; = \sum_{j|t_j \leqslant t}\text{Var}\{ \text{log}(1-\hat{h}_j) \}
\end{aligned}
\]</span></p>
<p>接下來利用線性近似原則 (linear approximation)，也就是英国数学家<strong><a href="https://zh.wikipedia.org/wiki/%E6%B3%B0%E5%8B%92%E7%BA%A7%E6%95%B0">泰勒的一次近似泰勒展开法 (first order Taylor series approximation)</a>:</strong></p>
<p><span class="math display" id="eq:surv2-7">\[
\begin{equation}
\text{log} (1-\hat{h}_j) \approx \text{log}(1-h_j) + (\hat{h}_j - h_j)/(1-h_j)
\end{equation}
\tag{72.2}
\]</span></p>
<p>這個近似公式可以讓我們得到其方差爲:</p>
<p><span class="math display">\[
\text{Var}\{ \text{log}(1-\hat{h}_j) \} \approx \frac{\text{Var}(\hat{h}_j)}{(1-h_j)^2}
\]</span></p>
<p>这个就是大名鼎鼎的 <strong><a href="https://cran.r-project.org/web/packages/modmarg/vignettes/delta-method.html">Delta 法</a></strong>。</p>
<p>接下來需要推導風險 (hazard) <span class="math inline">\(\hat{h}_j\)</span> 的方差，注意，在時間 <span class="math inline">\(t_j\)</span> 時， 事件發生次數 <span class="math inline">\(d_j\)</span> 其實是服從如下的二項分布:</p>
<p><span class="math display">\[
d_j \sim \text{Binomial}(n_j, h_j)
\]</span></p>
<p>所以，</p>
<p><span class="math display">\[
\text{Var}(\hat{h}_j) = \frac{\text{Var}(d_j)}{n_j^2}
\]</span></p>
<p>根據伯努利分布  和二項分布  的性質:</p>
<p><span class="math display">\[
\text{Var}(\hat{h}_j) = \frac{\text{Var}(d_j)}{n_j^2} = \frac{n_jh_j(1-h_j)}{n_j^2} = \frac{h_j(1-h_j)}{n_j}
\]</span></p>
<p>綜上可得:</p>
<p><span class="math display">\[
\text{Var}\{ \text{log}(\hat{S}(t)) \} = \sum_{j|t_j \leqslant t}\frac{h_j}{n_j(1-h_j)}
\]</span></p>
<p>這裏再對 <span class="math inline">\(\log(\hat{S}(t))\)</span> 用一次線性近似:</p>
<p><span class="math display">\[
\log\hat{S}(t) \approx \log S(t) + \frac{\hat{S}(t) - S(t)}{S(t)}
\]</span></p>
<p>所以其實</p>
<p><span class="math display">\[
\text{Var}\{ \log (\hat{S}(t)) \} = \frac{\text{Var}\{ \hat{S}(t) \}}{S(t)^2}
\]</span></p>
<p>最終我們獲得 Greenwood’s 公式:</p>
<p><span class="math display" id="eq:surv2-14">\[
\begin{equation}
\text{Var}\{ \hat{S}(t) \} = \hat{S}(t)^2\sum_{j|t_j \leqslant t}\frac{h_j}{n_j(1-h_j)}
\end{equation}
\tag{72.3}
\]</span></p>
<p>獲得生存方程的方差以後，接下來就是 95% 信賴區間的推導:</p>
<p><span class="math display">\[
\hat{S}(t) \pm 1.96 \sqrt{\text{Var}\{ \hat{S}(t) \}}
\]</span></p>
<p>這裏獲得的 Kaplan-Meier 信賴區間是沒有錯的，但是在某些較爲極端的生存數據中 (時間接近 0, 或者時間接近追蹤結束)，這個公式可能導致計算獲得的信賴區間超過 <span class="math inline">\((0,1)\)</span>。因爲這裏我們假定的是生存概率近似服從正態分布時，才能使用的信賴區間公式。另一個改良版本的區間公式可以避免出現不正常的信賴區間。它需要對生存數據進行數學轉換。常用的生存數據的數學轉換是 <span class="math inline">\(\log\{-\log \hat{S}(t) \}\)</span>。利用上面推導 Greenwood’s 公式 @ref{eq:surv2-14} 時相似的過程，我們可以獲得該轉換過後的方差是:</p>
<p><span class="math display" id="eq:surv2-16">\[
\begin{equation}
\text{Var}\{ \log\{-\log \hat{S}(t)\} \} \approx \frac{\text{Var}\{\log\hat{S}(t) \}}{\{ \log S(t) \}^2}
\end{equation}
\tag{72.4}
\]</span></p>
<p>如果使用 <span class="math inline">\(v^2(t)\)</span> 來標記上式 @ref{eq:surv2-16} 時，有</p>
<p><span class="math display">\[
\begin{aligned}
\log\{- \log \hat{S}(t) \} - 1.96v(t) &amp; &lt; \log\{-\log S(t) \} &lt; \log\{- \log \hat{S}(t) \} + 1.96v(t) \\
\text{Taking the exponential:} &amp; \\
\{ -\log \hat{S}(t) \} \exp(-1.96v(t)) &amp; &lt; -\log S(t) &lt; \{ -\log \hat{S}(t) \} \exp(1.96v(t)) \\
\text{Multiply everything by } &amp; -1: \\
\{ \log \hat{S}(t) \} \exp(1.96v(t)) &amp; &lt; \log S(t) &lt; \{ \log \hat{S}(t) \} \exp(-1.96v(t)) \\
\text{Take the exponential again:} &amp; \\
\hat{S}(t)^{\exp(1.96v(t))} &amp; &lt; S(t) &lt; \hat{S}(t)^{\exp(-1.96v(t))}
\end{aligned}
\]</span></p>
<p>所以，這個校正版本的生存方程信賴區間公式就是:</p>
<p><span class="math display">\[\hat{S}(t)^{\exp\{ \mp1.96 v(t)\}}\]</span></p>
</div>
<div id="另一種非參數法分析-生命表格估計" class="section level2">
<h2><span class="header-section-number">72.4</span> 另一種非參數法分析 – 生命表格估計</h2>
<p>Kaplan-Meier 估計的生存方程過程中，我們假定的是觀察到事件的時間點是間斷的，也就是哪個事件發生在哪個時間點，是可以被精確觀察到的。然而，現實比較骨感的時候，你的數據可能只有生命表格，也就是常見的如一年內本市死亡人口多少多少人這樣，事件發生在某個時間區間內的類型數據。因爲此時無法特定每個死亡人口發生死亡時的確切時間日期。此時可以利用生命表格計算。</p>
<p>我們假定，某個隨訪時間可以被分爲許許多多的時間區間 <span class="math inline">\(I_1, I_2, \cdots, I_K\)</span>，且這些時間區間並不一定需要等距。另外，用 <span class="math inline">\(d_j\)</span> 表示在時間區間 <span class="math inline">\(I_j\)</span> 中發生的事件次數，在該時間段的開始時，有 <span class="math inline">\(n_j\)</span> 個觀察對象 (number of individuals at risk at the start of interval <span class="math inline">\(I_j\)</span>)，其中在下一段時間開始之前，有 <span class="math inline">\(m_j\)</span> 個刪失值。用這些數學標記來表示時間段 <span class="math inline">\(I_j\)</span> 中發生事件的概率 (前提是這 <span class="math inline">\(n_j\)</span> 個觀察對象在時間段 <span class="math inline">\(I_j\)</span> 開始前還沒有發生事件):</p>
<p><span class="math display">\[p_j = \frac{d_j}{n_j - m_j/2}\]</span></p>
<p>分母中使用了 <span class="math inline">\(m_j/2\)</span> 是由於我們無法確定事件發生和刪失值發生的時間在這個時間段 <span class="math inline">\(I_j\)</span> 中是如何分布的，所以我們只能假定他們平均的分布在時間段 <span class="math inline">\(I_j\)</span> 中點的兩側。如此，生命表法計算的生存方程公式就是:</p>
<p><span class="math display">\[
\hat{S}(t) = \prod_{k = 1}^j(1-p_k) \text{ for } t_j \leqslant t &lt; t_{j+1}
\]</span></p>
<p>你可以看出，生命表的推算生存方程，其實和 Kaplan-Meier 法很接近，你同樣可以使用 Greewood’s 的公式 (用 <span class="math inline">\(n_j - m_j/2\)</span> 替換掉 <span class="math inline">\(n_j\)</span> 即可) 獲取生命表生存方程的方差用於計算其信賴區間。</p>

<div class="example">
<span id="exm:11-Survival-analysis-1" class="example"><strong>Example 72.1  </strong></span>心絞痛患者死亡追蹤: 生命表格的制作例子 (選自 <span class="citation">(Belle et al. <a href="#ref-van2004biostatistics" role="doc-biblioref">2004</a>)</span>)。本例子中，2418 名男性心絞痛患者被收入研究中並追蹤其死亡結果，記錄數據中包括患者死亡的日期和患者離開研究的時間。下面的表格是追蹤前十年的數據:
</div>

<table class="table table-striped table-bordered" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
表 72.2: Men with angina: Numbers of deaths <span class="math inline">\((d_j)\)</span>, cencorings <span class="math inline">\((m_j)\)</span>, total numbers at risk <span class="math inline">\((n_j)\)</span>, and the life-table estimate of the survivor function by year.
</caption>
<thead>
<tr>
<th style="text-align:center;">
Year
</th>
<th style="text-align:center;">
<span class="math inline">\(n_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(d_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(m_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(p_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(1-p_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(\hat S(t)\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0-1
</td>
<td style="text-align:center;">
2418
</td>
<td style="text-align:center;">
456
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
456/2418 = 0.188
</td>
<td style="text-align:center;">
0.812
</td>
<td style="text-align:center;">
0.812
</td>
</tr>
<tr>
<td style="text-align:center;">
1-2
</td>
<td style="text-align:center;">
1962
</td>
<td style="text-align:center;">
226
</td>
<td style="text-align:center;">
39
</td>
<td style="text-align:center;">
226/(1962 - 39/2) = 0.116 </d0>
</td>
<td style="text-align:center;">
0.884
</td>
<td style="text-align:center;">
0.718
</td>
</tr>
<tr>
<td style="text-align:center;">
2-3
</td>
<td style="text-align:center;">
1697
</td>
<td style="text-align:center;">
152
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
152/(1697 - 22/2) = 0.090 </d0>
</td>
<td style="text-align:center;">
0.910
</td>
<td style="text-align:center;">
0.653
</td>
</tr>
<tr>
<td style="text-align:center;">
3-4
</td>
<td style="text-align:center;">
1523
</td>
<td style="text-align:center;">
171
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
171/(1523 - 23/2) = 0.113 </d0>
</td>
<td style="text-align:center;">
0.887
</td>
<td style="text-align:center;">
0.579
</td>
</tr>
<tr>
<td style="text-align:center;">
4-5
</td>
<td style="text-align:center;">
1329
</td>
<td style="text-align:center;">
135
</td>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
135/(1329 - 24/2) = 0.103 </d0>
</td>
<td style="text-align:center;">
0.897
</td>
<td style="text-align:center;">
0.519
</td>
</tr>
<tr>
<td style="text-align:center;">
5-6
</td>
<td style="text-align:center;">
1170
</td>
<td style="text-align:center;">
125
</td>
<td style="text-align:center;">
107
</td>
<td style="text-align:center;">
125/(1170 - 107/2) = 0.112 </d0>
</td>
<td style="text-align:center;">
0.888
</td>
<td style="text-align:center;">
0.461
</td>
</tr>
<tr>
<td style="text-align:center;">
6-7
</td>
<td style="text-align:center;">
938
</td>
<td style="text-align:center;">
83
</td>
<td style="text-align:center;">
133
</td>
<td style="text-align:center;">
83/(938 - 133/2) = 0.095 </d0>
</td>
<td style="text-align:center;">
0.905
</td>
<td style="text-align:center;">
0.417
</td>
</tr>
<tr>
<td style="text-align:center;">
7-8
</td>
<td style="text-align:center;">
722
</td>
<td style="text-align:center;">
74
</td>
<td style="text-align:center;">
102
</td>
<td style="text-align:center;">
74/(722 - 102/2) = 0.110 </d0>
</td>
<td style="text-align:center;">
0.890
</td>
<td style="text-align:center;">
0.371
</td>
</tr>
<tr>
<td style="text-align:center;">
8-9
</td>
<td style="text-align:center;">
546
</td>
<td style="text-align:center;">
51
</td>
<td style="text-align:center;">
68
</td>
<td style="text-align:center;">
51/(546 - 68/2) = 0.100 </d0>
</td>
<td style="text-align:center;">
0.900
</td>
<td style="text-align:center;">
0.334
</td>
</tr>
<tr>
<td style="text-align:center;">
9-10
</td>
<td style="text-align:center;">
427
</td>
<td style="text-align:center;">
42
</td>
<td style="text-align:center;">
64
</td>
<td style="text-align:center;">
42/(427 - 64/2) = 0.106 </d0>
</td>
<td style="text-align:center;">
0.894
</td>
<td style="text-align:center;">
0.299
</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span id="fig:SurvExample2-3"></span>
<img src="img/Selection_131.png" alt="Men with angina data: Life table estimate of the survivor function." width="90%" />
<p class="caption">
圖 72.1: Men with angina data: Life table estimate of the survivor function.
</p>
</div>
<p>看圖 <a href="11-Survival-analysis.html#fig:SurvExample2-3">72.1</a> 和上面估計的生存概率估計表格，請回答:</p>
<ol style="list-style-type: decimal">
<li>患者的 5 年以上生存概率是多少？ (51.9% 表格第五行)</li>
<li>患者的 2.5 年以上生存概率是多少？ (71.8% 記住在 2-3 年這段時間內生存概率被假定是不變的)</li>
</ol>
</div>
<div id="兩組之間生存概率的比較" class="section level2">
<h2><span class="header-section-number">72.5</span> 兩組之間生存概率的比較</h2>
<p>本章目前爲止介紹的非參數法可以用於初步地對生存數據中不同組之間生存概率的比較。我們當然可以給不同組的患者/研究對象估計各自的生存曲線 (和信賴區間) 繪圖比較。</p>

<div class="example">
<span id="exm:11-Survival-analysis-2" class="example"><strong>Example 72.2  </strong></span><strong>治療組和對照組白血病患者的生存曲線比較</strong>: (本例中，時間是從發病到症狀緩解的時間，所以時間越短，說明療法越好) 下圖繪制的是治療組21名患者和對照組21名患者的生存概率曲線和它們各自的信賴區間。治療組的症狀緩解時間明顯比對照組要長，暗示治療方案可能對患者有不太好的影響。且途中的兩條生存曲線的95%信賴區間也基本沒有重疊。
</div>

<div class="figure" style="text-align: center"><span id="fig:SurvExample2-4"></span>
<img src="img/Selection_132.png" alt="Kaplain-Meier time-to-remission survival curves (solid lines) in leukemia patients in treatment and control groups, with corresponding 95% confidence limits(dotted lines)" width="90%" />
<p class="caption">
圖 72.2: Kaplain-Meier time-to-remission survival curves (solid lines) in leukemia patients in treatment and control groups, with corresponding 95% confidence limits(dotted lines)
</p>
</div>
<p>看圖中的生存曲線，目測第十周時，治療組和對照組各自的生存率大概是多少，你的結論是怎樣的？</p>
<p>從圖上看，在對照組，第十周時患者的生存概率在 40% 左右; 在治療組，第十周時患者的生存概率是 75% 左右。所以，治療組中的患者傾向於需要更多的時間才能達到症狀緩解。在第十周時，對照組患者有 60% 已經症狀緩解，然而治療組只有 25% 的患者症狀緩解，所以我們認爲數據提示治療方法可能對患者是有副作用的。</p>
<div id="the-log-rank-test" class="section level3">
<h3><span class="header-section-number">72.5.1</span> The log rank test</h3>
<p>兩組 (或者更多組) 之間生存概率曲線其實是可以用統計學檢驗方法來檢驗的。用 <span class="math inline">\(S_1(t),S_2(t)\)</span> 分別表示兩組研究對象的生存概率。那麼在時間點 <span class="math inline">\(u\)</span> 時，兩組時間生存概率的比較可以用下面的檢驗統計量:</p>
<p><span class="math display" id="eq:surv2-20">\[
\begin{equation}
\frac{\hat S_1(u) - \hat S_2(u)}{\sqrt{var \hat S_1(u) + var \hat S_2(u)}}
\end{equation}
\tag{72.5}
\]</span></p>
<p>然後把這個統計量拿去和標準正態分布做比較 (z-test)。</p>
<p>但是其實我們可以做得檢驗可以更多，比如比較兩組患者之間生存概率的分布，而不是只看某個時間點的生存概率之差。這種檢驗方法叫做 log rank test，或者 Mantel-Haenszel 檢驗。該檢驗的零假設是，兩組患者的生存曲線相同，它比較的是兩組患者的總體生存概率 (the whole survivor curves)。</p>
<p>接下來我們來推導這個檢驗方法。首先，先列出兩組患者在特定時間點時的數據:</p>
<table class="table table-striped table-bordered" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
表 72.2: Summary of numbers at risk and number of events at time <span class="math inline">\(t_j\)</span> in two groups.
</caption>
<thead>
<tr>
<th style="text-align:center;">
Group
</th>
<th style="text-align:center;">
Events at <span class="math inline">\(t_j\)</span>
</th>
<th style="text-align:center;">
Number of surviving beyond <span class="math inline">\(t_j\)</span>
</th>
<th style="text-align:center;">
Total number at risk at <span class="math inline">\(t_j\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
<span class="math inline">\(d_{1j}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(n_{1j} - d_{1j}\)</span> </d0>
</td>
<td style="text-align:center;">
<span class="math inline">\(n_{1j}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
<span class="math inline">\(d_{2j}\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(n_{2j} - d_{2j}\)</span> </d0>
</td>
<td style="text-align:center;">
<span class="math inline">\(n_{2j}\)</span>
</td>
</tr>
<tr>
<td style="text-align:center;">
Total
</td>
<td style="text-align:center;">
<span class="math inline">\(d_j\)</span>
</td>
<td style="text-align:center;">
<span class="math inline">\(n_j\)</span> <d0> dj </d0>
</td>
<td style="text-align:center;">
<span class="math inline">\(n_j\)</span>
</td>
</tr>
</tbody>
</table>
<p>在零假設 – 不同的組之間，在該時間點時事件發生次數沒有差別 – 的條件下，第一組患者中事件發生次數服從超幾何分布 (hypergeometric distribution) (章節: <a href="01-Probability.html#hyperdist">5.2</a>)。在超幾何分布下，組樣本量 <span class="math inline">\(n_{1j}\)</span> 中發生事件次數 <span class="math inline">\(d_{1j}\)</span> 在全體 (總樣本量 <span class="math inline">\(n_j\)</span>，事件次數 <span class="math inline">\(d_j\)</span>) 中的概率是:</p>
<p><span class="math display">\[
\begin{equation}
\frac{\binom{d_{j}}{d_{1j}}\binom{n_j - d_j}{n_{1j} - d_{1j}}}{\binom{n_j}{n_1j}}
\end{equation}
\]</span></p>
<p>對於第二組的患者，發生 <span class="math inline">\(d_{2j}\)</span> 次事件的概率也可以用相同的公式。那麼在給定的時間點 <span class="math inline">\(t_j\)</span>，在零假設 – 不同的組之間，在該時間點時事件發生次數沒有差別 – 的條件下， 第一組患者中發生事件次數的期望值 (expectation):</p>
<p><span class="math display" id="eq:surv2-22">\[
\begin{aligned}
e_{1j} = \frac{n_{1j}d_j}{n_j}
\end{aligned}
\tag{72.6}
\]</span></p>
<p>套用這個公式 <a href="11-Survival-analysis.html#eq:surv2-22">(72.6)</a>，我們可以計算每個時間點上事件發生次數的期望值和實際觀測值之間的差: <span class="math inline">\(d_{1j}-e_{1j}\)</span> 然後把每個時間點上事件次數的觀測值和期望值之間的差求和:</p>
<p><span class="math display" id="eq:surv2-23">\[
\begin{equation}
\sum_j (d_{1j} - e_{1j})
\end{equation}
\tag{72.7}
\]</span></p>
<p>如果零假設成立，統計量 <a href="11-Survival-analysis.html#eq:surv2-23">(72.7)</a> 應該等於零或者接近等於零。根據超幾何分布的方差，</p>
<p><span class="math display">\[
v_{1j}^2 = \text{var}(d_{1j}) = \frac{n_{1j}n_{2j}d_{j}(n_j - d_j)}{n_j^2 (n_j - 1)}
\]</span></p>
<p>所以，log-rank test 的檢驗統計量是</p>
<p><span class="math display">\[
\frac{\{ \sum_j(d_{1j} - e_{1j}) \}^2}{\sum_jv^2_{1j}} \sim \chi_1^2
\]</span></p>
<p>因此，在零假設條件下，這裏<strong>是兩組對象生存曲線的比較，所以它服從的是自由度爲 1 的卡方分布，如果比較的是兩組以上 (n) 的生存概率曲線，那麼這個統計量將會服從自由度爲 (n-1) 的卡方分布</strong> <span class="math inline">\(\chi^2_{n-1}\)</span>。</p>
</div>
</div>
<div id="計算累積風險度-cumulative-hazard" class="section level2">
<h2><span class="header-section-number">72.6</span> 計算累積風險度 cumulative hazard</h2>
<p>累積風險度的定義爲:</p>
<p><span class="math display">\[
H(t) = \int_0^t h(t)\text{d}t
\]</span></p>
<p>它和生存概率方程之間的關系爲:</p>
<p><span class="math display">\[
H(t) = -\log S(t)
\]</span></p>
<p>所以，非參數類型的累積風險度可以利用這個公式，套入 Kaplan-Meier 法估計的生存概率:</p>
<p><span class="math display">\[
\hat H(t) = - \log \hat S(t)
\]</span></p>
<p>另一個科學家 Nelson-Aalen 發現另一個更簡單的公式:</p>
<p><span class="math display" id="eq:surv2-29">\[
\begin{equation}
\tilde{H}(t) = \sum_{j|t_j \leqslant t}\hat h_j =  \sum_{j|t_j \leqslant t} \frac{d_j}{n_j}
\end{equation}
\tag{72.8}
\]</span></p>
<p>這個公式 <a href="11-Survival-analysis.html#eq:surv2-29">(72.8)</a> 的估算結果和 Kaplan-Meier 估計的累積生存曲線會非常接近，且可以被認爲漸進相同 (symptotically equivalent)。</p>
</div>
<div id="practical-02---survival-analysis" class="section level2">
<h2><span class="header-section-number">72.7</span> Practical 02 - survival analysis</h2>
<div class="sourceCode" id="cb1051"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1051-1" title="1"><span class="co"># summarize and explore the data</span></a>
<a class="sourceLine" id="cb1051-2" title="2"><span class="kw">library</span>(haven)</a>
<a class="sourceLine" id="cb1051-3" title="3">pbcbase &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/pbcbase.dta&quot;</span>)</a>
<a class="sourceLine" id="cb1051-4" title="4"><span class="kw">with</span>(pbcbase, <span class="kw">tabpct</span>(treat, d, <span class="dt">graph =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>## 
## Original table 
##        d
## treat      0    1  Total
##   1       45   49     94
##   2       50   47     97
##   Total   95   96    191
## 
## Row percent 
##      d
## treat       0       1  Total
##     1      45      49     94
##        (47.9)  (52.1)  (100)
##     2      50      47     97
##        (51.5)  (48.5)  (100)
## 
## Column percent 
##        d
## treat     0       %   1      %
##   1      45  (47.4)  49   (51)
##   2      50  (52.6)  47   (49)
##   Total  95   (100)  96  (100)</code></pre>
<div class="sourceCode" id="cb1053"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1053-1" title="1"><span class="co">#### median time</span></a>
<a class="sourceLine" id="cb1053-2" title="2">Median_t &lt;-<span class="st"> </span><span class="kw">ddply</span>(pbcbase,<span class="kw">c</span>(<span class="st">&quot;treat&quot;</span>,<span class="st">&quot;d&quot;</span>),summarise,<span class="dt">Median=</span><span class="kw">median</span>(time))</a>
<a class="sourceLine" id="cb1053-3" title="3">Median_t</a></code></pre></div>
<pre><code>##   treat d    Median
## 1     1 0 3.7426419
## 2     1 1 3.0006845
## 3     2 0 5.4483230
## 4     2 1 2.2012320</code></pre>
<pre><code>sts list if treat==2 &amp; cir0==1

         failure _d:  d
   analysis time _t:  (dateout-origin)/365.25
             origin:  time datein

           Beg.          Net            Survivor      Std.
  Time    Total   Fail   Lost           Function     Error     [95% Conf. Int.]
-------------------------------------------------------------------------------
  .104       26      1      0             0.9615    0.0377     0.7569    0.9945
 .2628       25      1      0             0.9231    0.0523     0.7260    0.9802
 .4572       24      1      0             0.8846    0.0627     0.6836    0.9613
 .4846       23      1      0             0.8462    0.0708     0.6404    0.9393
 .9172       22      0      1             0.8462    0.0708     0.6404    0.9393
 1.164       21      1      0             0.8059    0.0780     0.5946    0.9143
 1.369       20      1      0             0.7656    0.0839     0.5505    0.8873
 1.572       19      0      1             0.7656    0.0839     0.5505    0.8873
 1.687       18      1      0             0.7230    0.0894     0.5044    0.8576
 1.725       17      1      0             0.6805    0.0937     0.4603    0.8262
 2.182       16      1      0             0.6380    0.0970     0.4180    0.7933
 2.201       15      1      0             0.5954    0.0994     0.3773    0.7590
 2.634       14      0      1             0.5954    0.0994     0.3773    0.7590
 2.667       13      1      0             0.5496    0.1018     0.3337    0.7215
 3.047       12      0      1             0.5496    0.1018     0.3337    0.7215
  3.45       11      1      0             0.4997    0.1041     0.2866    0.6803
 3.472       10      1      0             0.4497    0.1050     0.2425    0.6371
 3.855        9      1      0             0.3997    0.1045     0.2012    0.5920
 4.249        8      1      0             0.3498    0.1027     0.1625    0.5448
  5.47        7      0      1             0.3498    0.1027     0.1625    0.5448
 5.541        6      0      1             0.3498    0.1027     0.1625    0.5448
 6.762        5      1      0             0.2798    0.1033     0.1056    0.4859
 6.905        4      1      0             0.2099    0.0983     0.0601    0.4202
 8.019        3      1      0             0.1399    0.0869     0.0259    0.3469
  8.89        2      0      1             0.1399    0.0869     0.0259    0.3469
 11.25        1      0      1             0.1399    0.0869     0.0259    0.3469
-------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1056-1" title="1">pbc.km &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(time, d) <span class="op">~</span><span class="st"> </span>treat, <span class="dt">data =</span> pbcbase)</a>
<a class="sourceLine" id="cb1056-2" title="2"><span class="kw">summary</span>(pbc.km)</a></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time, d) ~ treat, data = pbcbase)
## 
##                 treat=1 
##     time n.risk n.event survival std.err lower 95% CI upper 95% CI
##  0.02464     90       1   0.9889 0.01105      0.96747       1.0000
##  0.05202     89       1   0.9778 0.01554      0.94779       1.0000
##  0.10404     88       1   0.9667 0.01892      0.93028       1.0000
##  0.13142     87       1   0.9556 0.02172      0.91391       0.9991
##  0.41068     86       1   0.9444 0.02415      0.89829       0.9930
##  0.67077     84       1   0.9332 0.02635      0.88297       0.9863
##  0.70089     83       1   0.9220 0.02833      0.86808       0.9792
##  0.93361     81       1   0.9106 0.03018      0.85331       0.9717
##  1.08145     79       1   0.8990 0.03192      0.83861       0.9638
##  1.21287     77       1   0.8874 0.03357      0.82395       0.9557
##  1.24846     76       1   0.8757 0.03510      0.80953       0.9473
##  1.25120     75       1   0.8640 0.03653      0.79532       0.9387
##  1.32512     74       1   0.8523 0.03785      0.78129       0.9299
##  1.42916     73       1   0.8407 0.03909      0.76744       0.9209
##  1.45927     72       1   0.8290 0.04026      0.75373       0.9118
##  1.46475     71       1   0.8173 0.04135      0.74017       0.9025
##  1.58248     70       1   0.8056 0.04237      0.72673       0.8931
##  2.07803     66       1   0.7934 0.04345      0.71268       0.8833
##  2.28611     64       1   0.7810 0.04451      0.69850       0.8733
##  2.63655     63       1   0.7686 0.04550      0.68445       0.8632
##  2.80082     61       1   0.7560 0.04646      0.67025       0.8528
##  2.80356     60       1   0.7434 0.04737      0.65617       0.8423
##  2.89117     58       1   0.7306 0.04825      0.64191       0.8316
##  2.90212     57       1   0.7178 0.04908      0.62778       0.8207
##  3.00068     56       1   0.7050 0.04985      0.61375       0.8098
##  3.25530     51       1   0.6912 0.05075      0.59852       0.7981
##  3.29090     50       1   0.6773 0.05158      0.58342       0.7864
##  3.33196     49       1   0.6635 0.05235      0.56845       0.7745
##  4.18344     43       1   0.6481 0.05336      0.55150       0.7616
##  4.27105     42       1   0.6327 0.05427      0.53474       0.7485
##  4.33676     41       1   0.6172 0.05510      0.51815       0.7352
##  4.55852     40       1   0.6018 0.05584      0.50172       0.7218
##  4.63518     38       1   0.5860 0.05657      0.48493       0.7080
##  4.77481     36       1   0.5697 0.05730      0.46776       0.6938
##  4.87611     34       1   0.5529 0.05801      0.45016       0.6792
##  4.93635     33       1   0.5362 0.05862      0.43275       0.6643
##  4.99658     31       1   0.5189 0.05923      0.41486       0.6490
##  5.14990     30       1   0.5016 0.05972      0.39718       0.6334
##  5.27584     28       1   0.4837 0.06022      0.37894       0.6173
##  5.31143     27       1   0.4658 0.06059      0.36092       0.6010
##  5.40726     26       1   0.4478 0.06085      0.34313       0.5845
##  6.05613     19       1   0.4243 0.06205      0.31853       0.5651
##  6.20671     18       1   0.4007 0.06292      0.29455       0.5451
##  6.41478     16       1   0.3757 0.06378      0.26933       0.5240
##  6.92950     12       1   0.3443 0.06570      0.23692       0.5005
##  6.94593     11       1   0.3130 0.06677      0.20609       0.4755
##  7.12663      8       1   0.2739 0.06894      0.16725       0.4486
##  7.78371      6       1   0.2283 0.07097      0.12410       0.4199
##  9.25941      2       1   0.1141 0.08816      0.02511       0.5187
## 
##                 treat=2 
##     time n.risk n.event survival std.err lower 95% CI upper 95% CI
##  0.02464     93       1   0.9892 0.01069       0.9685       1.0000
##  0.10404     92       1   0.9785 0.01504       0.9495       1.0000
##  0.26283     91       1   0.9677 0.01832       0.9325       1.0000
##  0.39425     90       1   0.9570 0.02104       0.9166       0.9991
##  0.45722     89       1   0.9462 0.02339       0.9015       0.9932
##  0.48460     88       1   0.9355 0.02547       0.8869       0.9868
##  0.52841     86       1   0.9246 0.02740       0.8724       0.9799
##  0.55031     85       1   0.9137 0.02916       0.8583       0.9727
##  0.56674     84       1   0.9029 0.03077       0.8445       0.9652
##  0.68720     83       1   0.8920 0.03227       0.8309       0.9575
##  1.15264     79       1   0.8807 0.03378       0.8169       0.9494
##  1.16359     78       1   0.8694 0.03518       0.8031       0.9412
##  1.27036     77       1   0.8581 0.03649       0.7895       0.9327
##  1.36893     75       1   0.8467 0.03776       0.7758       0.9240
##  1.60438     72       1   0.8349 0.03902       0.7618       0.9150
##  1.68652     71       1   0.8231 0.04020       0.7480       0.9058
##  1.72485     70       1   0.8114 0.04131       0.7343       0.8965
##  1.74127     69       1   0.7996 0.04235       0.7208       0.8871
##  1.77139     68       1   0.7879 0.04333       0.7073       0.8775
##  1.88364     66       1   0.7759 0.04429       0.6938       0.8678
##  2.03422     65       1   0.7640 0.04519       0.6804       0.8579
##  2.06434     64       1   0.7521 0.04603       0.6670       0.8479
##  2.18207     62       1   0.7399 0.04686       0.6535       0.8377
##  2.20123     60       1   0.7276 0.04768       0.6399       0.8273
##  2.59274     56       1   0.7146 0.04856       0.6255       0.8164
##  2.66667     54       1   0.7014 0.04943       0.6109       0.8053
##  3.33744     52       1   0.6879 0.05029       0.5960       0.7939
##  3.41410     51       1   0.6744 0.05108       0.5814       0.7823
##  3.44969     50       1   0.6609 0.05181       0.5668       0.7707
##  3.47159     49       1   0.6474 0.05248       0.5523       0.7589
##  3.85489     47       1   0.6336 0.05314       0.5376       0.7468
##  4.10404     45       1   0.6196 0.05379       0.5226       0.7345
##  4.10678     44       1   0.6055 0.05438       0.5077       0.7220
##  4.16701     43       1   0.5914 0.05491       0.4930       0.7094
##  4.24914     42       1   0.5773 0.05538       0.4784       0.6967
##  4.25462     41       1   0.5632 0.05579       0.4639       0.6839
##  5.31691     37       1   0.5480 0.05632       0.4480       0.6703
##  5.40726     36       1   0.5328 0.05677       0.4324       0.6565
##  5.88090     28       1   0.5138 0.05785       0.4120       0.6406
##  6.04791     27       1   0.4947 0.05875       0.3920       0.6244
##  6.64203     21       1   0.4712 0.06049       0.3664       0.6060
##  6.76249     19       1   0.4464 0.06218       0.3397       0.5865
##  6.84463     17       1   0.4201 0.06383       0.3119       0.5658
##  6.90486     16       1   0.3939 0.06502       0.2850       0.5443
##  7.82204     13       1   0.3636 0.06670       0.2538       0.5209
##  8.01917     12       1   0.3333 0.06768       0.2238       0.4962
##  8.27926     11       1   0.3030 0.06797       0.1952       0.4703</code></pre>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1058-1" title="1"><span class="kw">plot</span>(pbc.km, <span class="dt">conf.int =</span> F, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">mark.time =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Survivor function&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-02-03"></span>
<img src="bookdown_files/figure-html/Surv-prac-02-03-1.png" alt="Rplots of the Kaplan-Meier survivor functions" width="70%" />
<p class="caption">
圖 72.3: Rplots of the Kaplan-Meier survivor functions
</p>
</div>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1059-1" title="1"><span class="kw">plot</span>(pbc.km, <span class="dt">conf.int =</span> T, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">mark.time =</span> T, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Survivor function&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-02-04"></span>
<img src="bookdown_files/figure-html/Surv-prac-02-04-1.png" alt="Rplots of the Kaplan-Meier survivor functions with confidence intervals" width="70%" />
<p class="caption">
圖 72.4: Rplots of the Kaplan-Meier survivor functions with confidence intervals
</p>
</div>
<p>在追蹤前兩年，兩組患者的生存方程沒有太大區別，兩年之後，到大約第五年之間，藥物治療組的生存概率曲線似乎要低於對照組，暗示藥物治療在這段時間內可能導致患者較高的死亡率。患者隨訪達到第五年之後，可以看到藥物治療組患者的生存概率曲線一直都處在對照組的上方，提示我們患者被隨訪達到五年之後，藥物治療組的患者死亡率開始低於對照組死亡率。但是，這兩條生存概率曲線的 95% 信賴區間彼此重疊部分很大，且在臨近隨訪達到12年的時候，信賴區間太寬，因爲此時已經沒有多少死亡病例。這兩組患者都有大約 50% 左右的患者的生存率超過五年。</p>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1060-1" title="1">pbc.km1 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(time, d) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span><span class="kw">subset</span>(pbcbase, pbcbase<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1060-2" title="2">pbc.km2 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(time, d) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span><span class="kw">subset</span>(pbcbase, pbcbase<span class="op">$</span>treat <span class="op">==</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1060-3" title="3">cumhaz<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">cumsum</span>(pbc.km1<span class="op">$</span>n.event<span class="op">/</span>pbc.km1<span class="op">$</span>n.risk)</a>
<a class="sourceLine" id="cb1060-4" title="4">cumhaz<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">cumsum</span>(pbc.km2<span class="op">$</span>n.event<span class="op">/</span>pbc.km2<span class="op">$</span>n.risk)</a>
<a class="sourceLine" id="cb1060-5" title="5"><span class="kw">plot</span>(pbc.km1<span class="op">$</span>time, cumhaz<span class="fl">.1</span>, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Cumulative hazard&quot;</span>)</a>
<a class="sourceLine" id="cb1060-6" title="6"><span class="kw">lines</span>(pbc.km2<span class="op">$</span>time, cumhaz<span class="fl">.2</span>, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-02-05"></span>
<img src="bookdown_files/figure-html/Surv-prac-02-05-1.png" alt="Rplots of the Nelson-Aalen estimates of the cumulative hazard" width="70%" />
<p class="caption">
圖 72.5: Rplots of the Nelson-Aalen estimates of the cumulative hazard
</p>
</div>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1061-1" title="1"><span class="kw">plot</span>(pbc.km, <span class="dt">conf.int=</span> F, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">mark.time =</span>F,<span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Cumulative hazard&quot;</span>, <span class="dt">fun =</span> <span class="st">&quot;cumhaz&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-02-06"></span>
<img src="bookdown_files/figure-html/Surv-prac-02-06-1.png" alt="Rplots of the Kaplan-Meier estimates of the cumulative hazard" width="70%" />
<p class="caption">
圖 72.6: Rplots of the Kaplan-Meier estimates of the cumulative hazard
</p>
</div>
<p>從兩個生存累積概率曲線來看，治療組的生存累計概率似乎隨着時間更加呈線性變化。在對照組，風險在5年以後的累計速率陡然升高了。</p>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1062-1" title="1"><span class="co"># the log rank test</span></a>
<a class="sourceLine" id="cb1062-2" title="2"></a>
<a class="sourceLine" id="cb1062-3" title="3"><span class="kw">survdiff</span>(<span class="kw">Surv</span>(time, d) <span class="op">~</span><span class="st"> </span>treat, <span class="dt">data =</span> pbcbase)</a></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time, d) ~ treat, data = pbcbase)
## 
##          N Observed Expected (O-E)^2/E (O-E)^2/V
## treat=1 94       49    45.33    0.2966    0.5696
## treat=2 97       47    50.67    0.2654    0.5696
## 
##  Chisq= 0.6  on 1 degrees of freedom, p= 0.45</code></pre>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1064-1" title="1">whitehall &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/whitehall.dta&quot;</span>)</a>
<a class="sourceLine" id="cb1064-2" title="2">whl.km &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(<span class="dt">time=</span>(timeout <span class="op">-</span><span class="st"> </span>timein)<span class="op">/</span><span class="fl">365.25</span>, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1064-3" title="3"><span class="kw">plot</span>(whl.km, <span class="dt">conf.int =</span> T, <span class="dt">mark.time =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Survivor function&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-02-08"></span>
<img src="bookdown_files/figure-html/Surv-prac-02-08-1.png" alt="Rplots of the Kaplan-Meier estimates of the survivor curve" width="70%" />
<p class="caption">
圖 72.7: Rplots of the Kaplan-Meier estimates of the survivor curve
</p>
</div>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1065-1" title="1">whl.km &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(<span class="dt">time =</span> (timeout <span class="op">-</span><span class="st"> </span>timein)<span class="op">/</span><span class="fl">365.25</span>, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span>sbpgrp, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1065-2" title="2"><span class="kw">plot</span>(whl.km, <span class="dt">conf.int =</span> F, <span class="dt">mark.time =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Survivor function&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;orange&quot;</span>))</a>
<a class="sourceLine" id="cb1065-3" title="3"><span class="kw">legend</span>(<span class="dv">1</span>, <span class="fl">0.85</span>, <span class="kw">c</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="st">&quot;Group 2&quot;</span>, <span class="st">&quot;Group 3&quot;</span>, <span class="st">&quot;Group 4&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-02-09"></span>
<img src="bookdown_files/figure-html/Surv-prac-02-09-1.png" alt="Rplots of the Kaplan-Meier estimates of the survivor curve" width="70%" />
<p class="caption">
圖 72.8: Rplots of the Kaplan-Meier estimates of the survivor curve
</p>
</div>
<p>所以，第四組患者的生存率最差， 第一組，第二組患者幾乎沒有差別。</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1066-1" title="1"><span class="kw">survdiff</span>(<span class="kw">Surv</span>(<span class="dt">time =</span> (timeout <span class="op">-</span><span class="st"> </span>timein)<span class="op">/</span><span class="fl">365.25</span>, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span>sbpgrp, <span class="dt">data =</span> whitehall)</a></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time = (timeout - timein)/365.25, event = chd) ~ 
##     sbpgrp, data = whitehall)
## 
##            N Observed Expected (O-E)^2/E (O-E)^2/V
## sbpgrp=1 383       28    36.81    2.1101     2.776
## sbpgrp=2 664       44    62.90    5.6786     9.602
## sbpgrp=3 417       43    37.09    0.9411     1.240
## sbpgrp=4 213       39    17.20   27.6494    31.153
## 
##  Chisq= 36.4  on 3 degrees of freedom, p= 6.1e-08</code></pre>
</div>
</div>
<div id="生存數據中的回歸模型" class="section level1">
<h1><span class="header-section-number">第 73 章</span> 生存數據中的回歸模型</h1>
<div id="生存數據的似然方程" class="section level2">
<h2><span class="header-section-number">73.1</span> 生存數據的似然方程</h2>
<p><span class="math display">\[
L = \prod_i f(t_i)^{\delta_i}S(t_i)^{1-\delta_i}
\]</span></p>
<ul>
<li><span class="math inline">\(i = 1, \cdots, n\)</span> 是患者的編號</li>
<li><span class="math inline">\(t_i\)</span> 是 <span class="math inline">\(i\)</span> 號患者的生存/刪失時間</li>
<li><span class="math inline">\(\delta_i\)</span> 是表示 <span class="math inline">\(i\)</span> 號患者的生存/刪失狀態的啞變量 (indicator/dummy variable)</li>
<li><span class="math inline">\(f(t_i)\)</span> 是生存數據(死亡/事件發生患者的)的概率密度方程 probablity density function</li>
<li><span class="math inline">\(S(t_i)\)</span> 是生存數據(生存/刪失患者的)生存概率方程 survivor function</li>
</ul>
</div>
<div id="如何加入解釋變量" class="section level2">
<h2><span class="header-section-number">73.2</span> 如何加入解釋變量</h2>
<p>先考慮一個二分類變量 (binary explanatory variable <span class="math inline">\(X = 0 \text{ or } 1\)</span>)，可以是治療組對照組等簡單的二分類變量。可以認爲其中一組 <span class="math inline">\((X=1)\)</span> 患者在時間點 <span class="math inline">\(t\)</span> 時的風險度 (hazard) <span class="math inline">\(h_1(t)\)</span> 和另一個被看作是對照的基準組 (baseline group <span class="math inline">\(X=0\)</span>) 的風險度 <span class="math inline">\(h_0(t)\)</span> 之間的關系是相乘的話:</p>
<p><span class="math display">\[
h_1(t) = \psi h_0 (t)
\]</span></p>
<p>那麼這裏的 <span class="math inline">\(\psi\)</span> 就是我們關心的參數。注意這裏兩組患者的風險度，等式左右兩邊都必須是大於零的，因此 <span class="math inline">\(psi\)</span> 的取值要被限制在 <span class="math inline">\(&gt;0\)</span> 範圍。所以，我們常常直接寫成:</p>
<p><span class="math display">\[
h_1(t) = e^\beta h_0(t)
\]</span></p>
<p>那麼參數 <span class="math inline">\(\beta\)</span> 就沒有了取值的限制。這就是大名鼎鼎的<strong>比例風險度模型 (proportional hazard model)</strong>。<span class="math inline">\(e^\beta\)</span> 就是風險度比 (Hazard ratio):</p>
<p><span class="math display">\[
\frac{h_1(t)}{h_0(t)} = e^\beta
\]</span></p>
<p><span class="math inline">\(\beta\)</span> 是對數風險度比 (log-hazard ratio)，這個風險度比，不隨着時間推進而變化。所以在生存分析的參數模型中，<strong>前提條件–比例風險度 (proportional hazard assumption)，是必須被滿足的假設</strong>。當你認爲治療組對照組之間的療效差 (treatment effect) 會隨着時間發生變化的話，這個前提條件就被違反了。用於生存分析的這些參數模型，都需要比例風險度這一重要的前提條件被滿足。</p>
</div>
<div id="指數模型-exponential-model" class="section level2">
<h2><span class="header-section-number">73.3</span> 指數模型 exponential model</h2>
<p>指數模型是最簡單的生存時間分析參數模型。</p>
<p><strong>風險度方程 hazard function:</strong></p>
<p><span class="math display">\[
h(t) = \lim_{\delta\rightarrow0}\frac{1}{\delta}\text{Pr}(t\leqslant T &lt;t + \delta | T&gt;t) = \lambda
\]</span></p>
<p><strong>生存概率方程 survivor function:</strong></p>
<p><span class="math display">\[
S(t) = \text{Pr}(T&gt;t) = \exp\{-\lambda t\}
\]</span></p>
<p><strong>概率密度方程 probability density function:</strong></p>
<p><span class="math display">\[
f(t) = \lambda \exp\{ - \lambda t\}
\]</span></p>
<p>在指數分布時，風險度本身 (而不是比例) 保持不變。這也意味着事件發生的率 (rate of the event) 不隨時間發生變化 (constant over time)。</p>
<p>在指數分布模型下加入解釋變量:</p>
<p><span class="math display">\[
\left\{
  \begin{array}{ll}
  h(t;0) = \lambda &amp; X=0  \\
  h(t;1) = \lambda e^\beta &amp; X=1
  \end{array}
\right.
\]</span></p>
<p>這個聯立方程等價於:</p>
<p><span class="math display">\[
h(t;x) = \lambda e^{\beta x}
\]</span></p>
<p>類似地，風險度方程已知了的話，概率密度方程和生存方程可以寫作:</p>
<p><span class="math display">\[
f(t;x) = \lambda e^{\beta x} \exp({-\lambda t^{\beta x}}); \\
S(t;x) = \exp(-\lambda t^{\beta x})
\]</span></p>
<p>此時的似然方程就是</p>
<p><span class="math display">\[
L = \prod_{i = 1}^n\{\lambda e^{\beta x} \exp({-\lambda t^{\beta x}}) \}^{\delta_i}\{ \exp(-\lambda t^{\beta x})\}^{1-\delta_i}
\]</span></p>
<p>此時，似然方程中兩個參數 <span class="math inline">\(\lambda, \beta\)</span> 可以利用自己似然函數的方法分別對其中一個求導數獲得 MLE，然後用 Fisher information matrix 計算各自的標準誤，從而計算 95% 信賴區間。這裏的 <span class="math inline">\(\beta\)</span> 回歸系數，可以做是否爲零 (等價於比較 <span class="math inline">\(e^\beta = 1\)</span>) 的 Wald 檢驗:</p>
<p><span class="math display">\[
\frac{\hat\beta}{SE(\hat\beta)} \sim N(0,1)
\]</span></p>

<div class="example">
<span id="exm:11-Survival-analysis-3" class="example"><strong>Example 73.1  </strong></span><strong>推導<span class="math inline">\(\lambda,\beta\)</span>的MLE:</strong>
</div>

<p><span class="math display">\[
\begin{aligned}
L &amp; = \prod_{i = 1}^n\{\lambda e^{\beta x} \exp({-\lambda t^{\beta x}}) \}^{\delta_i}\{ \exp(-\lambda t^{\beta x})\}^{1-\delta_i} \\
  &amp; = \prod_{i = 1}^n\{\lambda e^{\beta x}\}^{\delta_i}\exp(-\lambda t^{\beta x}) \\
\Rightarrow \ell &amp; = \log(\lambda)\sum_{i=1}^n \delta_i + \beta \sum_{i = 1}^n(x_i\delta_i) - \lambda\sum_{i = 1}^n t_ie^{\beta x_i} \\
\text{Let} &amp; \sum_{i = 1}^n = n_1 \text{(numer of events)}; \\
&amp;\sum_{i=1}^n(x_i\delta_i) = n_{11} \text{(number of events in } x=1); \\
&amp;\sum_{x_i=1}^n t_i = T_1 \text{(sum of survival/censors T in } x=1);\\
&amp;\sum_{x_i=0}^n t_i = T_0 \text{(sum of survival/censors T in } x=0);\\
\Rightarrow \ell &amp; =n_1 \log(\lambda) + n_{11}\beta - \lambda(T_0 + T_1e^\beta)
\end{aligned}
\]</span></p>
<p>接下來求 MLE 就等同於解下面的聯立方程組:</p>
<p><span class="math display">\[
\left\{\begin{array}{l}
\frac{\text{d}\ell}{\text{d}\lambda} = \frac{n_1}{\lambda} - (T_0 +T_1e^\beta) =0 \\
\frac{\text{d}\ell}{\text{d}\beta} = n_{11} = T_1\lambda e^\beta = 0
\end{array}
\right. \\
\hat\lambda = \frac{n_1 - n_{11}}{T_0} \\
\hat\beta = \log\frac{T_0n_{11}}{T_1(n_1 - n_{11})}
\]</span></p>
</div>
<div id="weibull-分布-1" class="section level2">
<h2><span class="header-section-number">73.4</span> Weibull 分布</h2>
<p>指數分布的模型只能用於擬合數據滿足事件發生率恆定不變這一十分強的假設的前提下。Weibull 分布放鬆了這個假設前提，不再要求時間發生率恆定不變，但是它的前提條件是時間發生率隨着時間的變化是單調的 (遞增或者遞減，二者只能選一)。且 Weibull 分布是指數分布的一般化形式，或者說指數分布是 Weibull 分布的特殊形式。</p>
<p><strong>Weibull 分布的風險度方程:</strong></p>
<p><span class="math display">\[
h(t) = \kappa \lambda t^{\kappa - 1}
\]</span></p>
<p><strong>生存概率方程</strong></p>
<p><span class="math display">\[
S(t;x) = \exp\{ -\lambda t^\kappa \}
\]</span></p>
<p><strong>概率密度方程</strong></p>
<p><span class="math display">\[
f(t) = \kappa \lambda t^{\kappa - 1}  \exp\{ -\lambda t^\kappa \}
\]</span></p>
<p>那麼加入了一個二分類解釋變量 <span class="math inline">\(x\)</span> 的 Weibull 比例風險度方程就是:</p>
<p><span class="math display">\[
h(t;x) =  \kappa \lambda t^{\kappa - 1}e^{\beta x}
\]</span></p>
<p>其生存概率方程就是:</p>
<p><span class="math display">\[
S(t;x) = \exp\{ -\lambda t^\kappa e^{\beta x}\}
\]</span></p>
<p>概率密度方程是二者的乘積，那麼所有的生存數據的似然方程就是:</p>
<p><span class="math display">\[
L = \prod_{i=1}^n \{\kappa \lambda t^{\kappa - 1}e^{\beta x}\exp\{ -\lambda t^\kappa e^{\beta x}\} \}^{\delta_i}\{ \exp\{ -\lambda t^\kappa e^{\beta x}\}\}^{1-\delta_i}
\]</span></p>
<p>但是，比較悲劇的是，在 Weibull 分布的生存模型中，沒有辦法簡單的獲得參數 <span class="math inline">\(\kappa, \lambda. \beta\)</span> 的MLE。只能使用迭代法 (iterative numerical methods are required)。</p>
</div>
<div id="weibull-和-指數模型的比較" class="section level2">
<h2><span class="header-section-number">73.5</span> Weibull 和 指數模型的比較</h2>
<div id="繪圖法" class="section level3">
<h3><span class="header-section-number">73.5.1</span> 繪圖法</h3>
<p>在指數分布模型中，累積風險度 cumulative hazard 是和時間呈正比的:
<span class="math display">\[
H(t;x) = -\log S(t;x) = \lambda t e^{\beta x}
\]</span></p>
<p>在 Weibull 分布模型中，累積風險度 cumulative hazard，取了對數以後:</p>
<p><span class="math display">\[
\log H(t;x) = \log\{ -\log S(t;x) \} = \log \lambda + \kappa \log t + \beta x
\]</span></p>
<p>所以，累積風險度如果取了對數，那麼這個值和時間的對數 <span class="math inline">\(\log t\)</span> 是呈線性關系的，且當這個直線的坡度爲 1 的話 <span class="math inline">\(\kappa = 1\)</span>，就說明數據符合指數模型。如果，<span class="math inline">\(x\)</span> 只是一個二分類解釋變量的話，你會看到對數累積風險度和對數時間呈現爲<strong>兩條平行線</strong>。</p>
</div>
<div id="統計檢驗法" class="section level3">
<h3><span class="header-section-number">73.5.2</span> 統計檢驗法</h3>
<p>很簡單， Wald test:</p>
<p><span class="math display">\[
\frac{\log \hat\kappa}{SE(\log \hat\kappa)} \sim N(0,1)
\]</span></p>
<p>當然你也可以使用似然比檢驗 likelihood ratio test，因爲指數分布模型是 Weibull 分布模型在 <span class="math inline">\(\kappa = 1\)</span> 時的特殊形態，二者擬合的統計模型也會是嵌套式模型:</p>
<p><span class="math display">\[
-2(\ell_{\text{exponential}} - \ell_{\text{Weibull}}) \sim \chi_1^2
\]</span></p>
<p>服從的卡方分布的自由度是兩個模型的參數數量的差。</p>
</div>
</div>
<div id="多於-1-個解釋變量的參數模型" class="section level2">
<h2><span class="header-section-number">73.6</span> 多於 1 個解釋變量的參數模型</h2>
<p>當然可以在生存分析參數模型中加入多於一個變量，而且可以是分類型，連續型變量:</p>
<p><span class="math display">\[
h(t;x) = h_0 (t)e^{\beta^Tx}
\]</span></p>
<ul>
<li><span class="math inline">\(h_0(t)\)</span> 是基線組的風險度 (baseline hazard);</li>
<li><span class="math inline">\(\mathbf{\beta} = (\beta_1, \beta_2, \cdots, \beta_p)^T\)</span> 是一組解釋變量的回歸系數;</li>
<li><span class="math inline">\(\beta_k\)</span> 是當保持所有其他變量不變時，解釋變量 <span class="math inline">\(X_k\)</span> 在增加/減少一個單位對應的對數風險度比 (log-hazard ratio)。</li>
</ul>
</div>
<div id="practical-survival-03" class="section level2">
<h2><span class="header-section-number">73.7</span> Practical Survival 03</h2>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1068-1" title="1">whitehall &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/whitehall.dta&quot;</span>)</a>
<a class="sourceLine" id="cb1068-2" title="2">whitehall &lt;-<span class="st"> </span>whitehall <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1068-3" title="3"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">timein =</span> <span class="kw">as.numeric</span>(timein),</a>
<a class="sourceLine" id="cb1068-4" title="4">                       <span class="dt">timeout =</span> <span class="kw">as.numeric</span>(timeout),</a>
<a class="sourceLine" id="cb1068-5" title="5">                       <span class="dt">timebth =</span> <span class="kw">as.numeric</span>(timebth)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1068-6" title="6"><span class="st">                </span><span class="kw">mutate</span>(<span class="dt">time =</span> (timeout <span class="op">-</span><span class="st"> </span>timein)<span class="op">/</span><span class="fl">365.25</span>)</a>
<a class="sourceLine" id="cb1068-7" title="7"></a>
<a class="sourceLine" id="cb1068-8" title="8"><span class="kw">with</span>(whitehall, <span class="kw">tabpct</span>(grade, chd, <span class="dt">graph =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<pre><code>## 
## Original table 
##        chd
## grade       0     1  Total
##   1      1104    90   1194
##   2       419    64    483
##   Total  1523   154   1677
## 
## Row percent 
##      chd
## grade       0       1  Total
##     1    1104      90   1194
##        (92.5)   (7.5)  (100)
##     2     419      64    483
##        (86.7)  (13.3)  (100)
## 
## Column percent 
##        chd
## grade       0       %    1       %
##   1      1104  (72.5)   90  (58.4)
##   2       419  (27.5)   64  (41.6)
##   Total  1523   (100)  154   (100)</code></pre>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1070-1" title="1"><span class="co">#### median time</span></a>
<a class="sourceLine" id="cb1070-2" title="2">Median_t &lt;-<span class="st"> </span><span class="kw">ddply</span>(whitehall,<span class="kw">c</span>(<span class="st">&quot;grade&quot;</span>,<span class="st">&quot;chd&quot;</span>),summarise,<span class="dt">Median=</span><span class="kw">median</span>(time))</a>
<a class="sourceLine" id="cb1070-3" title="3">Median_t</a></code></pre></div>
<pre><code>##   grade chd     Median
## 1     1   0 18.1779175
## 2     1   1 11.9110102
## 3     2   0 17.8726806
## 4     2   1  8.7679441</code></pre>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1072-1" title="1">whl.km &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(<span class="dt">time =</span> time, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade), <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1072-2" title="2"><span class="kw">plot</span>(whl.km, <span class="dt">conf.int =</span> T, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">mark.time =</span> F, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Survivor function&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1072-3" title="3"><span class="kw">legend</span>(<span class="dv">1</span>, <span class="fl">0.85</span>, <span class="kw">c</span>(<span class="st">&quot;Grade 1&quot;</span>, <span class="st">&quot;Grade 2&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-03-02"></span>
<img src="bookdown_files/figure-html/Surv-prac-03-02-1.png" alt="Rplots of the Kaplan-Meier survivor functions" width="70%" />
<p class="caption">
圖 73.1: Rplots of the Kaplan-Meier survivor functions
</p>
</div>
<p>“Grade 1” 患者的生存概率明顯好於 “Grade 2”。而且，95% 信賴區間沒有重疊，提示這兩組之間的生存概率曲線應該有統計學上的顯著不同。</p>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1073-1" title="1"><span class="co"># How many individuals survived 5, 10, 15 years of follow-up in each job grade?</span></a>
<a class="sourceLine" id="cb1073-2" title="2"><span class="kw">summary</span>(whl.km, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>))</a></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time = time, event = chd) ~ as.factor(grade), 
##     data = whitehall)
## 
##                 as.factor(grade)=1 
##  time n.risk n.event survival  std.err lower 95% CI upper 95% CI
##     5   1169      10   0.9916 0.002648       0.9864       0.9968
##    10   1114      24   0.9709 0.004913       0.9613       0.9806
##    15   1045      30   0.9443 0.006772       0.9311       0.9577
## 
##                 as.factor(grade)=2 
##  time n.risk n.event survival  std.err lower 95% CI upper 95% CI
##     5    445      17   0.9642 0.008521       0.9477       0.9811
##    10    383      22   0.9144 0.013135       0.8890       0.9405
##    15    334      16   0.8747 0.015876       0.8442       0.9064</code></pre>
<div class="sourceCode" id="cb1075"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1075-1" title="1"><span class="co"># Log rank test to compare the estimated survivor functions in the two job grades</span></a>
<a class="sourceLine" id="cb1075-2" title="2"><span class="kw">survdiff</span>(<span class="kw">Surv</span>(<span class="dt">time=</span>time, <span class="dt">event =</span> chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade), <span class="dt">data =</span> whitehall)</a></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(time = time, event = chd) ~ as.factor(grade), 
##     data = whitehall)
## 
##                       N Observed Expected (O-E)^2/E (O-E)^2/V
## as.factor(grade)=1 1194       90   114.19     5.123     19.85
## as.factor(grade)=2  483       64    39.81    14.692     19.85
## 
##  Chisq= 19.8  on 1 degrees of freedom, p= 8.4e-06</code></pre>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1077-1" title="1"><span class="co"># Fit an exponential model</span></a>
<a class="sourceLine" id="cb1077-2" title="2">whl.exp &lt;-<span class="st"> </span><span class="kw">survreg</span>(<span class="kw">Surv</span>(time, chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade), <span class="dt">dist =</span> <span class="st">&quot;exponential&quot;</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1077-3" title="3"><span class="kw">summary</span>(whl.exp)</a></code></pre></div>
<pre><code>## 
## Call:
## survreg(formula = Surv(time, chd) ~ as.factor(grade), data = whitehall, 
##     dist = &quot;exponential&quot;)
##                     Value Std. Error      z         p
## (Intercept)        5.4205     0.1054 51.424   &lt; 2e-16
## as.factor(grade)2 -0.6885     0.1635 -4.211 0.0000255
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= -944.7   Loglik(intercept only)= -953.1
##  Chisq= 16.76 on 1 degrees of freedom, p= 0.000042 
## Number of Newton-Raphson Iterations: 6 
## n= 1677</code></pre>
<p>這裏 R 的輸出結果和 STATA 的結果略有不同:</p>
<pre><code>. streg i.grade, d(exp) nohr

         failure _d:  chd
   analysis time _t:  (timeout-origin)/365.25
             origin:  time timein

Iteration 0:   log likelihood = -627.95275
Iteration 1:   log likelihood = -620.09818
Iteration 2:   log likelihood = -619.57374
Iteration 3:   log likelihood = -619.57209
Iteration 4:   log likelihood = -619.57209

Exponential PH regression

No. of subjects =        1,677                  Number of obs    =       1,677
No. of failures =          154
Time at risk    =  27605.37066
                                                LR chi2(1)       =       16.76
Log likelihood  =   -619.57209                  Prob &gt; chi2      =      0.0000

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     2.grade |   .6885037   .1635118     4.21   0.000     .3680264    1.008981
       _cons |  -5.420525   .1054093   -51.42   0.000    -5.627123   -5.213926
------------------------------------------------------------------------------</code></pre>
<p>在 R 裏面，指數分布模型的回歸系數中，常數項 <code>(Intercept)</code> 等同於 STATA 裏的 <code>_cons</code>，但是，它在 R 裏估計的是 <span class="math inline">\(-\log \lambda\)</span>。<code>grade</code> 的回歸系數 <span class="math inline">\(\beta\)</span> 也一樣，在 R 裏它估計的是 <span class="math inline">\(-\beta\)</span>。所以你會發現 R 的輸出結果和 STATA 的結果符號相反，但是殊途同歸。</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1080-1" title="1"><span class="co"># Change the time scale to age time and fit the models again</span></a>
<a class="sourceLine" id="cb1080-2" title="2"></a>
<a class="sourceLine" id="cb1080-3" title="3"><span class="co">#The survreg function does not allow delayed entry times, so we can&#39;t use it with age as the time scale and entry at &#39;timein&#39;</span></a>
<a class="sourceLine" id="cb1080-4" title="4"><span class="co">#But we can fit the same model using an alternative function called &#39;weibreg&#39; which is in the &#39;eha&#39; package. You will need to install this package.</span></a>
<a class="sourceLine" id="cb1080-5" title="5"><span class="co"># install.packages(&quot;eha&quot;) # install and loading this package by uncomment these two lines</span></a>
<a class="sourceLine" id="cb1080-6" title="6"><span class="co"># library(eha)</span></a>
<a class="sourceLine" id="cb1080-7" title="7"></a>
<a class="sourceLine" id="cb1080-8" title="8">whl.exp2&lt;-<span class="kw">weibreg</span>(<span class="kw">Surv</span>(timein<span class="op">/</span><span class="fl">365.25</span>, timeout<span class="op">/</span><span class="fl">365.25</span>,<span class="dt">event=</span>chd,<span class="dt">origin=</span>timebth<span class="op">/</span><span class="fl">365.25</span>)<span class="op">~</span><span class="kw">as.factor</span>(grade), <span class="dt">data =</span> whitehall,</a>
<a class="sourceLine" id="cb1080-9" title="9">                  <span class="dt">shape =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1080-10" title="10"><span class="kw">summary</span>(whl.exp2)</a></code></pre></div>
<pre><code>## Call:
## weibreg(formula = Surv(timein/365.25, timeout/365.25, event = chd, 
##     origin = timebth/365.25) ~ as.factor(grade), data = whitehall, 
##     shape = 1)
## 
## Covariate           Mean       Coef Exp(Coef)  se(Coef)    Wald p
## as.factor(grade) 
##                1    0.737     0         1           (reference)
##                2    0.263     0.689     1.991     0.164     0.000 
## 
## log(scale)                    5.421   225.998     0.105     0.000 
## 
##  Shape is fixed at  1 
## 
## Events                    154 
## Total time at risk         27605 
## Max. log. likelihood      -944.7 
## LR test statistic         16.76 
## Degrees of freedom        1 
## Overall p-value           0.0000423884</code></pre>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1082-1" title="1"><span class="co">#Another alternative is the flexsurv package</span></a>
<a class="sourceLine" id="cb1082-2" title="2"><span class="co"># install.packages(&quot;flexsurv&quot;) # install and loading this package by uncomment these two lines</span></a>
<a class="sourceLine" id="cb1082-3" title="3"><span class="co"># library(flexsurv)</span></a>
<a class="sourceLine" id="cb1082-4" title="4">whl.exp3&lt;-<span class="kw">flexsurvreg</span>(<span class="kw">Surv</span>(timein<span class="op">/</span><span class="fl">365.25</span>, timeout<span class="op">/</span><span class="fl">365.25</span>,<span class="dt">event=</span>chd,<span class="dt">origin=</span>timebth<span class="op">/</span><span class="fl">365.25</span>)<span class="op">~</span><span class="kw">as.factor</span>(grade), <span class="dt">data =</span> whitehall,<span class="dt">dist =</span> <span class="st">&quot;exponential&quot;</span>,<span class="dt">inits =</span> <span class="kw">rep</span>(<span class="fl">0.1</span>,<span class="dv">2</span>))</a></code></pre></div>
<pre><code>## Warning in (function (q, rate = 1, lower.tail = TRUE, log.p = FALSE) : NaNs produced</code></pre>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1084-1" title="1">whl.exp3</a></code></pre></div>
<pre><code>## Call:
## flexsurvreg(formula = Surv(timein/365.25, timeout/365.25, event = chd, 
##     origin = timebth/365.25) ~ as.factor(grade), data = whitehall, 
##     dist = &quot;exponential&quot;, inits = rep(0.1, 2))
## 
## Estimates: 
##                    data mean  est       L95%      U95%      se        exp(est)  L95%      U95%    
## rate                     NA   0.004425  0.003599  0.005440  0.000466        NA        NA        NA
## as.factor(grade)2  0.288014   0.688359  0.367869  1.008848  0.163518  1.990446  1.444653  2.742439
## 
## N = 1677,  Events: 154,  Censored: 1523
## Total time at risk: 27605.371
## Log-likelihood = -944.69654, df = 2
## AIC = 1893.3931</code></pre>
<p>在指數分布模型下，我們默認事件發生率不會隨着時間變化，所以，改變了時間尺度，對生存分析估計的參數結果沒有影響。</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1086-1" title="1">whitehall &lt;-<span class="st"> </span>whitehall <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1086-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">agecat =</span> <span class="kw">cut</span>(agein, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>),<span class="dt">right =</span> F, <span class="dt">labels =</span> F))</a>
<a class="sourceLine" id="cb1086-3" title="3">whl.exp &lt;-<span class="st"> </span><span class="kw">survreg</span>(<span class="kw">Surv</span>(time, chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade) <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(agecat), <span class="dt">dist =</span> <span class="st">&quot;exponential&quot;</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1086-4" title="4"><span class="kw">summary</span>(whl.exp)</a></code></pre></div>
<pre><code>## 
## Call:
## survreg(formula = Surv(time, chd) ~ as.factor(grade) + as.factor(agecat), 
##     data = whitehall, dist = &quot;exponential&quot;)
##                      Value Std. Error      z        p
## (Intercept)         6.2076     0.1956 31.729  &lt; 2e-16
## as.factor(grade)2  -0.2681     0.1755 -1.527 0.126669
## as.factor(agecat)2 -0.9559     0.2582 -3.703 0.000213
## as.factor(agecat)3 -1.4462     0.2416 -5.985 2.16e-09
## as.factor(agecat)4 -1.4832     0.2707 -5.480 4.26e-08
## as.factor(agecat)5 -2.4060     0.3749 -6.418 1.38e-10
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= -914.1   Loglik(intercept only)= -953.1
##  Chisq= 78.01 on 5 degrees of freedom, p= 2.2e-15 
## Number of Newton-Raphson Iterations: 6 
## n= 1677</code></pre>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1088-1" title="1"><span class="co"># Fit the Weibull model in R, keep job grade and age category</span></a>
<a class="sourceLine" id="cb1088-2" title="2"></a>
<a class="sourceLine" id="cb1088-3" title="3">whl.weibull &lt;-<span class="st"> </span><span class="kw">survreg</span>(<span class="kw">Surv</span>(time, chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade) <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(agecat), <span class="dt">dist =</span> <span class="st">&quot;weibull&quot;</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1088-4" title="4"></a>
<a class="sourceLine" id="cb1088-5" title="5"><span class="kw">summary</span>(whl.weibull)</a></code></pre></div>
<pre><code>## 
## Call:
## survreg(formula = Surv(time, chd) ~ as.factor(grade) + as.factor(agecat), 
##     data = whitehall, dist = &quot;weibull&quot;)
##                       Value Std. Error      z        p
## (Intercept)         5.23905    0.22680 23.100  &lt; 2e-16
## as.factor(grade)2  -0.20191    0.12469 -1.619 0.105383
## as.factor(agecat)2 -0.68550    0.18946 -3.618 0.000297
## as.factor(agecat)3 -1.04268    0.18683 -5.581 2.39e-08
## as.factor(agecat)4 -1.07834    0.20598 -5.235 1.65e-07
## as.factor(agecat)5 -1.80110    0.28840 -6.245 4.23e-10
## Log(scale)         -0.34620    0.07678 -4.509 6.51e-06
## 
## Scale= 0.7074 
## 
## Weibull distribution
## Loglik(model)= -905.1   Loglik(intercept only)= -946.7
##  Chisq= 83.21 on 5 degrees of freedom, p= 1.8e-16 
## Number of Newton-Raphson Iterations: 10 
## n= 1677</code></pre>
<p>這個結果和 STATA 的結果也有些許不同:</p>
<pre><code>streg i.grade i.agecat, d(weib) nohr

         failure _d:  chd
   analysis time _t:  (timeout-origin)/365.25
             origin:  time timein

Fitting constant-only model:

Iteration 0:   log likelihood = -627.95275
Iteration 1:   log likelihood = -621.65709
Iteration 2:   log likelihood = -621.54148
Iteration 3:   log likelihood = -621.54144

Fitting full model:

Iteration 0:   log likelihood = -621.54144
Iteration 1:   log likelihood = -591.43979
Iteration 2:   log likelihood = -580.27283
Iteration 3:   log likelihood =  -579.9356
Iteration 4:   log likelihood = -579.93477
Iteration 5:   log likelihood = -579.93477

Weibull PH regression

No. of subjects =        1,677                  Number of obs    =       1,677
No. of failures =          154
Time at risk    =  27605.37066
                                                LR chi2(5)       =       83.21
Log likelihood  =   -579.93477                  Prob &gt; chi2      =      0.0000

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     2.grade |    .285431   .1753856     1.63   0.104    -.0583184    .6291805
             |
      agecat |
          2  |   .9690825   .2581668     3.75   0.000      .463085     1.47508
          3  |    1.47402   .2416534     6.10   0.000     1.000388    1.947652
          4  |   1.524436   .2707669     5.63   0.000     .9937422    2.055129
          5  |   2.546185   .3759036     6.77   0.000     1.809428    3.282943
             |
       _cons |  -7.406372   .3705694   -19.99   0.000    -8.132675   -6.680069
-------------+----------------------------------------------------------------
       /ln_p |   .3462011   .0767777     4.51   0.000     .1957195    .4966827
-------------+----------------------------------------------------------------
           p |   1.413687   .1085397                      1.216186    1.643261
         1/p |   .7073702   .0543103                      .6085461    .8222428
------------------------------------------------------------------------------</code></pre>
<ul>
<li>STATA裏的 <code>ln_p</code> (就是<span class="math inline">\(\kappa\)</span>形狀參數 shape parameter)，在 R 裏的名字是 <code>-log(scale)</code>。</li>
<li>STATA報告對數風險度比 <code>2.grade |.285431</code> ，R 裏面的回歸系數 <code>as.factor(grade)2  -0.2019</code> 其實是對數風險度比除以形狀參數之後變更符號，所以 <span class="math inline">\(-\frac{0.2854}{\exp(0.346)} = 0.202\)</span></li>
<li>所以在 R 中實際上輸出的結果是: <span class="math inline">\(-\log\kappa, -\frac{\beta}{\kappa}\)</span>。</li>
</ul>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1091-1" title="1">whl.km.agecat1 &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(<span class="dt">time=</span>time,<span class="dt">event=</span>chd)<span class="op">~</span>grade,<span class="dt">data=</span><span class="kw">subset</span>(whitehall,agecat<span class="op">==</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1091-2" title="2"><span class="kw">plot</span>(whl.km.agecat1,<span class="dt">conf.int=</span>T,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="dt">mark.time=</span>F,<span class="dt">xlab=</span><span class="st">&quot;log time&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;log(-log S(t))&quot;</span>,<span class="dt">fun=</span><span class="st">&quot;cloglog&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-03-06"></span>
<img src="bookdown_files/figure-html/Surv-prac-03-06-1.png" alt="Non-paramatric plot to investigate whether the Weibull model fit the data appropriate" width="70%" />
<p class="caption">
圖 73.2: Non-paramatric plot to investigate whether the Weibull model fit the data appropriate
</p>
</div>
<p>用 Weibull 分布模型的結果，繪制兩個 job grade 在 5 個不同年齡層次的估計生存概率曲線:</p>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1092-1" title="1">whl.weibull &lt;-<span class="st"> </span><span class="kw">survreg</span>(<span class="kw">Surv</span>(time, chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade) <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(agecat), <span class="dt">dist =</span> <span class="st">&quot;weibull&quot;</span>, <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1092-2" title="2"><span class="kw">plot</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">1</span>, <span class="dt">agecat =</span> <span class="dv">1</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb1092-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Survivor function: S(t)&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1092-4" title="4"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">2</span>, <span class="dt">agecat =</span> <span class="dv">1</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb1092-5" title="5"></a>
<a class="sourceLine" id="cb1092-6" title="6"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">1</span>, <span class="dt">agecat =</span> <span class="dv">2</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb1092-7" title="7"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">2</span>, <span class="dt">agecat =</span> <span class="dv">2</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb1092-8" title="8"></a>
<a class="sourceLine" id="cb1092-9" title="9"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">1</span>, <span class="dt">agecat =</span> <span class="dv">3</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb1092-10" title="10"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">2</span>, <span class="dt">agecat =</span> <span class="dv">3</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb1092-11" title="11"></a>
<a class="sourceLine" id="cb1092-12" title="12"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">1</span>, <span class="dt">agecat =</span> <span class="dv">4</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb1092-13" title="13"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">2</span>, <span class="dt">agecat =</span> <span class="dv">4</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb1092-14" title="14"></a>
<a class="sourceLine" id="cb1092-15" title="15"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">1</span>, <span class="dt">agecat =</span> <span class="dv">5</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb1092-16" title="16"><span class="kw">lines</span>(<span class="kw">predict</span>(whl.weibull, <span class="dt">newdata =</span> <span class="kw">list</span>(<span class="dt">grade =</span> <span class="dv">2</span>, <span class="dt">agecat =</span> <span class="dv">5</span>),  <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">p =</span> <span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">seq</span>(<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="dt">by =</span> <span class="fl">-0.01</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Surv-prac-03-07"></span>
<img src="bookdown_files/figure-html/Surv-prac-03-07-1.png" alt="The estimated survivor curves from the Weibull model in each job and age-at-entry category" width="70%" />
<p class="caption">
圖 73.3: The estimated survivor curves from the Weibull model in each job and age-at-entry category
</p>
</div>
<p>下面把隨訪時間按照 5 到 20 年每間隔五年的方法把所有患者的追蹤時間截斷成4個部分。然後用指數分布回歸模型擬合數據，這也是一種放鬆<strong>恆定事件發生率</strong>這一前提條件的方法:</p>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1093-1" title="1">whl.split &lt;-<span class="st"> </span><span class="kw">survSplit</span>(<span class="kw">Surv</span>(time, chd) <span class="op">~</span><span class="st"> </span>., whitehall, <span class="dt">cut =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>), <span class="dt">start =</span> <span class="st">&quot;time0&quot;</span>, <span class="dt">episode =</span> <span class="st">&quot;fuband&quot;</span>)</a>
<a class="sourceLine" id="cb1093-2" title="2"></a>
<a class="sourceLine" id="cb1093-3" title="3"><span class="kw">with</span>(whitehall, whitehall[id <span class="op">==</span><span class="st"> </span><span class="dv">5038</span>,])</a></code></pre></div>
<pre><code>## # A tibble: 1 x 16
##      id   all   chd   sbp  chol grade4  smok agein grade cholgrp sbpgrp timein timeout timebth  time
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1  5038     0     0   147   295      2     3  51.4     1       4      3  -840.   6239. -19630.  19.4
## # ... with 1 more variable: agecat &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1095-1" title="1"><span class="kw">with</span>(whl.split, whl.split[id <span class="op">==</span><span class="st"> </span><span class="dv">5038</span>,])</a></code></pre></div>
<pre><code>##      id all sbp chol grade4 smok     agein grade cholgrp sbpgrp     timein   timeout    timebth agecat
## 9  5038   0 147  295      2    3 51.444218     1       4      3 -840.01318 6238.9795 -19630.013      2
## 10 5038   0 147  295      2    3 51.444218     1       4      3 -840.01318 6238.9795 -19630.013      2
## 11 5038   0 147  295      2    3 51.444218     1       4      3 -840.01318 6238.9795 -19630.013      2
## 12 5038   0 147  295      2    3 51.444218     1       4      3 -840.01318 6238.9795 -19630.013      2
##    time0      time chd fuband
## 9      0  5.000000   0      2
## 10     5 10.000000   0      3
## 11    10 15.000000   0      4
## 12    15 19.381226   0      5</code></pre>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1097-1" title="1">whl.split.exp &lt;-<span class="st"> </span><span class="kw">flexsurvreg</span>(<span class="kw">Surv</span>(time0, time, chd) <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade) <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(agecat) <span class="op">+</span></a>
<a class="sourceLine" id="cb1097-2" title="2"><span class="st">                               </span><span class="kw">as.factor</span>(fuband), <span class="dt">dist =</span> <span class="st">&quot;exponential&quot;</span>, <span class="dt">data =</span> whl.split)</a>
<a class="sourceLine" id="cb1097-3" title="3"></a>
<a class="sourceLine" id="cb1097-4" title="4">whl.split.exp</a></code></pre></div>
<pre><code>## Call:
## flexsurvreg(formula = Surv(time0, time, chd) ~ as.factor(grade) + 
##     as.factor(agecat) + as.factor(fuband), data = whl.split, 
##     dist = &quot;exponential&quot;)
## 
## Estimates: 
##                     data mean  est        L95%       U95%       se         exp(est)   L95%     
## rate                       NA   0.001059   0.000627   0.001788   0.000283         NA         NA
## as.factor(grade)2    0.266742   0.286099  -0.057633   0.629832   0.175377   1.331225   0.943996
## as.factor(agecat)2   0.218258   0.970919   0.464910   1.476929   0.258173   2.640371   1.591871
## as.factor(agecat)3   0.194422   1.477681   1.003971   1.951391   0.241693   4.382770   2.729097
## as.factor(agecat)4   0.114967   1.529719   0.998873   2.060564   0.270845   4.616879   2.715221
## as.factor(agecat)5   0.016053   2.562203   1.824200   3.300206   0.376539  12.964346   6.197836
## as.factor(fuband)3   0.261716   0.628789   0.153466   1.104112   0.242516   1.875338   1.165868
## as.factor(fuband)4   0.242744   0.783803   0.307212   1.260394   0.243163   2.189785   1.359630
## as.factor(fuband)5   0.223610   1.074270   0.569018   1.579521   0.257786   2.927854   1.766532
##                     U95%     
## rate                       NA
## as.factor(grade)2    1.877295
## as.factor(agecat)2   4.379475
## as.factor(agecat)3   7.038471
## as.factor(agecat)4   7.850399
## as.factor(agecat)5  27.118216
## as.factor(fuband)3   3.016545
## as.factor(fuband)4   3.526812
## as.factor(fuband)5   4.852630
## 
## N = 6167,  Events: 154,  Censored: 6013
## Total time at risk: 27605.371
## Log-likelihood = -904.07753, df = 9
## AIC = 1826.1551</code></pre>
<p>我們用指數分布回歸擬合的生存時間模型，其實還可以用泊鬆回歸模型來做，結果也是一樣的:</p>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1099-1" title="1">whl.poi &lt;-<span class="st"> </span><span class="kw">glm</span>(chd <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(grade), <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> log), <span class="dt">offset =</span> <span class="kw">log</span>(time), <span class="dt">data =</span> whitehall)</a>
<a class="sourceLine" id="cb1099-2" title="2"><span class="kw">summary</span>(whl.poi)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = chd ~ as.factor(grade), family = poisson(link = log), 
##     data = whitehall, offset = log(time))
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.58433  -0.41268  -0.40212  -0.39440   3.55361  
## 
## Coefficients:
##                   Estimate Std. Error  z value   Pr(&gt;|z|)    
## (Intercept)       -5.42052    0.10541 -51.4238  &lt; 2.2e-16 ***
## as.factor(grade)2  0.68850    0.16351   4.2108 0.00002545 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 947.906  on 1676  degrees of freedom
## Residual deviance: 931.144  on 1675  degrees of freedom
## AIC: 1243.14
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>你可以回頭去和指數分布回歸的模型結果做個比較，他們的回歸系數估計和標準誤完全是一樣的。</p>
</div>
</div>
<div id="cox-比例風險模型" class="section level1">
<h1><span class="header-section-number">第 74 章</span> Cox 比例風險模型</h1>
<p><span class="math display">\[
h(t|x) = h_0(t)e^{\beta^Tx}
\]</span></p>
<p>其中，<span class="math inline">\(h_0(t)\)</span> 是被比較的基線組成員(baseline individual)的風險度 (hazard)，在 Weibull 模型或者指數模型中，這個基線風險 (baseline hazard) 是需要被模型根據數據來進行參數估計的 (parameterized)。但是，1972年，神一樣的人物 Cox <span class="citation">(Cox <a href="#ref-Cox1972b" role="doc-biblioref">1972</a>)</span> 提出，其實我們不需要對這個基線風險進行“無謂”的估計，可以無視它在模型中的存在。正因為如此，這個模型被冠以發明者的名字 Cox proportional hazards model。因為此模型不對基線風險進行任何估計，但是對預測變量對於風險的效果 (effect of the explanatory variable) 用模型中的 <span class="math inline">\(\beta\)</span> 進行參數估計，所以，它又是一種典型的半參數化模型 (semi-parametric model)。</p>
<p>Cox 比例風險模型下的似然：</p>
<p><span class="math display">\[
L= \prod_{i=1}^n\{ h_0(t)e^{\beta^Tx_i}\exp(-\int_0^{t_i} h_0(u)e^{\beta^Tx_i}du) \}^{\delta_i}\{ \exp(-\int_0^{t_i} h_0(u)e^{\beta^Tx_i}du) \}^{1-\delta_i}
\]</span></p>
<p>是無法估計的，此時要用到偏似然 (partial likelihood)，</p>
<p>思考這樣一個問題，在一組用 <span class="math inline">\(R_j\)</span> 標記的患者集合中，當我們已知它們同時都存活到了時間點 <span class="math inline">\(t_j\)</span>，且沒有發生刪失，那麼這組患者中的某個 <span class="math inline">\(i_j\)</span>，他/她有一個解釋變量 <span class="math inline">\(x_i\)</span>，他在這個時間點恰好發生事件的條件概率該怎麼計算：</p>
<p><span class="math display">\[
\frac{h_0(t_j)\exp(\beta^Tx_{i_j})}{\sum_{k\in R_j}h_0(t_j)\exp(\beta^Tx_k)} = \frac{\exp(\beta^Tx_{i_j})}{\sum_{k\in R_j}\exp(\beta^Tx_k)}
\]</span></p>
<p>是的，你沒有看錯，基線風險被完美的消除掉了，這就是它不需要被參數估計的原因。此時，我們用偏似然來計算這樣的模型似然：</p>
<p><span class="math display">\[
L_p = \prod_j \frac{\exp(\beta^Tx_{i_j})}{\sum_{k\in R_j}\exp(\beta^Tx_k)}
\]</span></p>
<p>模型的假設：</p>
<p><span class="math display">\[
h(t|x) = h_0(t)e^{\beta^Tx}
\]</span></p>
<ol style="list-style-type: decimal">
<li>Proportional hazards assumption - explanatory variables act <strong>multiplicatively</strong> on the hazard and their effect on the hazard does not change over time;</li>
<li>We have correctly specified the form for how continuous explanatory variables act on the hazard;</li>
<li>We have included all relevant explanatory variables including possbile interactions;</li>
<li>Uninformative censoring;</li>
<li>Individuals are independent.</li>
</ol>
<div id="該用半參數模型還是用全參數模型" class="section level2">
<h2><span class="header-section-number">74.1</span> 該用半參數模型還是用全參數模型</h2>
<ul>
<li>如果說指數模型或者 Weibull 模型是合理的，通常此時用 Cox 半參數模型也是合理的；</li>
<li>如果指數模型或者 Weibull 模型都是合理的，那麼 Cox 半參數模型給出的估計，其實不會和指數模型或者 Weibull 模型相差甚遠。指數模型或者 Weibull 模型可能給出的估計會相對更精確 (更小的標準誤)，但是實際應用中這種更加精確的程度其實十分有限；</li>
<li>另外，使用指數模型或者 Weibull 模型，重要的基線風險是否被模型擬合正確將會是關鍵 (baseline hazard mis-specified?)，但是使用 Cox 模型，就可以避免這個假設，忽略掉基線風險；</li>
<li>2002 年，<span class="citation">(Royston and Parmar <a href="#ref-Royston2002" role="doc-biblioref">2002</a>)</span> 提出第三種生存數據模型，“flexible parametric survival models”，結合了參數和半參數模型的長處，正在變得流行起來。在這個新型靈活參數生存模型中，使用了三次方程平滑曲線 (cubic splines modelled smoothly) 擬合對數基線累積風險 (log cumulative baseline hazard)。</li>
</ul>
</div>
</div>
<div id="分析策略和模型檢查-model-checking-survival-analysis" class="section level1">
<h1><span class="header-section-number">第 75 章</span> 分析策略和模型檢查 Model checking-survival analysis</h1>
<div id="生存分析策略" class="section level2">
<h2><span class="header-section-number">75.1</span> 生存分析策略</h2>
</div>
<div id="針對臨床實驗" class="section level2">
<h2><span class="header-section-number">75.2</span> 針對臨床實驗</h2>
</div>
<div id="針對觀察性研究" class="section level2">
<h2><span class="header-section-number">75.3</span> 針對觀察性研究</h2>
</div>
<div id="模型檢查的要點" class="section level2">
<h2><span class="header-section-number">75.4</span> 模型檢查的要點</h2>
<ol style="list-style-type: decimal">
<li>總體模型對數據的擬合情況是否合理？</li>
<li>是否有極端數據，影響了模型的擬合結果？</li>
<li>解釋變量，特別是連續型變量是否以正確的形式進入了模型？</li>
</ol>
</div>
<div id="比例風險假設的檢查-check-the-proportional-hazard-assumtion" class="section level2">
<h2><span class="header-section-number">75.5</span> 比例風險假設的檢查 check the proportional hazard assumtion</h2>
<p>主要有三板斧：</p>
<ol style="list-style-type: decimal">
<li>用非參數法繪製簡單的生存曲線圖；</li>
<li>用統計檢驗，判斷一個解釋變量對風險的影響是否和時間產生了交互作用；</li>
<li>殘差繪圖法。</li>
</ol>
<p>非參數法繪製生存曲線圖詳見第 @ref{nonparametric} 章節部分。</p>
<div id="比例風險檢查的統計檢驗法" class="section level3">
<h3><span class="header-section-number">75.5.1</span> 比例風險檢查的統計檢驗法</h3>
<p>在滿足比例風險前提下，某個解釋變量估計的風險比 (hazard ratio) 不會隨著時間變化而變化，根據這個特點，我們可以認為，如果某些解釋變量在追踪開始時對風險影響很強，在之後的追踪中，和風險之間的關係變弱的話，(或者反過來)，那麼風險比的這一變化就違背了比例風險這一前提。最簡單的，我們可以在模型中加入該變量和時間的相乘項 (交互作用項)：</p>
<p><span class="math display">\[
h(t|x) = h_0(t)\exp\{ \beta x + \gamma (x\times t)\}
\]</span></p>
<p>聰明的你一下子就明白了，接下來只要檢驗 <span class="math inline">\(H_0: \gamma = 0\)</span>:</p>
<p><span class="math display">\[
\frac{\hat\gamma}{SE(\hat\gamma)} \sim N(0,1)
\]</span></p>
</div>
<div id="用-schoenfeld-殘差繪圖" class="section level3">
<h3><span class="header-section-number">75.5.2</span> 用 Schoenfeld 殘差繪圖</h3>
<p>另外一種視覺化檢查比例風險假設的方法是使用 <strong>Schoenfeld 殘差</strong>：</p>
<p>The residual compares the observed values of the explanatory variable for the case at a given envent time with the weighted average of the explanatory variable in the risk set. The residuals should not show any dependence on time – this would indicate that the proportional hazards assumptions is not met.</p>
<p>It is actually more convenient to use the “scaled Schoenfeld residuals”. <strong>The Scaled Schoenfeld residuals have a mean which is the true log hazard ratio</strong> under the proportional hazards assumption, and the average values of the scaled Schoenfeld residuals over time can be interpreted as the time-varying log-hazard ratio. A plot of the scaled Schoenfeld residuals over time is therefore directly informative about how the log hazard ratio changes overtime. It is useful to show a smoothed average curve on these plots.</p>
</div>
</div>
<div id="評價模型擬合的其他有趣方法" class="section level2">
<h2><span class="header-section-number">75.6</span> 評價模型擬合的其他有趣方法</h2>
<div id="martingale-殘差-assessing-the-functional-form-of-continuous-variables" class="section level3">
<h3><span class="header-section-number">75.6.1</span> Martingale 殘差-assessing the functional form of continuous variables</h3>
<p>Martingale (馬丁哥?) 殘差圖可以用來檢驗，比較連續型變量在模型中是否被正確擬合，因為有時候連續型變量需要增加該連續型變量的二次項或者多次項，也可能要用對數項之類的變形之後，才能完全把其與生存數據之間的關係完全解釋清楚。</p>
<p>A Martingale is a residual for an event process – it is the difference between what happened to a person (whether they had the event or not) and what is predicted to happen to a person under the model that has been fitted. The Martingale residual for individual i is:</p>
<p><span class="math display">\[
r_{M_i} = \delta_i - \hat H_0(t_i)\exp(\hat\beta x_i)
\]</span></p>
<p>Where, <span class="math inline">\(\delta_i\)</span> is the indicator of whether the individual <span class="math inline">\(i\)</span> had the event (1) or was censored (0), <span class="math inline">\(t_i\)</span> is the event or censoring time, <span class="math inline">\(x_i\)</span> denotes the explanatory variable (or more generally a vector of explanatory variables), and <span class="math inline">\(\hat H_0(t_i)\)</span> is the estimated baseline cumulative hazard at time <span class="math inline">\(t_i\)</span>. If the model is correct then the Martingale residuals should sum to 0.</p>
</div>
<div id="deviance-偏差殘差-identifying-individuals-for-whom-the-model-does-not-provide-a-good-fit" class="section level3">
<h3><span class="header-section-number">75.6.2</span> Deviance 偏差殘差 – identifying individuals for whom the model does not provide a good fit</h3>
<p>偏差殘差是馬丁哥殘差的轉換值，它的定義是:</p>
<p><span class="math display">\[
r_{D_i} = \text{sign}(r_{M_i})[-2\{r_{M_i} + \delta_i\log(\delta_i - r_{M_i})\}]^{\frac{1}{2}}
\]</span></p>
<p>偏差殘差通過上面的公式，把模型給出的馬丁哥殘差轉換成為一組理論上應該是平均分佈在零兩側的數據。如果某個個體的偏差殘差過大，偏離0太遠的話，提示該模型對該個體數據擬合不佳。具體來說，如果偏差殘差遠大於零，提示的是該個體遠在模型預測他/她/它會發生事件的時間之前就已經發生了事件；相反如果偏差殘差遠小於零，則提示該個體在模型預測發生事件的時間點之後很晚才真的發生事件。</p>
<p>把偏差殘差作 Y 軸，危險度評分 (risk score <span class="math inline">\(=\beta^Tx\)</span>)，作 x 軸繪圖可以用於分析模型是否針對某些危險度高的人給出較高的偏差殘差，從而可以判斷模型是否合理。當判斷某些人可能偏差殘差過大，或者過小，之後要做的決定才是殘忍的，你要從數據中刪除這些個體？還是分析這些個體到底有哪些與眾不同的特質？或者是要重新對模型的各項解釋變量的形式進行修正？</p>
<p><strong>在進行生存分析的時候，請一定要一邊構建模型，一邊用這些殘差來綜合分析模型的合理性。</strong></p>
</div>
</div>
</div>
<div id="競爭風險模型-competing-risk" class="section level1">
<h1><span class="header-section-number">第 76 章</span> 競爭風險模型 competing risk</h1>
<p>當我們在做風險模型研究的時候，除了重要的比例風險假設，另外一個 (經常被忘記的) 假設是我們認為<strong>刪失值只是一堆無效信息 (non-informative censoring)</strong>。這個假設通常來說都是合理的，但是如果某些刪失值是由於他們身上發生了別的事件，導致無法追踪或者無法再發生我們關心的事件。這樣的現象被叫做競爭風險 (competing risk)。最明顯的例子是我們關心某些疾病(心血管疾病，癌症)的發生，但是患者可能提前因為別的原因 (事故或者別的原因) 死亡而離開研究。這些離開研究的人，假如沒有死亡，繼續留在研究中，他們還是有可能會發生研究關心的事件的。那麼此時，我們說死亡事件，是一個疾病發生的競爭風險。</p>
<div id="cause-specific-hazard" class="section level2">
<h2><span class="header-section-number">76.1</span> Cause-specific hazard</h2>
<p>如果，我們認為研究中存在 <span class="math inline">\(k\)</span> 種“事件(event/failure)”，我們可以定義這樣的因素別風險方程 (cause-specific hazard function):</p>
<p><span class="math display">\[
h_k(t) = \lim_{\delta t \rightarrow 0} \frac{1}{\delta t}\text{Pr}\{ t\leqslant T &lt; t + \delta t, D = k | T\geqslant t  \}
\]</span></p>
<p>這可以被定義為在時間點 <span class="math inline">\(t\)</span>，該對象發生事件 <span class="math inline">\(k\)</span> 的瞬間風險。(This can be interpreted as the instantaneous risk of dying from cause <span class="math inline">\(k\)</span> given the individual is alive at time <span class="math inline">\(t\)</span>. i.e. they have not died of any cause before time <span class="math inline">\(t\)</span>)</p>
<p>(Cumulative cause-specific hazard)累積因素別風險方程則可以被定義為：</p>
<p><span class="math display">\[
H_k(t) = \int_0^t h_k(s)ds
\]</span></p>
<p>相應地，生存方程：</p>
<p><span class="math display">\[
S_k(t) = \exp(-H_k(t))
\]</span></p>
<p>Overall hazard is the sum of all cause-specific hazards:</p>
<p><span class="math display">\[
\begin{aligned}
h(t) &amp; = \sum_{e=1}^K \lim_{\delta t\rightarrow 0} \frac{1}{\delta t}\text{Pr}\{ t\leqslant T &lt; t + \delta t, D = e | T\geqslant t  \} \\
     &amp; = \lim_{\delta t \rightarrow 0} \frac{1}{\delta t}\text{Pr}\{ t\leqslant T &lt; t + \delta t | T \geqslant t  \}
\end{aligned}
\]</span></p>
<p>It follows that the overall survival can be written as useful application of this cause-specific survivor function:</p>
<p><span class="math display">\[
S(t) = \exp[-\sum_{e=1}^KH_e(t)] = \prod_{e = 1}^K \exp(-H_e(t))
\]</span></p>
<div id="cause-specific-hazards-models" class="section level3">
<h3><span class="header-section-number">76.1.1</span> Cause-specific hazards models</h3>
<p><span class="math display">\[
h_k(t|x) = h_{k, 0} (t)e^{\beta_k x}
\]</span></p>
<ul>
<li>People are censored at the time of any event that is not the event of interest</li>
<li>We fit a separate Cox model for each event type</li>
<li><span class="math inline">\(\beta_k\)</span> represents the impact of <span class="math inline">\(x\)</span> on the hazard for event type k,** among those at risk of event type k**</li>
</ul>
</div>
</div>
<div id="cumulative-incidence-function" class="section level2">
<h2><span class="header-section-number">76.2</span> Cumulative incidence function</h2>
<p>Other names: absolute cause-specific risk/Crude Probabilty of event</p>
<p><span class="math display">\[
I_k(t) = \int_0^t h_k(s)S(s)ds
\]</span></p>
</div>
<div id="subdistribution-hazard---fine-and-gray-model" class="section level2">
<h2><span class="header-section-number">76.3</span> Subdistribution hazard - Fine and Gray model</h2>
<p>The approach uses an alternative definition of the hazard, called the subdistribution hazard, which represents the instantaneous risk of dying from cause k given that an individual has not already died from cause k, that is:</p>
<p><span class="math display">\[
h^s_k(t) = \lim_{\delta t \rightarrow 0} \frac{1}{\delta t} \{ \text{Pr}(t \leqslant T &lt; t + \delta t, K = k | T &gt; t \text{ or } (T \leqslant t, K \neq k)) \}
\]</span></p>
<p>This differs from the cause-specific hazard in its risk set; here individuals are not removed from the risk set if they die from another competing cause of death than cause k.</p>
<div id="subdistribution-hazard-model" class="section level3">
<h3><span class="header-section-number">76.3.1</span> Subdistribution hazard model</h3>
<p><span class="math display">\[
h_k^s(t) = -\frac{d}{dt} \log(1 - I_k(t))
\]</span></p>
<p><span class="math display">\[
h_k^s(t|x)  = h_{0,k}(t)e^{\beta^T_k x}
\]</span></p>
<p>The relationsship between the CIFs in the two treatment groups is given by:</p>
<p><span class="math display">\[
1 - I_k(t|1) = [1 - I_k(t|0)]^{\exp(\beta_kx)}
\]</span></p>
</div>
</div>
<div id="multi-state-models" class="section level2">
<h2><span class="header-section-number">76.4</span> Multi-state models</h2>
<div id="the-markov-model" class="section level3">
<h3><span class="header-section-number">76.4.1</span> The Markov model</h3>
<p>A common assumption for multi-state mode is that upon entering a particular state i, individuals are subject to common trasition rate for movement to state j, irrespective of their history. In other words, we assume that the transition rate does not differ according to the previous states an individual has been in. This is called the Markov assumption, and is often quite a strong assumption to make.</p>
</div>
<div id="cox-proportional-hazards-model-for-transition-intensities" class="section level3">
<h3><span class="header-section-number">76.4.2</span> Cox proportional hazards model for transition intensities</h3>
<p>The transition intensities for transition i to j is given by:</p>
<p><span class="math display">\[
h_{ij} (t | x) = h_{ij,0} (t)\exp(\beta_{ij}^Tx)　
\]</span></p>
</div>
</div>
</div>
<div id="生存分析的其他手段" class="section level1">
<h1><span class="header-section-number">第 77 章</span> 生存分析的其他手段</h1>
<div id="分層cox生存分析-stratified-cox-proportional-hazards-model" class="section level2">
<h2><span class="header-section-number">77.1</span> 分層Cox生存分析 stratified Cox proportional hazards model</h2>
<p>Under the Cox proportional hazards model, the effect of each explanatory variable on the hazard is assumed to be such that the ratio of hazards is constant accross the time scale (the proportional hazards assumption). In applications with several explanatory variabls, the effect of some of these variables may not be proportional. When the aim of the analysis is not focussed on these particular variables, for example if they are just being used as adjustment variables and are not the main exposures of interest, then the proportionality assumption can be relaxed just for those variables by fitting a stratified Cox proportional hazards model.</p>
<p>In the stratified Cox proportional hazards model, instead of assuming that the proportional hazards model holds overall, we assume that the proportional hazards assumption holds within groups (or strata) of individuals.</p>
<p><span class="math display">\[
h(t|x,s) = h_{0s} (t)e^{\beta^T x}
\]</span></p>
<p>Each stratum, s, has a separate baseline hazard <span class="math inline">\(h_{0s}(t)\)</span>. However, the other explanatory variables x are assumed to act in the same way on the baseline hazard in each stratum, i.e. the <span class="math inline">\(\beta\)</span> are the same accross strata.</p>
</div>
<div id="加速失效模型-accelerated-failure-time-aft-model" class="section level2">
<h2><span class="header-section-number">77.2</span> 加速失效模型 Accelerated failure time (AFT) model</h2>
<p>加速失效模型，AFT 模型的特點是不管所謂的風險概念，而是對每個患者真正的生存時間進行模型化處理，其實個人更加喜歡這個模型，因為它很直觀地告訴你某類人的生存時間就是比另一類人短，而不是告訴你一個抽象的一組的風險低於或者高於另一組，因為很多人無法理解什麼是風險 (hazard)，正如很多人無法理解什麼是比值 (odds) 一樣。同樣還因為風險比例模型還要考慮是否對基線風險進行參數估計的取捨問題。</p>
<p>所以，風險比例模型：</p>
<p><span class="math display">\[
h_1(t) = \psi_{PH}h_0(t)
\]</span></p>
<p>AFT 模型：</p>
<p><span class="math display">\[
T_1 = \psi_{AFT}T_0
\]</span></p>
<p>在 AFT 模型中，<span class="math inline">\(\psi_{AFT}\)</span> 就是加速指數，它的直接涵義就是，治療組患者的死亡時間被“加速”或者“減緩”了。也就是它可以回答，治療組的患者是不是更快的痊癒？或者更快的死亡？這樣明了的問題。</p>
<p>通常情況下，這個加速指數用 <span class="math inline">\(e^{-\beta_{AFT}}\)</span> 進行參數化分析：</p>
<p><span class="math display">\[
T_1 = T_0 e^{-\beta_{AFT}}
\]</span></p>
<p>寫下此時的生存方程，和基線組生存方程的關係：</p>
<p><span class="math display">\[
\begin{aligned}
S_1(t) &amp; = \text{Pr}(T_1 &gt; t) \\
       &amp; = \text{Pr}(e^{-\beta_{AFT}}T_0 &gt; t) \\
       &amp; = \text{Pr}(T_0 &gt; te^{\beta_{AFT}}) \\
       &amp; = S_0(e^{\beta_{AFT}}t)
\end{aligned}
\]</span></p>
<div id="weibull-模型也是一種-aft-模型" class="section level3">
<h3><span class="header-section-number">77.2.1</span> Weibull 模型也是一種 AFT 模型</h3>
<p>一個 Weibull 模型在風險比例前提下的生存方程是：</p>
<p><span class="math display">\[
S(t|x) = \exp\{-\lambda e^{\beta_{PH}x} t^\kappa \}
\]</span></p>
<p>一個 Weibull 模型在 AFT 模型下的生存方程是：</p>
<p><span class="math display">\[
S(t|x) = \exp \{ -\lambda e^{\kappa \beta_{AFT}x} t^\kappa \}
\]</span></p>
<p>所以當你用 Weibull 模型時，其實可以自由在兩種類型 (PH or AFT) 之間自由切換：</p>
<p><span class="math display">\[
\exp(\beta^T_{PH}) = \exp(\kappa\beta^T_{AFT})
\]</span></p>
<p>所以，Weibull 模型和其特殊形態–指數模型，為唯二的兩個，可以在 PH 模型和 AFT 模型之間自由切換的模型。</p>
</div>
</div>
</div>
<div id="時間依存變量-time-dependent-variables-和脆弱模型-frailty-model" class="section level1">
<h1><span class="header-section-number">第 78 章</span> 時間依存變量 Time-dependent variables 和脆弱模型 frailty model</h1>
<div id="時間依存變量指的是什麼" class="section level2">
<h2><span class="header-section-number">78.1</span> 時間依存變量指的是什麼</h2>
<p>生存分析的模型中，我們常常會使用一些實際上會經過時間變化而變化的預測變量。這些變量被稱爲時間依存型變量<em>(time-dependent variables)</em>。有些教科書會把這種類型的變量命名爲自更新變量(time-updated)或者時變變量(time-varying)。實際的例子有：</p>
<ul>
<li><p>某觀察型研究使用患者病例數據庫分析患有囊性肺纖維化(cystic fibrosis)的病人的生存情況。在病人數據庫隨訪收集數據的過程中，有些患者接受了肺部臟器的移植，有些患者沒有。那麼有沒有肺部臟器移植手術就是影響患者死亡率，或者說生存概率的重要指標之一。那麼這樣的模型中，是否接受過移植手術這一變量就是一個時間依存型變量。它的特徵除了是一個二分類變量以外，患者只能從 0（未接受移植）變成 1（接受過移植），而不能反過來。</p></li>
<li><p>某觀察型隊列研究的課題是分析研究對象的血壓水平和心臟疾病之間的關係。在隊列研究的隨訪中，研究對象的血壓可能在每次隨訪時都有相應的測量數據。在這樣的實驗情形下，每次隨訪獲得的血壓數據就是一個時間依存型的連續變量。</p></li>
</ul>
<p>時間依存型變量除了有二分類的，連續型的等等不同之外，它還有另外一個更加重要的性質需要考慮並且加以區分。這就是看我們想要討論的時間依存型變量的時間依存性質的來源，是內在性的(internal)還是外源性(external)的。</p>
<p>內在性的時間依存變量是指這個變量的隨時間的變化的特性是只能在觀察對象未發生我們所關心的事件（比如死亡事件）之前測量獲取的。而且這種內在性還體現在如果不與實驗對象取得聯繫的話，更新之後的數據研究者是無法得到的。比方說需要從仍然存活的患者身上提取血液樣本測量一些生物指標，比如是否接受過臟器移植，或者是最近的血壓值是多少等等。</p>
<p>外源性的時間依存變量是指這樣的變量雖然隨着時間變化，但是不需要通過聯繫患者或者實驗對象也能夠獲取想要的數據。年齡是最典型的一個例子，你只要知道患者在起始時的年齡，也就知道了在隨訪過程中患者的年齡。另外的常見外源性時間依存變量的例子還有如一些臨牀試驗中隨着患者病程的變化而按照事先準備或者計劃好的劑量調整治療方案。再比如研究空氣污染水平和患者哮喘之間關係的空氣污染水平數據，可以通過外來的如氣象局提供的歷史數據來查詢獲得。</p>
<p>這兩種類型的時間依存變量在進行數據分析的時候，常常不需要加以刻意的區分，但是在結果的解讀和解釋的時候就需要考慮這兩種不同類型的時間依存性質給分析結果帶來的影響。</p>
<p>在正式進入時間依存變量的數學模型之前，我們需要引入時間依存變量的數學標記方法。一般地，<span class="math inline">\(x\)</span>被用於表示預測變量，它可以是一個單一的變量，也可以是一個由許多預測變量組成的向量。在處理時間依存型變量的時候，我們通常使用 <span class="math inline">\(x(t)\)</span> 來表示。其含義就是在時間點 <span class="math inline">\(t\)</span> 時預測變量的值。如果 <span class="math inline">\(x(t)\)</span> 是一個向量，它可以同時表示時間依存型變量和其他的不隨時間變化而變化的變量。如果用 <span class="math inline">\(x(t)\)</span> 表示一個非時間依存型變量的話，它就表示無論時間 <span class="math inline">\(t\)</span> 是多少，<span class="math inline">\(x\)</span> 值的大小都始終保持不變。</p>
</div>
<div id="extended-cox-model-把cox模型擴展開去" class="section level2">
<h2><span class="header-section-number">78.2</span> Extended Cox model 把Cox模型擴展開去</h2>
<p>Cox比例風險模型是很容易被擴展，用來加入時間依存型預測變量。當Cox比例風險模型中加入了時間依存型變量，它的數學模型被寫作：</p>
<p><span class="math display">\[
h(t|x(t)) = h_0(t) e^{\beta^Tx(t)}
\]</span></p>
<p>這一數學模型其實是在說我們對該預測變量感興趣的是在時間點 <span class="math inline">\(t\)</span> 時的測量值是否和發生相關事件的風險(hazard)有關係。也就是在這個模型裏，時間依存變量的最新值，是我們關心的最主要預測變量。這裏的基線風險(baseline hazard, <span class="math inline">\(h_0(t)\)</span>)應該被解釋爲是一個所有的預測變量從起始直至所有追蹤結束時均爲零的觀察對象。[This formulation is assumed that we are interested in the explanatory variable at the time of the event of interest. In other words, it means that only the current value of the covariates (i.e. at time t) affects the hazard. Here, the baseline hazard function is interpreted as the hazard function for an individual for whom all the variables are zero (from the time origin and during all the follow-up).]</p>
<p>那麼這個模型的對數風險度比(log hazard ratios)又該怎麼理解呢？爲了便於解釋，先考慮只有一個時間依存型變量的模型 <span class="math inline">\(x_1(t)\)</span>。那麼對象編號爲 <span class="math inline">\(r\)</span> 和對象編號爲 <span class="math inline">\(s\)</span> 的兩人，他們之間的風險度比 (hazard ratio)：</p>
<p><span class="math display">\[
\begin{aligned}
\frac{h(t|x_{1r}(t))}{h(t|x_{1s}(t))} &amp; = \frac{h_0e^{\beta_1x_{1r}(t)}}{h_0e^{\beta_1x_{1s}(t)}} \\
&amp; = \exp(\beta_1(x_{1r}(t) - x_{1s}(t)))
\end{aligned}
\]</span></p>
<p>所以，簡單地解釋就是，<span class="math inline">\(\beta_1\)</span> 比較的是<span class="math inline">\(r,s\)</span>兩個觀察對象的預測變量 <span class="math inline">\(x_1\)</span> 在任意一個時間點時相差一個單位時的風險度。值得指出的是，這裏回歸係數的解釋暗示了 <strong>時間依存變量<span class="math inline">\(x_1\)</span>在任意一個時間點時，改變一個單位的風險度比是固定不變的。</strong>但是，由於 <span class="math inline">\(x_{1r}(t) - x_{1s}(t)\)</span> 是會隨時間 <span class="math inline">\(t\)</span> 變化的（也就是風險度比不再是成固定比例的，而是允許它隨時間變化而發生改變）。這個Cox風險模型就不能再被叫做<strong>“比例”</strong>風險模型，它被叫做<strong>Cox擴展模型(extended Cox Model)</strong>。</p>
<div id="練習題-exercise-8.1" class="section level3">
<h3><span class="header-section-number">78.2.1</span> 練習題 exercise 8.1</h3>
<p>假設我們使用下面這樣的Cox擴展模型來研究關於肺部臟器移植與否的時間依存變量和死亡之間的關係：</p>
<p><span class="math display">\[
h(t|x) = h_0(t)\text{exp}(\beta x(t))
\]</span></p>
<p>如果患者<span class="math inline">\(r\)</span>在時間點5時進行了肺部的臟器移植，患者<span class="math inline">\(s\)</span>則整個隨訪中都沒有接受臟器移植。請試着計算下列時間點時兩名患者之間的死亡風險度比：</p>
<ol style="list-style-type: decimal">
<li>時間點4；</li>
<li>時間點6。</li>
</ol>
<p>（我們假設兩名患者在這兩個時間點時都依然還是存活着的）</p>
</div>
<div id="解答" class="section level3">
<h3><span class="header-section-number">78.2.2</span> 解答</h3>
<ol style="list-style-type: decimal">
<li>在時間點4時，兩名患者都沒有接受臟器移植，此時，他們的死亡風險度都是基線風險：<span class="math inline">\(h(t|x) = h_0(t)\)</span>，故在時間點4時，他們的死亡風險度比是 1。</li>
<li>在時間點6時，患者<span class="math inline">\(r\)</span>的風險度是：<span class="math inline">\(h(t|x) = h_0(t)\text{exp}(\beta)\)</span>。患者 <span class="math inline">\(s\)</span> 的風險度是：<span class="math inline">\(h(t|x) = h_0(t)\)</span>。所以，在時間點6時，患者<span class="math inline">\(r,s\)</span>之間的死亡風險度比就是 <span class="math inline">\(\text{exp}(\beta)\)</span>。</li>
</ol>
<hr />
<p>在Cox擴展模型下，加入了時間依存變量之後，模型所使用的偏似然(partial likelihood)是：</p>
<p><span class="math display">\[
L_p = \prod_j\frac{\text{exp}\beta^Tx_{i_j}(t_j)}{\sum_{k\in R_j}\text{exp}\beta^Tx_k(t_j)}
\]</span></p>
<p>在這個偏似然中，我們實際比較了在時間點 <span class="math inline">\(t_j\)</span> 時，實際觀察到的有發生事件的對象的預測變量 <span class="math inline">\(x_{i_j}(t_j)\)</span> 的風險度，和在時間點 <span class="math inline">\(t_j\)</span> 時仍然存在在觀察數據集合(the risk set at time <span class="math inline">\(t_j\)</span>)中的個體(假設人數爲 <span class="math inline">\(R_j\)</span>)的預測變量 <span class="math inline">\(x_k(t_j)\)</span>的風險度。這裏需要特別指出的是，當使用這個偏似然作爲估計的工具時，我們需要知道所有觀察對象，當他/她/它仍然處在觀察數據集合中的時候，每當有新的事件發生被觀察到，那每個新時間發生的時間點，模型中所有預測變量的最新值（包括時間依存變量本身）。這個假設對於二分類（是否接受移植臟器）時間依存變量來說不難，但是當時間依存變量是連續型變量的時候，要知道每一次事件發生時所有存在在觀察數據集合中每一名觀察對象的觀察值（例如血壓），是無法辦到的。這是因爲血壓值其實是時時刻刻都處在變化中的，但是我們實際對患者隨訪測量血壓時，都只能獲得患者在某個時間點上的血壓值。因此，這個Cox擴展模型中如果存在連續性的時間依存變量，那麼模型的另一個隱含的前提條件是，假設患者或者實驗對象的連續性時間依存變量在前後兩次測量值獲得的間隔期內是保持不變的（assuming that it stays constant from the last time it has been observed）。</p>
</div>
</div>
<div id="時間依存變量數據的結構" class="section level2">
<h2><span class="header-section-number">78.3</span> 時間依存變量數據的結構</h2>
<p>假設有一個隨時間變化而變化的二分類型解釋變量 <span class="math inline">\(x(t)\)</span>，假設有三名從時間點 0 開始參與其中的實驗對象：</p>
<ul>
<li>實驗對象1，她/他的 <span class="math inline">\(x(t)\)</span> 隨着時間沒有發生變化，在整個隨訪過程中都是 <span class="math inline">\(x(t) = 0\)</span>的狀態，在時間點10時該患者失去聯繫（刪失值，censor）。</li>
<li>實驗對象2，她/他的 <span class="math inline">\(x(t)\)</span> 在隨訪時間 5 之前均爲 <span class="math inline">\(x(t) = 0\)</span>，在該時間點之後 <span class="math inline">\(x(t) = 1\)</span>，在時間點20時該患者失去聯繫（刪失值，censor）。</li>
<li>實驗對象3，她/他的 <span class="math inline">\(x(t)\)</span> 在隨訪時間 15 之前均爲 <span class="math inline">\(x(t) = 0\)</span>，在該時間點之後 <span class="math inline">\(x(t) = 1\)</span>，在時間點25時該患者死亡 (event = 1)。</li>
</ul>
<p>用表格來說明這三人在追蹤隨訪過程中的狀態如下：</p>
<p>其中的實驗對象：</p>
<ul>
<li>實驗對象1，她/他的 <span class="math inline">\(x(t)\)</span> 隨着時間沒有發生變化，在整個隨訪過程中都是 <span class="math inline">\(x(t) = 0\)</span>的狀態，在時間點10時該患者失去聯繫（刪失值，censor）。</li>
<li>實驗對象2，她/他的 <span class="math inline">\(x(t)\)</span> 在隨訪時間 5 之前均爲 <span class="math inline">\(x(t) = 0\)</span>，在該時間點之後 <span class="math inline">\(x(t) = 1\)</span>，在時間點20時該患者失去聯繫（刪失值，censor）。</li>
<li>實驗對象3，她/他的 <span class="math inline">\(x(t)\)</span> 在隨訪時間 15 之前均爲 <span class="math inline">\(x(t) = 0\)</span>，在該時間點之後 <span class="math inline">\(x(t) = 1\)</span>，在時間點25時該患者死亡 (event = 1)。</li>
</ul>
<p>用表格來說明這三人在追蹤隨訪過程中的狀態如下：</p>
<p>其中的實驗對象：</p>
<ul>
<li>實驗對象1，她/他的 <span class="math inline">\(x(t)\)</span> 隨着時間沒有發生變化，在整個隨訪過程中都是 <span class="math inline">\(x(t) = 0\)</span>的狀態，在時間點10時該患者失去聯繫（刪失值，censor）。</li>
<li>實驗對象2，她/他的 <span class="math inline">\(x(t)\)</span> 在隨訪時間 5 之前均爲 <span class="math inline">\(x(t) = 0\)</span>，在該時間點之後 <span class="math inline">\(x(t) = 1\)</span>，在時間點20時該患者失去聯繫（刪失值，censor）。</li>
<li>實驗對象3，她/他的 <span class="math inline">\(x(t)\)</span> 在隨訪時間 15 之前均爲 <span class="math inline">\(x(t) = 0\)</span>，在該時間點之後 <span class="math inline">\(x(t) = 1\)</span>，在時間點25時該患者死亡 (event = 1)。</li>
</ul>
<p>用表格來說明這三人在追蹤隨訪過程中的狀態如下：</p>
<div style="border: 1px solid #ddd; padding: 0px; margin-left: auto; margin-right: auto;overflow-y: scroll; height:500px; overflow-x: scroll; width:700px; ">
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:08-surv8-1">表 78.1: </span>Example data for individuals with time-dependent explanatory variable x(t). Each individual has a line of data for each time period over which the explanatory variables takes a different value. The status refers to whether the individual has the event (1) or not (0) at the end of the interval.
</caption>
<thead>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Individual
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Time.origin
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Start.time
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Stop.time
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
x.t.
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
status
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
</div>
<p>表格 <a href="11-Survival-analysis.html#tab:08-surv8-1">78.1</a> 中時間區間其實是左開右閉的。所以2號實驗對象在時間段 <span class="math inline">\((0, 5]\)</span> 的 <span class="math inline">\(x(t) = 0\)</span>，但是在時間段 <span class="math inline">\((5, 20]\)</span> 時 <span class="math inline">\(x(t) = 1\)</span>。</p>
<p>實際研究數據的例子：</p>
<pre><code>## 
## 
## . use &quot;backupfiles/stanford.d. list in 1/10
## 
##      +-----------------------------------------------------------------+
##      | id   sex         dob      datein      datetr     dateout   dead |
##      |-----------------------------------------------------------------|
##   1. |  1     0   10jan1937   15nov1967           .   03jan1968      1 |
##   2. |  2     0   02mar1916   02jan1968           .   07jan1968      1 |
##   3. |  3     0   19sep1913   06jan1968   06jan1968   21jan1906      1 |
##   4. |  4     0   23dec1927   28mar1968   02may1968   05may1968      1 |
##   5. |  5     0   28jul1947   10may1968           .   27may1968      1 |
##      |-----------------------------------------------------------------|
##   6. |  6     0   08nov1913   13jun1968           .   15jun1968      1 |
##   7. |  7     0   29aug1917   12jul1968   31aug1968   17may1970      1 |
##   8. |  8     0   27mar1923   01aug1968           .   09sep1968      1 |
##   9. |  9     0   11jun1921   09aug1968           .   01nov1968      1 |
##  10. | 10     1   31jan1939   22feb1974   31mar1974   01apr1974      0 |
##      +-----------------------------------------------------------------+</code></pre>
<p>其中</p>
<ul>
<li><code>datein</code> 是該名患者加入實驗的日期；</li>
<li><code>datetr</code> 是該名患者接受心臟移植手術的日期（如果沒有接受手術則爲缺失值）；</li>
<li><code>dateout</code> 是患者離開實驗追蹤的日期（因爲死亡或者刪失）；</li>
<li><code>dead</code> 是實驗追蹤截止時患者的生存狀態（死亡１，刪失0）。</li>
</ul>
<p>爲了讓這個數據能夠進行 Cox 比例風險模型的擬合，在 Stata 中需要使用到 <code>stsplot</code> 命令，當患者在隨訪中曾經接受過心臟移植手術，那麼他/她的數據將被分成兩行，前一行是移植手術前，後一行則是移植手術後的數據。患者如果沒有接受心臟移植手術，她/他的數據就只有一行。</p>
<pre><code>## 
## 
## . use &quot;backupfiles/stanford.d. replace datetr = mdy(01, 01, 2001) if datetr == .
## (34 real changes made)
## 
## . 
## . stset dateout, id(id) origin(datein) scale(365.25) f(dead)
## 
##                 id:  id
##      failure event:  dead != 0 &amp; dead &lt; .
## obs. time interval:  (dateout[_n-1], dateout]
##  exit on or before:  failure
##     t for analysis:  (time-origin)/365.25
##             origin:  time datein
## 
## ------------------------------------------------------------------------------
##         103  total observations
##           3  multiple records at same instant                   PROBABLE ERROR
##              (dateout[_n-1]==dateout)
##           2  observations end on or before enter()
##           1  observation begins on or after (first) failure
## ------------------------------------------------------------------------------
##          97  observations remaining, representing
##          97  subjects
##          72  failures in single-failure-per-subject data
##      86.793  total analysis time at risk and under observation
##                                                 at risk from t =         0
##                                      earliest observed entry t =         0
##                                           last observed exit t =  4.925394
## 
## . 
## . stsplit post = datetr, at(0)
## (64 observations (episodes) created)
## 
## . 
## . replace post = post+1
## (161 real changes made)
## 
## . 
## . list in 1/20
## 
##      +-----------------------------------------------------------------------+
##   1. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  1 |   0 | 10jan1937 | 15nov1967 | 01jan2001 | 03jan1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      2875    |   .13415469    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   2. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  2 |   0 | 02mar1916 | 02jan1968 | 01jan2001 | 07jan1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      2923    |   .01368925    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   3. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  4 |   0 | 23dec1927 | 28mar1968 | 02may1968 | 02may1968 |    . |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    0    |      3009    |   .09582478    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   4. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  4 |   0 | 23dec1927 | 28mar1968 | 02may1968 | 05may1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3009    |   .10403833    |   .09582478    |       1    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   5. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  5 |   0 | 28jul1947 | 10may1968 | 01jan2001 | 27may1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3052    |   .04654346    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   6. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  6 |   0 | 08nov1913 | 13jun1968 | 01jan2001 | 15jun1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3086    |    .0054757    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   7. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  7 |   0 | 29aug1917 | 12jul1968 | 31aug1968 | 31aug1968 |    . |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    0    |      3115    |   .13689254    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   8. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  7 |   0 | 29aug1917 | 12jul1968 | 31aug1968 | 17may1970 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3115    |   1.8453114    |   .13689254    |       1    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##   9. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  8 |   0 | 27mar1923 | 01aug1968 | 01jan2001 | 09sep1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3135    |   .10677618    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  10. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      |  9 |   0 | 11jun1921 | 09aug1968 | 01jan2001 | 01nov1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3143    |   .22997947    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  11. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 10 |   0 | 20may1928 | 13sep1967 | 01jan2001 | 18sep1967 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      2812    |   .01368925    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  12. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 11 |   0 | 22aug1920 | 15aug1968 | 09sep1968 | 09sep1968 |    . |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    0    |      3149    |   .06844627    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  13. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 11 |   0 | 22aug1920 | 15aug1968 | 09sep1968 | 14jan1969 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3149    |   .41615332    |   .06844627    |       1    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  14. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 12 |   0 | 09jul1915 | 17sep1968 | 01jan2001 | 24sep1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3182    |   .01916496    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  15. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 13 |   0 | 22feb1914 | 19sep1968 | 05oct1968 | 05oct1968 |    . |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    0    |      3184    |   .04380561    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  16. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 13 |   0 | 22feb1914 | 19sep1968 | 05oct1968 | 08dec1968 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3184    |   .21902806    |   .04380561    |       1    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  17. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 14 |   0 | 16sep1914 | 20sep1968 | 26oct1968 | 26oct1968 |    . |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    0    |      3185    |   .09856263    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  18. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 14 |   0 | 16sep1914 | 20sep1968 | 26oct1968 | 07jul1972 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3185    |   3.7946612    |   .09856263    |       1    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  19. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 16 |   0 | 16may1919 | 26oct1968 | 22nov1968 | 22nov1968 |    . |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    0    |      3221    |   .07392197    |           0    |       0    |
##      +-----------------------------------------------------------------------+
## 
##      +-----------------------------------------------------------------------+
##  20. | id | sex |       dob |    datein |    datetr |   dateout | dead | _st |
##      | 16 |   0 | 16may1919 | 26oct1968 | 22nov1968 | 29aug1969 |    1 |   1 |
##      |----------------------------------------------------------+------------|
##      |   _d    |   _origin    |          _t    |         _t0    |    post    |
##      |    1    |      3221    |   .84052019    |   .07392197    |       1    |
##      +-----------------------------------------------------------------------+
## 
## . 
## . stcox post
## 
##          failure _d:  dead
##    analysis time _t:  (dateout-origin)/365.25
##              origin:  time datein
##                  id:  id
## 
## Iteration 0:   log likelihood = -283.80782
## Iteration 1:   log likelihood = -283.79628
## Iteration 2:   log likelihood = -283.79628
## Refining estimates:
## Iteration 0:   log likelihood = -283.79628
## 
## Cox regression -- Breslow method for ties
## 
## No. of subjects =           97                  Number of obs    =         161
## No. of failures =           72
## Time at risk    =   86.7926078
##                                                 LR chi2(1)       =        0.02
## Log likelihood  =   -283.79628                  Prob &gt; chi2      =      0.8792
## 
## ------------------------------------------------------------------------------
##           _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
##         post |   .9550011   .2889517    -0.15   0.879     .5277868    1.728022
## ------------------------------------------------------------------------------</code></pre>
<p>請問，經過Stata調整過後的數據中，<code>_t0, t, post, _d</code> 分別是什麼意義的數字？</p>
<ul>
<li><code>_t0</code> 是追蹤的時間起點，對於有接受心臟移植的患者來說，第二行的 <code>_t0</code> 是接受完移植手術後的時間起點；</li>
<li><code>t</code> 是生存時間，或者刪失值發生之前的時間；</li>
<li><code>_d</code> 是事件指示變量(event indicator)，對於有接受心臟移植的患者來說，她/他有兩行數據，第一行是手術前，第二行是手術後。當患者死亡(event = 1)，那麼那一行的 <code>_d = 1</code>，之前的每一行都是<code>0</code>。每名患者最多只有一行發生死亡事件；</li>
<li><code>post</code> 則是指示該行患者數據是處於心臟移植手術之前(<code>post = 0</code>)，還是之後(<code>post = 1</code>)。例如，第7名患者進入實驗的起點時間是1968年7月12日，她/他在1968年8月31日 (即0.13698245年之後)這天接受了心臟移植手術。所以在這兩個時間點之內是該患者的第一行數據，被記錄爲手術前 (<code>post = 0</code>)，這之後該患者又被持續追蹤到1970年5月17日，在這段時間內的數據是患者的第二行數據，被記錄爲手術後 (<code>post = 1</code>)；</li>
<li><code>stcox post</code> 的結果 <code>Haz. Ratio = 0.96, 95%CI: 0.528, 1.728</code>的涵義是，接受心臟手術之後，患者的死亡風險相比不接受心臟移植手術平均要低 4%，但是這個風險比 (HR)的 95%信賴區間是 (0.53, 1.73)，包含了零假設時的 1，所以數據分析的結果是心臟手術降低的死亡風險不能達到顯著性效果，沒有統計學意義。</li>
</ul>
<div id="值得注意的點" class="section level3">
<h3><span class="header-section-number">78.3.1</span> 值得注意的點</h3>
<ul>
<li>如果說我們感興趣的時間依存變量是外源性的 (external time-dependent variable)，那麼經典的條件風險 (conditional hazard) 和條件生存概率 (conditional survival)的關係仍然是有意義的：</li>
</ul>
<p><span class="math display">\[
S(t | x(u), u\leqslant t) = \text{exp}(-\int_0^t h_0(u)\text{exp}(\beta^Tx(u))du)
\]</span></p>
<ul>
<li><p>如果說時間依存變量本身是內源性的（internal time-dependent variable），那麼上面這個經典的條件風險和條件生存概率之間的關係就是沒有意義的了。因爲內源性的變量必須在患者生存的時候才能測量得到，如果你測量到了患者的時間依存變量就意味着該患者的生存概率是1。</p></li>
<li><p>另一個需要注意的點是在包括了時間依存變量的Cox比例風險模型中，當你加入了在暴露和結果的因果關係通路上的變量作爲共變量時，模型會變得不可解釋。舉例來說，如果治療心肌梗死的藥物是通過降低血壓來達到降低心肌梗死發生的概率的話，假設模型中調整的是跟隨時間發生變化的血壓作爲共變量，那麼這個模型中上升或者下降的血壓就會把治療效果給抵消掉(cancel out the treatment effect)。在這樣的場景設定中，血壓的變化本身是作爲主要暴露因素（治療與否）和主要結果因素（心肌梗死的發生概率）之間的媒介 (mediator)。</p></li>
</ul>
</div>
</div>
<div id="frailty-models-脆弱模型" class="section level2">
<h2><span class="header-section-number">78.4</span> Frailty Models (脆弱模型?)</h2>
<p>脆弱模型是時間事件數據的隨機效應模型。</p>
<p>Frailty models are random effects models for time-to-event data.</p>
<div id="individual-frailty-model" class="section level3">
<h3><span class="header-section-number">78.4.1</span> Individual frailty model</h3>
<p><span class="math display">\[
h_i(t|x_i) = \alpha_ih(t|x_i) = \alpha_i h_0(t)\exp(\beta^Tx_i)
\]</span></p>
</div>
<div id="application-to-a-weibull-model" class="section level3">
<h3><span class="header-section-number">78.4.2</span> Application to a Weibull model</h3>
<p><span class="math display">\[
h(t|x_i,\alpha_i) = \alpha_i \kappa \lambda t^{\kappa - 1}e^{\beta^Tx}
\]</span></p>
</div>
<div id="shared-frailty-model" class="section level3">
<h3><span class="header-section-number">78.4.3</span> Shared frailty model</h3>
<p><span class="math display">\[
h(t|x_{ij}, \alpha_i) = \alpha_j h_0(t)e^{\beta^Tx_{ij}}
\]</span></p>
</div>
</div>
</div>
<div id="時間事件數據的高級分析法" class="section level1">
<h1><span class="header-section-number">第 79 章</span> 時間事件數據的高級分析法</h1>

</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-van2004biostatistics">
<p>Belle, G. van, L. D. Fisher, P. J. Heagerty, and T. Lumley. 2004. <em>Biostatistics: A Methodology for the Health Sciences</em>. Wiley Series in Probability and Statistics. Wiley. <a href="https://books.google.co.uk/books?id=KSh8IOrLPzwC">https://books.google.co.uk/books?id=KSh8IOrLPzwC</a>.</p>
</div>
<div id="ref-Cox1972b">
<p>Cox, David R. 1972. “Models and Life-Tables Regression.” <em>JR Stat. Soc. Ser. B</em> 34: 187–220.</p>
</div>
<div id="ref-Royston2002">
<p>Royston, Patrick, and Mahesh KB Parmar. 2002. “Flexible Parametric Proportional-Hazards and Proportional-Odds Models for Censored Survival Data, with Application to Prognostic Modelling and Estimation of Treatment Effects.” <em>Statistics in Medicine</em> 21 (15): 2175–97.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="10-Hierarchical-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="12-Bayesian-stats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook/js/app.min.js"></script>
<script src="assets/gitbook/js/lunr.js"></script>
<script src="assets/gitbook/js/clipboard.min.js"></script>
<script src="assets/gitbook/js/plugin-search.js"></script>
<script src="assets/gitbook/js/plugin-sharing.js"></script>
<script src="assets/gitbook/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook/js/plugin-bookdown.js"></script>
<script src="assets/gitbook/js/jquery.highlight.js"></script>
<script src="assets/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"github": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/winterwang/LSHTMlearningnote/edit/master/11-Survival-analysis.Rmd",
"text": "編輯"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown.epub"],
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
